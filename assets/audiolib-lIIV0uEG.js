var kl=Object.defineProperty,ru=c=>{throw TypeError(c)},Ml=(c,e,r)=>e in c?kl(c,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[e]=r,q=(c,e,r)=>Ml(c,typeof e!="symbol"?e+"":e,r),Ho=(c,e,r)=>e.has(c)||ru("Cannot "+r),i=(c,e,r)=>(Ho(c,e,"read from private field"),r?r.call(c):e.get(c)),M=(c,e,r)=>e.has(c)?ru("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(c):e.set(c,r),g=(c,e,r,o)=>(Ho(c,e,"write to private field"),e.set(c,r),r),K=(c,e,r)=>(Ho(c,e,"access private method"),r),Po=(c,e,r,o)=>({set _(h){g(c,e,h)},get _(){return i(c,e,o)}});const iu={sampleRate:48e3};function xl(c,e=!1){if(c==null)return!1;const r=.001,o=240,h=1,u=2;if(c.duration<r)return console.warn(`Audio duration is too short: ${c.duration} seconds. Must be longer than ${r} seconds`),!1;if(c.duration>o)return console.warn(`Audio duration is too long: ${c.duration} seconds. Must be shorter than ${o} seconds`),!1;if(c.numberOfChannels<h||c.numberOfChannels>u)return console.warn("Invalid number of audio channels."),!1;let f=!1,y=0,P=0;for(let S=0;S<c.numberOfChannels;S++)try{const F=c.getChannelData(S);if(!F||F.length===0)return!1;let N=0;for(let te=0;te<F.length;te++){const H=Math.abs(F[te]);H>0&&(f=!0),H>y&&(y=H),N+=H*H}const U=Math.sqrt(N/F.length);if(U>P&&(P=U),f)break}catch{return!1}if(f){if(e){const S=20*Math.log10(y),F=20*Math.log10(P);console.log(`AudioBuffer Analysis:
      Duration: ${c.duration} seconds
      Peak amplitude: ${y.toFixed(4)} (${S.toFixed(1)} dB)
      RMS amplitude: ${P.toFixed(4)} (${F.toFixed(1)} dB)
    `)}}else console.warn("Invalid Buffer: No non-zero data.");return f}var bi,Is,gt,on,St,er,tr,nr,Ai,Pr,et,su,Va,ou,Oo,Co,Yr;class Ka{constructor(e,r,o,h=1024){M(this,et),M(this,bi),M(this,Is),M(this,gt),M(this,on),M(this,St),M(this,er),M(this,tr),M(this,nr,null),M(this,Ai,new Map),M(this,Pr,null),g(this,bi,e),g(this,Is,r),g(this,gt,o),g(this,on,e.createAnalyser()),g(this,St,e.createAnalyser()),i(this,on).fftSize=h,i(this,St).fftSize=h,g(this,er,new Float32Array(i(this,on).fftSize)),g(this,tr,new Float32Array(i(this,St).fftSize))}start(e=1e3,r,o=!1){return this.stop(),K(this,et,su).call(this),g(this,nr,window.setInterval(()=>{const h=this.getLevels();r&&r(h),o&&K(this,et,ou).call(this,h)},e)),this}getLevels(){i(this,on).getFloatTimeDomainData(i(this,er)),i(this,St).getFloatTimeDomainData(i(this,tr));const e=K(this,et,Oo).call(this,i(this,er)),r=K(this,et,Oo).call(this,i(this,tr)),o=K(this,et,Co).call(this,i(this,er)),h=K(this,et,Co).call(this,i(this,tr)),u=K(this,et,Yr).call(this,e),f=K(this,et,Yr).call(this,r),y=K(this,et,Yr).call(this,o),P=K(this,et,Yr).call(this,h),S=y-P;return{input:{rms:e,peak:o,rmsDB:u,peakDB:y},output:{rms:r,peak:h,rmsDB:f,peakDB:P},gainChange:S,gainChangeDB:S}}stop(){if(i(this,nr)){window.clearInterval(i(this,nr)),g(this,nr,null);try{i(this,on).disconnect(),i(this,St).disconnect(),i(this,Pr)&&(i(this,Pr).disconnect(),g(this,Pr,null));const e=i(this,Ai).get(i(this,gt));if(e){i(this,gt).disconnect();for(const r of e)r.node instanceof AudioNode?i(this,gt).connect(r.node,r.output,r.input):r.node instanceof AudioParam&&i(this,gt).connect(r.node,r.output)}i(this,Ai).clear()}catch(e){console.error("Error removing level monitoring:",e)}}}}bi=new WeakMap,Is=new WeakMap,gt=new WeakMap,on=new WeakMap,St=new WeakMap,er=new WeakMap,tr=new WeakMap,nr=new WeakMap,Ai=new WeakMap,Pr=new WeakMap,et=new WeakSet,su=function(){try{const c=K(this,et,Va).call(this,i(this,gt));i(this,Ai).set(i(this,gt),c);const e=i(this,bi).createGain();e.gain.value=1,i(this,Is).connect(e),e.connect(i(this,on)),i(this,gt).disconnect(),i(this,gt).connect(i(this,St));for(const r of c)r.node instanceof AudioNode?i(this,St).connect(r.node,r.output,r.input):r.node instanceof AudioParam&&i(this,St).connect(r.node,r.output);g(this,Pr,e)}catch(c){console.error("Error setting up level monitoring:",c)}},Va=function(c){return[{node:i(this,bi).destination,output:0,input:0}]},ou=function(c){console.log(`Audio Levels:
       Input:  RMS ${c.input.rmsDB.toFixed(1)} dB | Peak ${c.input.peakDB.toFixed(1)} dB
       Output: RMS ${c.output.rmsDB.toFixed(1)} dB | Peak ${c.output.peakDB.toFixed(1)} dB
       Gain Change: ${c.gainChangeDB>0?"+":""}${c.gainChangeDB.toFixed(1)} dB`)},Oo=function(c){let e=0;for(let r=0;r<c.length;r++)e+=c[r]*c[r];return Math.sqrt(e/c.length)},Co=function(c){let e=0;for(let r=0;r<c.length;r++){const o=Math.abs(c[r]);o>e&&(e=o)}return e},Yr=function(c){return c<1e-7?-100:20*Math.log10(c)};function El(c,e,r=.9){const o=e.numberOfChannels,h=e.length,u=e.sampleRate;let f=0;for(let S=0;S<o;S++){const F=e.getChannelData(S);for(let N=0;N<h;N++){const U=Math.abs(F[N]);U>f&&(f=U)}}if(f===0)return e;const y=r/f,P=c.createBuffer(o,h,u);for(let S=0;S<o;S++){const F=e.getChannelData(S),N=P.getChannelData(S);for(let U=0;U<h;U++)N[U]=F[U]*y}return P}const au=["pulse","bandlimited-sawtooth","supersaw","warm-pad","metallic","formant","white-noise","pink-noise","brown-noise","colored-noise","random-harmonic","custom-function"],ah=["sine","sawtooth","square","triangle",...au];function Tl(c){return au.includes(c)}function Il(c,e,r={}){switch(e){case"pulse":return Sl(c,{dutyCycle:r.dutyCycle,harmonics:r.harmonics});case"bandlimited-sawtooth":return Dl(c,{harmonics:r.harmonics,rolloff:r.rolloff});case"supersaw":return Ol(c,{voices:r.voices,detune:r.detune,harmonics:r.harmonics});case"warm-pad":return Cl(c,{brightness:r.brightness,harmonics:r.harmonics});case"metallic":return Rl(c,{inharmonicity:r.inharmonicity,harmonics:r.harmonics});case"formant":return Fl(c,{formantFreqs:r.formantFreqs,formantBandwidths:r.formantBandwidths,fundamentalFreq:r.fundamentalFreq,harmonics:r.harmonics});case"white-noise":return Bl(c,{harmonics:r.harmonics,seed:r.seed});case"pink-noise":return Vl(c,{harmonics:r.harmonics,seed:r.seed});case"brown-noise":return Kl(c,{harmonics:r.harmonics,seed:r.seed});case"colored-noise":return Wl(c,{slope:r.slope,harmonics:r.harmonics,seed:r.seed});case"random-harmonic":return ql(c,{chaos:r.chaos,harmonicDensity:r.harmonicDensity,harmonics:r.harmonics,seed:r.seed});case"custom-function":return Nl(c,r.waveFunction||(o=>Math.sin(o)),{harmonics:r.harmonics});default:throw new Error(`Invalid waveform type: ${e}`)}}function Sl(c,e={}){const{dutyCycle:r=.5,harmonics:o=32}=e,h=new Float32Array(o+1),u=new Float32Array(o+1);for(let f=1;f<=o;f++)h[f]=0,u[f]=2/Math.PI*Math.sin(f*Math.PI*r)/f;return c.createPeriodicWave(h,u,{disableNormalization:!1})}function Dl(c,e={}){const{harmonics:r=32,rolloff:o=1}=e,h=new Float32Array(r+1),u=new Float32Array(r+1);for(let f=1;f<=r;f++)h[f]=0,u[f]=1/f*Math.pow(f,-o+1),f%2===0&&(u[f]*=-1);return c.createPeriodicWave(h,u,{disableNormalization:!1})}function Ol(c,e={}){const{voices:r=7,detune:o=25,harmonics:h=16}=e,u=new Float32Array(h+1),f=new Float32Array(h+1);for(let y=0;y<r;y++){const P=y===0?0:(y%2===1?1:-1)*Math.ceil(y/2)*(o/Math.ceil(r/2)),S=Math.pow(2,P/1200);for(let F=1;F<=h;F++){const N=F*S;if(N<=h){const U=1/r*(1/F);f[Math.floor(N)]+=U*(F%2===1?1:-1)}}}return c.createPeriodicWave(u,f,{disableNormalization:!1})}function Cl(c,e={}){const{brightness:r=.3,harmonics:o=64}=e,h=new Float32Array(o+1),u=new Float32Array(o+1);for(let f=1;f<=o;f++){const y=1/f*Math.exp(-f*(1-r)*.1);f%2===1&&(u[f]=y),f%2===0&&f<=o/2&&(u[f]=y*.3)}return c.createPeriodicWave(h,u,{disableNormalization:!1})}function Rl(c,e={}){const{inharmonicity:r=.2,harmonics:o=32}=e,h=new Float32Array(o+1),u=new Float32Array(o+1);for(let f=1;f<=o;f++){const y=Math.sqrt(1+r*f*f),P=Math.round(f*y);if(P<=o){const S=1/(f*f);h[P]+=S*.3,u[P]+=S*.7}}return c.createPeriodicWave(h,u,{disableNormalization:!1})}function Fl(c,e={}){const{formantFreqs:r=[800,1200,2600],formantBandwidths:o=[80,120,260],fundamentalFreq:h=440,harmonics:u=64}=e,f=new Float32Array(u+1),y=new Float32Array(u+1);for(let P=1;P<=u;P++){const S=P*h;let F=1/P;for(let N=0;N<r.length;N++){const U=r[N],te=o[N]||100,H=Math.abs(S-U),ce=1/(1+Math.pow(H/te,2));F*=1+ce*2}y[P]=F*(P%2===1?1:-1)}return c.createPeriodicWave(f,y,{disableNormalization:!1})}function Nl(c,e,r={}){const{harmonics:o=32}=r,h=new Float32Array(o+1),u=new Float32Array(o+1),f=2048,y=new Float32Array(f);for(let P=0;P<f;P++){const S=P/f*2*Math.PI;y[P]=e(S)}for(let P=1;P<=o;P++){let S=0,F=0;for(let N=0;N<f;N++){const U=N/f*2*Math.PI*P;S+=y[N]*Math.cos(U),F+=y[N]*Math.sin(U)}h[P]=S/f,u[P]=F/f}return c.createPeriodicWave(h,u,{disableNormalization:!1})}function Bl(c,e={}){const{harmonics:r=64,seed:o}=e,h=new Float32Array(r+1),u=new Float32Array(r+1);let f=o!==void 0?o:Math.random()*1e6;const y=()=>(f=(f*9301+49297)%233280,f/233280);for(let P=1;P<=r;P++){const S=1/Math.sqrt(r),F=y()*2*Math.PI;h[P]=S*Math.cos(F),u[P]=S*Math.sin(F)}return c.createPeriodicWave(h,u,{disableNormalization:!1})}function Vl(c,e={}){const{harmonics:r=64,seed:o}=e,h=new Float32Array(r+1),u=new Float32Array(r+1);let f=o!==void 0?o:Math.random()*1e6;const y=()=>(f=(f*9301+49297)%233280,f/233280);for(let P=1;P<=r;P++){const S=1/Math.sqrt(P*r),F=y()*2*Math.PI;h[P]=S*Math.cos(F),u[P]=S*Math.sin(F)}return c.createPeriodicWave(h,u,{disableNormalization:!1})}function Kl(c,e={}){const{harmonics:r=64,seed:o}=e,h=new Float32Array(r+1),u=new Float32Array(r+1);let f=o!==void 0?o:Math.random()*1e6;const y=()=>(f=(f*9301+49297)%233280,f/233280);for(let P=1;P<=r;P++){const S=1/(P*Math.sqrt(r)),F=y()*2*Math.PI;h[P]=S*Math.cos(F),u[P]=S*Math.sin(F)}return c.createPeriodicWave(h,u,{disableNormalization:!1})}function Wl(c,e={}){const{slope:r=0,harmonics:o=64,seed:h}=e,u=new Float32Array(o+1),f=new Float32Array(o+1);let y=h!==void 0?h:Math.random()*1e6;const P=()=>(y=(y*9301+49297)%233280,y/233280);for(let S=1;S<=o;S++){const F=1/(Math.pow(S,r/2)*Math.sqrt(o)),N=P()*2*Math.PI;u[S]=F*Math.cos(N),f[S]=F*Math.sin(N)}return c.createPeriodicWave(u,f,{disableNormalization:!1})}function ql(c,e={}){const{chaos:r=.5,harmonicDensity:o=.7,harmonics:h=32,seed:u}=e,f=new Float32Array(h+1),y=new Float32Array(h+1);let P=u!==void 0?u:Math.random()*1e6;const S=()=>(P=(P*9301+49297)%233280,P/233280);for(let F=1;F<=h;F++)if(S()<o){const N=1/F,U=1+(S()-.5)*2*r,te=N*U,H=S()*2*Math.PI;S()>.5?f[F]=te*Math.cos(H):y[F]=te*Math.sin(H)}return c.createPeriodicWave(f,y,{disableNormalization:!1})}const uu=[["C"],["C#","Db"],["D"],["D#","Eb"],["E"],["F"],["F#","Gb"],["G"],["G#","Ab"],["A"],["A#","Bb"],["B"]],jl={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11},Ll={chromatic:[0,1,2,3,4,5,6,7,8,9,10,11],major:[0,2,4,5,7,9,11],minor:[0,2,3,5,7,8,10],harmonic_minor:[0,2,3,5,7,8,11],melodic_minor:[0,2,3,5,7,9,11],lydian:[0,2,4,6,7,9,10],dorian:[0,2,3,5,7,9,10],phrygian:[0,1,3,5,7,8,10],mixolydian:[0,2,4,5,7,9,10],locrian:[0,1,3,5,6,8,10],diminished:[0,2,3,5,6,8,9,11],augmented:[0,3,4,8,9],major_pentatonic:[0,2,4,7,9],minor_pentatonic:[0,2,3,7,8],blues:[0,3,5,6,7,10],whole_tone:[0,2,4,6,8,10]};function Ql(c,e=440){return e*Math.pow(2,(c-69)/12)}function Ul(c,e="semitones",r=440,o){const h=12*Math.log2(c/r)+69;return e==="semitones"?Math.round(h):h}function zl(c=0,e=9,r=440,o=4){const h=[],u=Math.pow(2,.08333333333333333),f=4*12+9;for(let y=c*12;y<=e*12+(e===8?0:11);y++){const P=r*Math.pow(u,y-f);h.push(Number(P.toFixed(o)))}return h}function Gl(c){return typeof c=="number"&&Number.isInteger(c)&&c>=0&&c<=127}function Wa(c,e=60){return Math.pow(2,(c-e)/12)}const Xo=zl(0,9),Yl=Xo.map(c=>1/c),Zl=Array.from({length:Xo.length},(c,e)=>{const r=Math.floor(e/12)-1,o=e%12;return`${uu[o][0]}${r}`}),Hl=uu,ko=jl,Ss=Xo,Xl=Yl,lu=Zl,cu=Ll,hu=c=>{const e=Ss.reduce((o,h)=>Math.abs(h-c)<Math.abs(o-c)?h:o),r=Ul(e);return Jl(r)};function Jl(c){const e=Ql(c),r=Math.floor(c/12)-1,o=c%12;return{name:Hl[o][0],octave:r,midiNote:c,frequency:e,period:1/e}}function _l(){const c={};return lu.forEach((e,r)=>{c[e]=Ss[r]}),$l(c),ec(c)}function $l(c){const e=[["C#","Db"],["D#","Eb"],["F#","Gb"],["G#","Ab"],["A#","Bb"]];for(let r=0;r<=8;r++)for(const[o,h]of e){const u=`${o}${r}`,f=`${h}${r}`;u in c&&!(f in c)?c[f]=c[u]:f in c&&!(u in c)&&(c[u]=c[f])}}function ec(c){return Object.fromEntries(Object.entries(c).sort((e,r)=>e[1]-r[1]))}const tc=_l();Object.fromEntries(Object.entries(tc).map(([c,e])=>[c,1/e]));function nc(c,e,r=0,o=8){if(!ko[c]&&ko[c]!==0)throw new Error(`Unknown root note: ${c}`);const h=[...typeof e=="string"?cu[e]:e],u=ko[c],f=[],y=[],P=[];for(let S=r;S<=o;S++)h.forEach(F=>{const N=S*12+(u+F)%12;N<Ss.length&&(f.push(Ss[N]),y.push(Xl[N]),P.push(lu[N]))});return{rootIdx:u,frequencies:f,periodsInSec:y,scalePattern:h,noteNames:P}}function rc(c,e){const r=Math.pow(2,e/12);return c.map(o=>o/r)}function fn(c,e,r){if(!c){const o=r?`
Context: ${JSON.stringify(r)}`:"";throw new Error(`Assertion failed${e?`: ${e}`:""}${o}`)}}function ic(c){return typeof c=="object"&&c!==null&&typeof c.then=="function"}async function Jo(c,e,r=!0){if(typeof c!="function")throw new Error("tryCatch argument must be a function");try{const o=c();if(ic(o))try{return{data:await o,error:null}}catch(h){return qa(h,e,r)}return{data:o,error:null}}catch(o){return qa(o,e,r)}}function qa(c,e,r=!0){if(r){const o=c.message??c;console.error(o)}return{data:null,error:c}}var Zr;class sc{constructor(){M(this,Zr,null);try{if(typeof window>"u"||typeof AudioContext>"u"){console.error("Environment util: Window or AudioContext is undefined");return}const e=window.AudioContext||window.webkitAudioContext,r=new e,o=r.createGain().gain,h=typeof navigator<"u"&&"keyboard"in navigator,u=typeof KeyboardEvent<"u"&&typeof KeyboardEvent.prototype.getModifierState=="function";g(this,Zr,{cancelAndHoldSupported:typeof o.cancelAndHoldAtTime=="function",workletSupported:typeof r.audioWorklet=="object",keyboardAPISupported:h,modifierStateSupported:u}),r.close().catch(console.error)}catch{g(this,Zr,{cancelAndHoldSupported:!1,workletSupported:!1,keyboardAPISupported:!1,modifierStateSupported:!1})}}get capabilities(){return i(this,Zr)}}Zr=new WeakMap;new sc;function oc(c,e,r="any",o=u=>u,h=(u,f)=>Math.abs(u-f)){if(c.length===0)throw new Error("Array cannot be empty");if(c.length===1)return 0;const u=e,f=o(c[0]),y=o(c[c.length-1]);if(u<=f)return 0;if(u>=y)return c.length-1;let P=0,S=c.length-1;for(;P<S-1;){const U=Math.floor((P+S)/2),te=o(c[U]);if(te===u)return U;te<u?P=U:S=U}if(r==="left")return P;if(r==="right")return S;const F=h(o(c[P]),u),N=h(o(c[S]),u);return F<=N?P:S}function ts(c,e,r="any",o=u=>u,h=(u,f)=>Math.abs(u-f)){const u=oc(c,e,r,o,h);return c[u]}const hn=(c,e,r,o={warn:!1})=>{if(o.warn&&(c<e||c>r)){const h=o.name?`(${o.name})`:"";console.warn(`Value${h} ${c} is outside range [${e}, ${r}], clamping to ${c<e?e:r}`)}return Math.max(e,Math.min(r,c))},an=(c,e,r,o,h,u={warn:!0})=>{if(c<e||c>r){const y=u.name?`(${u.name})`:"";u.warn&&console.warn(`Input value${y} ${c} is outside nominal range [${e}, ${r}]`),c=hn(c,e,r)}const f=(c-e)*(h-o)/(r-e)+o;return hn(f,Math.min(o,h),Math.max(o,h))};function ac(c,e){const{inputRange:r,outputRange:o,curve:h="linear"}=e;(c>r.max||c<r.min)&&console.warn("interpolate: Value outside of input range, will be clamped");let u=(Math.max(r.min,Math.min(c,r.max))-r.min)/(r.max-r.min);switch(h){case"linear":break;case"power1":u=Math.pow(u,1/1.5);break;case"power2":u=Math.pow(u,1/2);break;case"power3":u=Math.pow(u,1/3);break;case"power4":u=Math.pow(u,1/4);break;case"expo":u=u===0?0:Math.pow(2,10*(u-1));break;case"log":u=Math.log(1+9*u)/Math.log(10);break;case"sine":u=1-Math.cos(u*Math.PI/2);break;case"circ":u=1-Math.sqrt(1-u*u);break;default:typeof h=="number"&&(u=Math.pow(u,1/h));break}return o.min+u*(o.max-o.min)}function uc(c,e){const{inputRange:r,outputRange:o,blend:h=1,curve:u="linear"}=e;(c>r.max||c<r.min)&&console.warn("interpolateLinearToExp: Value outside of input range, will be clamped"),o.min<=0&&console.warn("interpolateLinearToExp: Output min must be > 0 for exponential interpolation");let f=(Math.max(r.min,Math.min(c,r.max))-r.min)/(r.max-r.min);const y=Math.max(0,Math.min(h,1)),P=typeof u=="number"?u:u==="smooth"?2:u==="steep"?3:u==="gentle"?1.5:1;P!==1&&(f=Math.pow(f,1/P));const S=o.min+f*(o.max-o.min),F=o.min*Math.pow(o.max/o.min,f);return(1-y)*S+y*F}const lc=1e-4;function cc(c,e=lc){const r=c.getChannelData(0),o=c.sampleRate,h=[];for(let u=1;u<r.length;u++)if(Math.abs(r[u])<e)h.push(u/o);else if(Math.sign(r[u])!==Math.sign(r[u-1])){const f=-r[u-1]/(r[u]-r[u-1]),y=(u-1+f)/o;h.push(y)}return h}const Mo=c=>{const e=c.values().next();if(!e.done)return c.delete(e.value),e.value};let Qn=null,Pi=null;function pn(c){return Qn||(Qn=new AudioContext({sampleRate:iu.sampleRate,latencyHint:"interactive"}),Qn.state==="suspended"&&(Pi=Pi||fu())),Qn}async function du(c){const e=pn();if(e.state==="running")return e;if(e.state==="closed"){Qn=null;const r=await Jo(()=>du(c));return fn(r.data instanceof AudioContext&&!r.error,"failed to re-created closed audio context",r.error),r.data}return Pi=Pi||fu(),await Pi,e}function fu(){if(typeof document>"u")return Promise.resolve();const c=["click","touchstart","keydown"];return new Promise(e=>{const r=async()=>{Qn&&(await Qn.resume(),c.forEach(o=>document.removeEventListener(o,r)),e())};c.forEach(o=>document.addEventListener(o,r,{once:!0}))})}var ss,rr,ir;class ja{constructor(){M(this,ss,null),M(this,rr,!1),M(this,ir,new Map)}async initialize(){if(i(this,rr))return!0;try{g(this,ss,await navigator.requestMIDIAccess());const e=i(this,ss).inputs.values();for(const r of e)r.onmidimessage=this.handleMidiMessage.bind(this),console.log(`MIDI input connected: ${r.name}`);return g(this,rr,!0),!0}catch(e){return console.error("Failed to initialize MIDI:",e),!1}}handleMidiMessage(e){const[r,o,h]=e.data,u=r&240;if(u===144&&h>0)for(const f of i(this,ir).values())f.onNoteOn(o,h);else if(u===128||u===144&&h===0)for(const f of i(this,ir).values())f.onNoteOff(o)}connectInstrument(e,r=0){i(this,rr)?i(this,ir).set(r,{onNoteOn:(o,h)=>e.play(o,h),onNoteOff:o=>e.release(o)}):console.log("connectInstrument failed: midi not initialized")}disconnectInstrument(e){i(this,ir).delete(e)}get isInitialized(){return i(this,rr)}}ss=new WeakMap,rr=new WeakMap,ir=new WeakMap;async function hc(c={echoCancellation:!1,noiseSuppression:!0,autoGainControl:!0}){return await navigator.mediaDevices.getUserMedia({audio:c})}const dc=30,fc=1e3,pc={off:0,low:.1,medium:.2,high:.3};async function pu(c,e="medium"){const r=c.getChannelData(0),o=pc[e];let h=0;for(let ue=0;ue<r.length;ue++){const dt=Math.abs(r[ue]);dt>h&&(h=dt)}const u=o>0?r.map(ue=>Math.abs(ue)>o*h?ue:0):r,f=Math.floor(c.sampleRate/fc),y=Math.floor(c.sampleRate/dc);let P=new Float32Array(y);for(let ue=f;ue<P.length;ue++){let dt=0;for(let qe=0;qe<u.length-ue;qe++)dt+=u[qe]*u[qe+ue];P[ue]=dt}let S=f;for(let ue=f;ue<y;ue++)P[ue]>P[S]&&(S=ue);const F=S,N=P[F-1],U=P[F],te=P[F+1],H=2*(2*U-N-te),ce=Math.abs(H)<1e-6?0:(te-N)/H,de=P[S],Se=Math.sqrt(u.reduce((ue,dt)=>ue+dt*dt,0)/u.length),yt=de/(Se*Se*u.length),Ei=Math.max(0,Math.min(1,yt));return{frequency:c.sampleRate/(F+ce),confidence:Ei}}function mc(c,e,r="samples"){const o=c.numberOfChannels,h=c.sampleRate,u=Array.from({length:o},(S,F)=>c.getChannelData(F));if(u.length===0||!u[0])throw new Error("AudioBuffer must contain at least one audio channel");const f=u[0].length;function y(){for(let S=0;S<f;S++)if(Math.max(...u.map(F=>Math.abs(F[S])))>e)return r==="seconds"?S/h:S;return 0}function P(){for(let S=f-1;S>=0;S--)if(Math.max(...u.map(F=>Math.abs(F[S])))>e)return r==="seconds"?S/h:S;return r==="seconds"?(f-1)/h:f-1}return{start:y(),end:P()}}function La(c,e,r,o){const h=Math.min(e+r,c.length);for(let u=e;u<h;u++){const f=(u-e)/r,y=o==="in"?f:1-f;c[u]*=y}}function gc(c,e,r,o,h=5){const u=e.numberOfChannels,f=o-r,y=c.createBuffer(u,f,e.sampleRate),P=Math.floor(h/1e3*e.sampleRate);for(let S=0;S<u;S++){const F=e.getChannelData(S),N=y.getChannelData(S);for(let U=0;U<f;U++)N[U]=F[r+U];f>P*2&&P>0&&(La(N,0,P,"in"),La(N,f-P,P,"out"))}return y}const vc={normalize:{enabled:!0,maxAmplitudePeak:.9},trimSilence:{enabled:!0,threshold:.01},fadeInOutMs:5,tune:{detectPitch:!0,autotune:!0,targetMidiNote:60},hpf:{auto:!0},getZeroCrossings:!0};async function mu(c,e,r=vc){var o,h;const{normalize:u,trimSilence:f,fadeInOutMs:y,tune:P,hpf:S,getZeroCrossings:F}=r;let N=e,U={};const te=.35;if(u!=null&&u.enabled&&(N=El(c,e,u.maxAmplitudePeak)),f!=null&&f.enabled){const{start:H,end:ce}=mc(N,f.threshold??.01);N=gc(c,N,H,ce,y)}if(P!=null&&P.detectPitch||P!=null&&P.autotune||S&&"auto"in S&&S.auto){const H=await wc(e),ce=(P==null?void 0:P.targetMidiNote)||60,de=bc(H.midiFloat,ce);U.detectedPitch={fundamentalHz:H.frequency,transpositionSemitones:de,confidence:H.confidence}}if(P!=null&&P.autotune&&(!((o=U.detectedPitch)!=null&&o.transpositionSemitones)||U.detectedPitch.confidence<te?console.info("Skipped autotune due to unreliable pitch detection"):N=yc(c,N,U.detectedPitch.transpositionSemitones)),F){const H=cc(e);U.zeroCrossings=H}if(S){if("cutoff"in S)N=await Qa(N,S.cutoff??80);else if(U.detectedPitch&&U.detectedPitch.confidence>=te){const H=(h=U.detectedPitch)==null?void 0:h.fundamentalHz,ce=H>30?H:80;N=await Qa(N,ce)}}return{...U,audiobuffer:N}}function yc(c,e,r){const o=Math.pow(2,r/12),h=e.length,u=Math.round(h/o),f=c.createBuffer(e.numberOfChannels,u,e.sampleRate);for(let y=0;y<e.numberOfChannels;y++){const P=e.getChannelData(y),S=f.getChannelData(y);for(let F=0;F<u;F++){const N=F*o,U=Math.floor(N),te=N-U;U+1<h?S[F]=P[U]*(1-te)+P[U+1]*te:S[F]=P[U]}}return f}async function wc(c,e=!1){const r=await pu(c),o=hu(r.frequency),h=69+12*Math.log2(r.frequency/440),u=o.frequency/r.frequency;return e&&console.table({pitchSource:r,targetNoteInfo:o,playbackRateMultiplier:u,midiFloat:h}),{frequency:r.frequency,confidence:r.confidence,midiFloat:h,targetNoteInfo:o}}function bc(c,e){let r=e-c;for(;r>6;)r-=12;for(;r<-6;)r+=12;return r}async function Qa(c,e,r=.5){const o=new OfflineAudioContext(c.numberOfChannels,c.length,c.sampleRate),h=o.createBufferSource(),u=o.createBiquadFilter();return u.type="highpass",u.frequency.value=e,u.Q.value=r,h.buffer=c,h.connect(u),u.connect(o.destination),h.start(0),await o.startRendering()}let Ac=-1;const gu=new Map,Ot=(c,e)=>{const r=`${++Ac}-${c}`;return gu.set(r,e),r},Ct=c=>{gu.delete(c)||console.debug("Attempted to unregister a non-existent Node ID: ",c)};function mn(c){const e=new Map;return{sendMessage(r,o){const h=e.get(r);if(h){const u={type:r,senderId:c,...o};h.forEach(f=>f(u))}},onMessage(r,o){e.has(r)||e.set(r,new Set);const h=e.get(r);return h.add(o),()=>h.delete(o)},forwardFrom(r,o,h){const u=h||(y=>({...y})),f=o.map(y=>r.onMessage(y,P=>{const S=u(P);S!==null&&this.sendMessage(S.type,S)}));return()=>f.forEach(y=>y())}}}var sr,kr,Ds,Ht,Bt,Pe,Re,Hr,os;class Pc{constructor(e=[],r=[0,1],o,h,u){M(this,Hr),M(this,sr),M(this,kr,0),M(this,Ds,!1),M(this,Ht),M(this,Bt,null),M(this,Pe),M(this,Re),q(this,"updateStartPoint",(f,y)=>{this.updatePoint(i(this,Ht),f,y)}),q(this,"updateEndPoint",(f,y)=>{this.updatePoint(i(this,Re),f,y)}),q(this,"setValueRange",f=>g(this,sr,f)),this.points=e,fn(e.length>=2,"EnvelopeData needs at least two points to initialize"),g(this,kr,o),g(this,sr,r),g(this,Ht,0),g(this,Re,e.length-1),g(this,Bt,h!==void 0&&e[h]?h:null),g(this,Pe,u!==void 0&&e[u]?u:Math.max(0,i(this,Re)-1))}addPoint(e,r,o="exponential"){const h={time:e,value:r,curve:o};if(this.points.length>=2){const f=this.points[this.startPointIndex].time,y=this.points[i(this,Re)].time;if(e<=f||e>=y){console.warn(`Cannot add point at time ${e}. Must be between ${f} and ${y}`);return}}const u=this.points.findIndex(f=>f.time>e);u===-1?(this.points.push(h),g(this,Re,this.points.length-1)):(this.points.splice(u,0,h),g(this,Re,this.points.length-1),i(this,Bt)!==null&&u<=i(this,Bt)&&Po(this,Bt)._++,i(this,Pe)!==null&&u<=i(this,Pe)&&Po(this,Pe)._++),K(this,Hr,os).call(this)}updatePoint(e,r,o){if(e>=0&&e<this.points.length){if(e===this.startPointIndex||e===this.endPointIndex)return;const h=this.points[e];let u=r??h.time;if(e===1&&u<=this.points[i(this,Ht)].time||e===i(this,Re)-1&&u>=this.points[i(this,Re)].time)return;this.points[e]={...h,time:u,value:o??h.value}}K(this,Hr,os).call(this)}deletePoint(e){this.points.length>2&&e>i(this,Ht)&&e<i(this,Re)&&(this.points.splice(e,1),g(this,Re,this.points.length-1)),i(this,Pe)!==null&&(e<i(this,Pe)?Po(this,Pe)._--:e===i(this,Pe)&&g(this,Pe,i(this,Re)>i(this,Pe)+1?i(this,Pe)+1:Math.max(0,i(this,Re)-1))),K(this,Hr,os).call(this)}interpolateValueAtTime(e){if(this.points.length===0)return i(this,sr)[0];if(this.points.length===1)return this.points[0].value;const r=[...this.points].sort((h,u)=>h.time-u.time);let o=0;if(e<=r[0].time)o=r[0].value;else if(e>=r[r.length-1].time)o=r[r.length-1].value;else{o=0;for(let h=0;h<r.length-1;h++){const u=r[h],f=r[h+1];if(e>=u.time&&e<=f.time){const y=f.time-u.time,P=y===0?0:(e-u.time)/y;u.curve==="exponential"&&u.value>0&&f.value>0?o=u.value*Math.pow(f.value/u.value,P):o=u.value+(f.value-u.value)*P;break}}}return o}setSustainPoint(e){if(e==null){g(this,Bt,null);return}e>=0&&e<this.points.length&&g(this,Bt,e)}setReleasePoint(e){e>=0&&e<this.points.length?g(this,Pe,e):console.error("EnvelopeData.setReleasePoint: invalid index")}get startPointIndex(){return i(this,Ht)}get sustainPointIndex(){return i(this,Bt)}get releasePointIndex(){return i(this,Pe)>=this.points.length&&g(this,Pe,Math.max(0,this.points.length-2)),i(this,Pe)}get endPointIndex(){return i(this,Re)}get valueRange(){return i(this,sr)}get startTime(){var e;return((e=this.points[i(this,Ht)])==null?void 0:e.time)??0}get endTime(){var e;return((e=this.points[i(this,Re)])==null?void 0:e.time)??i(this,kr)}get durationSeconds(){return this.endTime-this.startTime}setDurationSeconds(e){g(this,kr,e)}get hasSharpTransitions(){return i(this,Ds)}}sr=new WeakMap,kr=new WeakMap,Ds=new WeakMap,Ht=new WeakMap,Bt=new WeakMap,Pe=new WeakMap,Re=new WeakMap,Hr=new WeakSet,os=function(){const c=.02*i(this,kr);g(this,Ds,this.points.some((e,r)=>r>0&&Math.abs(e.time-this.points[r-1].time)<c))};var as,un,Xr,ae,Xt,or,Sn,qn,Dn,Dt,ke,Gr,xo,ns,vu,Jr,Ge,ln,Jt,yu,wu,rs;class Eo{constructor(e,r,o,h=[],u=[0,1],f=1,y=!0){switch(M(this,ke),q(this,"nodeId"),q(this,"nodeType","default-env"),M(this,as,!1),M(this,un),M(this,Xr),M(this,ae),M(this,Xt),q(this,"envelopeType"),M(this,or),M(this,Sn,!1),M(this,qn,!1),M(this,Dn,1),M(this,Dt,1),q(this,"addPoint",(P,S,F)=>{i(this,ae).addPoint(P,S,F),i(this,Ge)&&g(this,ln,!0)}),q(this,"deletePoint",P=>{i(this,ae).deletePoint(P),i(this,Ge)&&g(this,ln,!0)}),q(this,"updatePoint",(P,S,F)=>{i(this,ae).updatePoint(P,S,F),i(this,Ge)&&g(this,ln,!0)}),q(this,"setValueRange",P=>i(this,ae).setValueRange(P)),q(this,"enable",()=>g(this,or,!0)),q(this,"disable",()=>g(this,or,!1)),M(this,Jr,!1),M(this,Ge,!1),M(this,ln,!1),M(this,Jt,()=>i(this,Sn)&&!i(this,Jr)),q(this,"setTimeScale",P=>{g(this,Dt,P),i(this,Ge)&&g(this,ln,!0)}),q(this,"setLoopEnabled",(P,S="normal")=>{S!=="normal"&&console.info("Only default env loop mode implemented. Other modes coming soon!"),g(this,Sn,P)}),q(this,"syncToPlaybackRate",P=>{g(this,qn,P)}),q(this,"setSustainPoint",P=>i(this,ae).setSustainPoint(P)),q(this,"setReleasePoint",P=>i(this,ae).setReleasePoint(P)),this.envelopeType=r,this.nodeType=r,this.nodeId=Ot(this.envelopeType,this),g(this,un,e),g(this,Xr,mn(this.nodeId)),r){case"amp-env":g(this,Xt,"envGain");break;case"pitch-env":g(this,Xt,"playbackRate");break;case"filter-env":g(this,Xt,"lpf");break;case"loop-env":g(this,Xt,"loopEnd"),console.warn("CustomEnvelope not implemnted for type: loop-env");break;default:console.error(`CustomEnvelope not implemented for type: ${r}`),g(this,Xt,"default");break}g(this,or,y),g(this,ae,o||new Pc([...h],u,f)),g(this,as,!0)}setSampleDuration(e){return i(this,ae).setDurationSeconds(e),this}get initialized(){return i(this,as)}get data(){return i(this,ae)}get param(){return i(this,Xt)}get isEnabled(){return i(this,or)}get points(){return i(this,ae).points}get fullDuration(){return i(this,ae).durationSeconds}get timeScale(){return i(this,Dt)}get valueRange(){return i(this,ae).valueRange}get loopEnabled(){return i(this,Sn)}get syncedToPlaybackRate(){return i(this,qn)}get numPoints(){return i(this,ae).points.length}triggerEnvelope(e,r,o={baseValue:1,playbackRate:1}){g(this,Jr,!1),g(this,Dn,o.playbackRate),i(this,Sn)?K(this,ke,yu).call(this,e,r,o):K(this,ke,vu).call(this,e,r,o)}releaseEnvelope(e,r,o){g(this,Jr,!0);const h=this.releasePointIndex;K(this,ke,wu).call(this,e,r,h,{baseValue:e.value,playbackRate:i(this,Dn),...o})}get sustainPointIndex(){return i(this,ae).sustainPointIndex}get releasePointIndex(){return i(this,ae).releasePointIndex}get releasePoint(){return this.points[this.releasePointIndex]||null}get releaseTime(){const e=this.points[this.points.length-1].time-this.points[this.releasePointIndex].time;return i(this,qn)?e/i(this,Dn)/i(this,Dt):e/i(this,Dt)}get sustainEnabled(){return this.sustainPoint!==null&&!this.loopEnabled}get sustainPoint(){return this.sustainPointIndex!==null?this.points[this.sustainPointIndex]:null}get currentPlaybackRate(){return i(this,Dn)}setCurrentPlaybackRate(e){g(this,Dn,e),i(this,qn)&&i(this,Ge)&&g(this,ln,!0)}onMessage(e,r){return i(this,Xr).onMessage(e,r)}sendUpstreamMessage(e,r){return i(this,Xr).sendMessage(e,r),this}hasVariation(){var e;const r=((e=this.points[0])==null?void 0:e.value)??0;return this.points.some(o=>Math.abs(o.value-r)>.001)}static getDefaults(e,r=1){switch(e){case"amp-env":return{points:[{time:0,value:0,curve:"exponential"},{time:.005,value:1,curve:"exponential"},{time:.67,value:.75,curve:"exponential"},{time:r-.1,value:.5,curve:"exponential"},{time:r,value:0,curve:"exponential"}],paramValueRange:[0,1],initEnable:!0,sustainPointIndex:null,releasePointIndex:3};case"pitch-env":return{points:[{time:0,value:.5,curve:"exponential"},{time:r,value:.5,curve:"exponential"}],paramValueRange:[.5,1.5],initEnable:!1,sustainPointIndex:null,releasePointIndex:1};case"filter-env":return{points:[{time:0,value:250,curve:"exponential"},{time:.1,value:18e3,curve:"exponential"},{time:r,value:0,curve:"exponential"}],paramValueRange:[20,2e4],initEnable:!1,sustainPointIndex:null,releasePointIndex:2};default:return{points:[{time:0,value:0,curve:"linear"},{time:.1,value:1,curve:"linear"},{time:r,value:0,curve:"linear"}],paramValueRange:[0,1],initEnable:!0,sustainPointIndex:null,releasePointIndex:1}}}dispose(){g(this,Sn,!1),Ct(this.nodeId)}}as=new WeakMap,un=new WeakMap,Xr=new WeakMap,ae=new WeakMap,Xt=new WeakMap,or=new WeakMap,Sn=new WeakMap,qn=new WeakMap,Dn=new WeakMap,Dt=new WeakMap,ke=new WeakSet,Gr=function(c,e,r=1,o=1){if(c<0||e>=this.points.length||c>=e)return 0;const h=this.points[c].time;let u=this.points[e].time-h;return i(this,qn)&&(u=u/r),u/o},xo=function(c){return this.envelopeType==="filter-env"?c<1?1e3:750:i(this,ae).hasSharpTransitions?1e3:c<1?500:250},ns=function(c,e=this.fullDuration,r){const o=K(this,ke,xo).call(this,c),h=Math.max(2,Math.floor(c*o)),u=new Float32Array(h),{baseValue:f,minValue:y,maxValue:P,startFromValue:S}=r;for(let F=0;F<h;F++){const N=F/(h-1)*e;let U=i(this,ae).interpolateValueAtTime(N);S!==void 0&&F===0?U=S:f!==1&&(U=U*f),y!==void 0&&(U=Math.max(U,y)),P!==void 0&&(U=Math.min(U,P)),u[F]=K(this,ke,rs).call(this,U)}return u},vu=function(c,e,r){var o;const h=this.sustainEnabled?this.sustainPointIndex??this.points.length-1:this.points.length-1,u=K(this,ke,Gr).call(this,0,h,r.playbackRate,i(this,Dt)),f=K(this,ke,ns).call(this,u,this.sustainEnabled?((o=this.sustainPoint)==null?void 0:o.time)??this.fullDuration:this.fullDuration,{...r,startFromValue:c.value});r.voiceId!==void 0&&this.sendUpstreamMessage(`${this.envelopeType}:trigger`,{voiceId:r.voiceId,midiNote:r.midiNote||60,duration:u,sustainEnabled:this.sustainEnabled,loopEnabled:!1,sustainPoint:this.sustainPoint,releasePoint:this.releasePoint});const y=Math.max(i(this,un).currentTime,e);try{c.cancelScheduledValues(y),c.setValueAtTime(f[0],y),c.setValueCurveAtTime(f,y,u)}catch{console.debug("Failed to apply envelope curve due to rapid fire.");try{const P=c.value;c.cancelScheduledValues(y),c.setValueAtTime(P,y),c.linearRampToValueAtTime(f[f.length-1],y+u)}catch{try{c.setValueAtTime(f[f.length-1],y)}catch{}}}},Jr=new WeakMap,Ge=new WeakMap,ln=new WeakMap,Jt=new WeakMap,yu=function(c,e,r){if(!i(this,Jt).call(this)){g(this,Ge,!1);return}let o=K(this,ke,Gr).call(this,i(this,ae).startPointIndex,i(this,ae).endPointIndex,r.playbackRate,i(this,Dt)),h=K(this,ke,ns).call(this,o,this.fullDuration,{...r,startFromValue:c.value});r.voiceId!==void 0&&this.sendUpstreamMessage(`${this.envelopeType}:trigger`,{voiceId:r.voiceId,midiNote:r.midiNote||60,duration:o,sustainEnabled:!1,loopEnabled:!0,sustainPoint:this.sustainPoint,releasePoint:this.releasePoint});let u=Math.max(i(this,un).currentTime,e);const f=Math.max(.15,Math.min(o*3,.5)),y=.005;let P=0,S=0;g(this,Ge,!0);let F=!1,N=null;const U=()=>{if(!i(this,Jt).call(this)){g(this,Ge,!1);return}if(N!==null&&(clearTimeout(N),N=null),!F){F=!0;try{for(i(this,ln)&&(o=K(this,ke,Gr).call(this,i(this,ae).startPointIndex,i(this,ae).endPointIndex,r.playbackRate,i(this,Dt)),h=K(this,ke,ns).call(this,o,this.fullDuration,{...r,startFromValue:c.value}));u<i(this,un).currentTime+f&&u>=P;){if(!i(this,Jt).call(this)){g(this,Ge,!1);return}const te=o-y;try{c.setValueCurveAtTime(h,u,te)}catch{S++,S>=100&&(console.debug(`Multiple curve overlaps in looping envelope, nr of overlaps: ${S} 
                (loop duration: ${o.toFixed(3)}s, buffer: ${y})`),S=0)}if(u+=o+y,P=u,r.voiceId!==void 0){const H=i(this,un).getOutputTimestamp();if(H.contextTime!==void 0&&H.performanceTime!==void 0){const ce=u-H.contextTime,de=H.performanceTime+ce*1e3,Se=Math.max(0,de-performance.now());setTimeout(()=>{if(!i(this,Jt).call(this)){g(this,Ge,!1);return}this.sendUpstreamMessage(`${this.envelopeType}:trigger:loop`,{voiceId:r.voiceId,midiNote:r.midiNote||60,duration:o})},Se)}else{if(!i(this,Jt).call(this)){g(this,Ge,!1);return}this.sendUpstreamMessage(`${this.envelopeType}:trigger:loop`,{voiceId:r.voiceId,midiNote:r.midiNote||60,duration:o})}}}N=setTimeout(()=>{if(!i(this,Jt).call(this)){g(this,Ge,!1);return}U()},100)}finally{F=!1}}};U()},wu=function(c,e,r,o){const{baseValue:h=1}=o,u=this.points[r],f=this.points[this.points.length-1],y=Math.max(i(this,un).currentTime,e),P=f.time-u.time,S=K(this,ke,Gr).call(this,r,this.points.length-1,o.playbackRate,i(this,Dt));if(S<=1e-4)return;const F=c.value,N=K(this,ke,rs).call(this,i(this,ae).interpolateValueAtTime(f.time)),U=K(this,ke,xo).call(this,S),te=Math.max(2,Math.floor(S*U)),H=new Float32Array(te);for(let de=0;de<te;de++){const Se=de/(te-1),yt=u.time+Se*P;H[de]=K(this,ke,rs).call(this,i(this,ae).interpolateValueAtTime(yt))}const ce=this.points[this.releasePointIndex];o.voiceId!==void 0&&this.sendUpstreamMessage(`${this.envelopeType}:release`,{voiceId:o.voiceId,midiNote:o.midiNote||60,releasePoint:{normalizedTime:ce.time/this.fullDuration,value:ce.value},remainingDuration:S});try{c.cancelScheduledValues(y),c.setValueAtTime(F,y);const de=new Float32Array(H.length);for(let Se=0;Se<H.length;Se++){const yt=Se/(H.length-1);de[Se]=F+yt*(H[Se]-F)}c.setValueCurveAtTime(de,y,S)}catch{try{c.cancelScheduledValues(y),c.setValueAtTime(F,y),c.linearRampToValueAtTime(N,y+S)}catch(de){console.warn("Fallback linear ramp also failed:",de);try{c.setValueAtTime(N,y)}catch(Se){console.warn("All AudioParam operations failed:",Se)}}}},rs=function(c){const[e,r]=i(this,ae).valueRange;return Math.max(e,Math.min(r,c))};function To(c,e,r={}){const{durationSeconds:o=2,points:h,sustainPointIndex:u,releasePointIndex:f,paramValueRange:y,initEnable:P,sharedData:S}=r;if(S)return new Eo(c,e,S);const F=Eo.getDefaults(e,o),N=h||F.points;let U=y||F.paramValueRange;const te=P!==void 0?P:F.initEnable,H=u!==void 0?u:F.sustainPointIndex,ce=f!==void 0?f:F.releasePointIndex,de=new Eo(c,e,void 0,N,U,o,te);return de.setSustainPoint(H),ce&&de.setReleasePoint(ce),de}class kc{constructor(){q(this,"timers",new Map)}debounce(e,r,o){return(...h)=>{this.timers.has(e)&&clearTimeout(this.timers.get(e)),this.timers.set(e,setTimeout(()=>{r(...h),this.timers.delete(e)},o))}}cancel(e){this.timers.has(e)&&(clearTimeout(this.timers.get(e)),this.timers.delete(e))}}var it,Ee,us,Mr,qt,ls,_r,cs,bu,Au,Pu;class Ua{constructor(e,r){M(this,cs),q(this,"nodeType","macro"),q(this,"nodeId"),M(this,it),M(this,Ee),M(this,us),M(this,Mr),M(this,qt,""),M(this,ls,!1),q(this,"descriptor"),M(this,_r,0),M(this,Pu,(o,h,u,f,y)=>{console.debug("adjusting param: ",i(this,qt),"targetValue",o,"constant",h,"targetPeriod",u,"quantizedPeriod",f,"result",y)}),this.descriptor=r,g(this,it,new Mc(e,r.defaultValue)),g(this,Ee,new xc),g(this,us,new kc),g(this,Mr,mn(i(this,it).nodeId)),this.nodeId=i(this,it).nodeId,g(this,ls,!0)}addTarget(e,r,o=1){return i(this,qt)||g(this,qt,r),fn(r===i(this,qt),"Macros only support a single ParamType"),i(this,it).addTarget(e,o),this}ramp(e,r,o,h={}){if(e===i(this,_r))return this;g(this,_r,e);const{method:u="exponential",debounceMs:f=20,onComplete:y,onCompleteDelayMs:P=30}=h,S=()=>{let F=K(this,cs,bu).call(this,e,o);i(this,it).ramp(F,r,u,!0),y&&setTimeout(y,r*1e3+P)};return f===0?S():i(this,us).debounce(this.nodeId,S,f)(),this}debugProcessVal(e,r,o){console.log("MacroParam.#processValue input:",{value:e,constant:r,targetPeriod:o,hasValueSnapping:i(this,Ee).hasValueSnapping,hasPeriodSnapping:i(this,Ee).hasPeriodSnapping,longestPeriod:i(this,Ee).longestPeriod})}setAllowedParamValues(e,r){return i(this,Ee).setAllowedValues(e,r)}setAllowedPeriods(e,r,o=!1){return i(this,Ee).setAllowedPeriods(e,r,o)}setScale(e){const{rootNote:r,scale:o,tuningOffset:h=0,lowestOctave:u=0,highestOctave:f=8}=e,y=Array.isArray(o)?o:cu[o];return i(this,Ee).setScale(r,y,h,u,f,e.normalize,e.snapToZeroCrossings)}setValue(e,r){return i(this,it).setValue(e,r),K(this,cs,Au).call(this,e),g(this,_r,e),this}getValue(){return i(this,it).value}get targets(){return i(this,it).targets}get snapper(){return i(this,Ee)}get isReady(){return i(this,ls)}get now(){throw new Error("Not implemented")}get audioParam(){return i(this,it).param}get type(){return i(this,qt)}get longestPeriod(){return i(this,Ee).longestPeriod}onChange(e){return this.onMessage("value:changed",e)}onMessage(e,r){return i(this,Mr).onMessage(e,r)}sendMessage(e,r){i(this,Mr).sendMessage(e,r)}dispose(){i(this,it).dispose()}connect(e,r,o){return this.addTarget(e,r,o),this}disconnect(e){throw new Error("Not implemented")}}it=new WeakMap,Ee=new WeakMap,us=new WeakMap,Mr=new WeakMap,qt=new WeakMap,ls=new WeakMap,_r=new WeakMap,cs=new WeakSet,bu=function(c,e){if(!Number.isFinite(c)||!Number.isFinite(e))return c;const r=Math.abs(c-e);if(i(this,Ee).hasPeriodSnapping&&r<i(this,Ee).longestPeriod){const o=i(this,Ee).snapToMusicalPeriod(r);let h;if(i(this,qt)==="loopEnd"&&(h=e+o),i(this,qt)==="loopStart"&&(h=Math.max(0,e-o),h>=e-.001)){const u=i(this,Ee).periods.filter(f=>f<o);if(u.length>0){const f=Math.max(...u);h=e-f}else h=Math.max(0,e-.001)}if(h!==void 0)return h}else if(i(this,Ee).hasValueSnapping)return i(this,Ee).snapToValue(c);return c},Au=function(c){i(this,Mr).sendMessage("value:changed",{value:c})},Pu=new WeakMap;var Vt,ft,$r,ei;const ku=class Ro{constructor(e,r=Ro.MIN_EXPONENTIAL_RAMP_VALUE){q(this,"nodeId"),q(this,"nodeType","audio-param-controller"),M(this,Vt),M(this,ft),M(this,$r,[]),M(this,ei,!1),g(this,Vt,e),this.nodeId=Ot(this.nodeType,this),g(this,ft,e.createConstantSource()),i(this,ft).offset.setValueAtTime(r,e.currentTime),document.addEventListener("click",this.initOnUserGesture.bind(this),{once:!0})}initOnUserGesture(){i(this,ei)||(i(this,Vt).state==="suspended"?i(this,Vt).resume().then(()=>{i(this,ft).start()}):i(this,ft).start(),g(this,ei,!0))}addTarget(e,r=1){if(r===1)i(this,ft).connect(e),i(this,$r).push({param:e});else{const o=new GainNode(i(this,Vt),{gain:r});i(this,ft).connect(o),o.connect(e),i(this,$r).push({param:e,scaler:o})}return this}ramp(e,r,o="exponential",h=!0){const u=i(this,Vt).currentTime;h&&this.param.cancelScheduledValues(u);const f=this.param.value;if(this.param.setValueAtTime(f,u),o==="exponential"){const y=Math.max(e,Ro.MIN_EXPONENTIAL_RAMP_VALUE);this.param.exponentialRampToValueAtTime(y,u+r)}else this.param.linearRampToValueAtTime(e,u+r);return this}setValue(e,r=this.now,o=!0){return o&&this.param.cancelScheduledValues(r),this.param.setValueAtTime(e,r),this}get targets(){return i(this,$r)}get context(){return i(this,Vt)}get now(){return i(this,Vt).currentTime}get param(){return i(this,ft).offset}get value(){return this.param.value}get initialized(){return i(this,ei)}dispose(){i(this,ft).stop(),i(this,ft).disconnect(),Ct(this.nodeId)}};Vt=new WeakMap,ft=new WeakMap,$r=new WeakMap,ei=new WeakMap,q(ku,"MIN_EXPONENTIAL_RAMP_VALUE",1e-6);let Mc=ku;const za=(c,e)=>{const{from:r,to:o}=e,[h,u]=r,[f,y]=o,P=(y-f)/(u-h);if(Array.isArray(c))return c.map(S=>{const F=Math.max(h,Math.min(u,S));return f+(F-h)*P});{const S=Math.max(h,Math.min(u,c));return f+(S-h)*P}};var ar,Je,ti,Mu;class xc{constructor(){M(this,Mu),M(this,ar,[]),M(this,Je,[]),M(this,ti,0),q(this,"paramType",null)}setScale(e,r,o=0,h=0,u=8,f,y=!1){const P=[...r];let S=nc(e,P,h,u).periodsInSec.sort((F,N)=>F-N);return o!==0&&(S=rc(S,-o)),this.setAllowedPeriods(S,f,y)}setAllowedPeriods(e,r,o=!1,h="any"){let u=r?za([...e],r):e;return g(this,Je,[...u].sort((f,y)=>f-y)),g(this,ti,i(this,Je).length-1),i(this,Je)}snapToValue(e,r=i(this,ar),o,h="any"){if(r.length===0)return e;if(o===void 0)return ts(r,e);const u=r.filter(f=>Math.abs(f-e)<=o);if(u.length>0)return ts(u,e,h);if(o!==void 0){const f=ts(r,e,h),y=Math.sign(f-e);return e+y*o}return e}snapToMusicalPeriod(e,r=i(this,Je)){if(r.length===0||e>this.longestPeriod)return e;if(e<=this.shortestPeriod)return this.shortestPeriod;const o=i(this,Je)[i(this,ti)];if(e===o)return e;const h=e>o?"right":"left",u=ts(r,e,h);return g(this,ti,i(this,Je).indexOf(u)),u}setAllowedValues(e,r){const o=r?za(e,r):e;return g(this,ar,[...o].sort((h,u)=>h-u)),i(this,ar)}get periods(){return i(this,Je)}get shortestPeriod(){return i(this,Je)[0]}get longestPeriod(){const e=i(this,Je).length-1;return i(this,Je)[e]}get hasValueSnapping(){return i(this,ar).length>0}get hasPeriodSnapping(){return i(this,Je).length>0}}ar=new WeakMap,Je=new WeakMap,ti=new WeakMap,Mu=new WeakSet;const xu=c=>Math.floor(c/2-1e3),Fo=xu(48e3),Ga=10,Ec=100,Tc=Fo,Ya=10,Be={PLAYBACK_RATE:{nodeId:"playback-rate",name:"playback-rate",dataType:"number",minValue:-4,maxValue:4,step:1e-4,defaultValue:1,group:"pitch",automationRate:"k-rate"},ATTACK:{nodeId:"attack-time",name:"attack-time",dataType:"number",minValue:0,maxValue:5,step:.001,defaultValue:.01,group:"amp-env",automationRate:"k-rate"},RELEASE:{nodeId:"release-time",name:"release-time",dataType:"number",minValue:0,maxValue:5,step:.001,defaultValue:.05,group:"amp-env",automationRate:"k-rate"},LOOP_START:{nodeId:"loop-start",name:"loop-start",dataType:"number",minValue:0,maxValue:9999,step:.001,defaultValue:0,group:"loop-points",automationRate:"k-rate"},LOOP_END:{nodeId:"loop-end",name:"loop-end",dataType:"number",minValue:0,maxValue:9999,step:.001,defaultValue:9999,group:"loop-points",automationRate:"k-rate"},LOOP_RAMP_DURATION:{nodeId:"loop-point-ramp",name:"loop-point-ramp",dataType:"number",minValue:.001,maxValue:1,step:.001,defaultValue:.5,group:"loop-points",automationRate:"k-rate"},START_POINT:{nodeId:"start-point",name:"start-point",dataType:"number",minValue:0,maxValue:9999,step:.001,defaultValue:0,group:"trim-sample",automationRate:"k-rate"},END_POINT:{nodeId:"end-point",name:"end-point",dataType:"number",minValue:0,maxValue:9999,step:.001,defaultValue:9999,group:"trim-sample",automationRate:"k-rate"},LOWPASS_CUTOFF:{nodeId:"lpf-freq",name:"lpf-freq",dataType:"number",minValue:Ga,maxValue:Fo,step:Ya,defaultValue:Tc,group:"filter:lpf",automationRate:"k-rate"},HIGHPASS_CUTOFF:{nodeId:"hpf-freq",name:"hpf-freq",dataType:"number",minValue:Ga,maxValue:Fo,step:Ya,defaultValue:Ec,group:"filter:hpf",automationRate:"k-rate"}};var _t,Ve,Pt,ur,ni,ri;class No{constructor(e){M(this,_t),M(this,Ve),M(this,Pt),M(this,ur,new Set),M(this,ni,!1),M(this,ri,null),q(this,"storeCurrentValues",()=>{g(this,ri,{rate:i(this,Ve).frequency.value,depth:i(this,Pt).gain.value})}),q(this,"getStoredValues",()=>i(this,ri)),g(this,_t,e),g(this,Ve,e.createOscillator()),g(this,Pt,e.createGain()),i(this,Ve).frequency.value=1,i(this,Pt).gain.value=0,i(this,Ve).connect(i(this,Pt)),document.addEventListener("click",this.initOnUserGesture.bind(this),{once:!0})}initOnUserGesture(){i(this,ni)||(i(this,_t).state==="suspended"?i(this,_t).resume().then(()=>{i(this,Ve).start()}):i(this,Ve).start(),g(this,ni,!0))}setFrequency(e,r=this.now){i(this,Ve).frequency.setValueAtTime(e,r)}setDepth(e,r=this.now){i(this,Pt).gain.setValueAtTime(e,r)}setWaveform(e,r){if(e instanceof PeriodicWave)i(this,Ve).setPeriodicWave(e);else if(typeof e=="string"&&Tl(e)){const o=Il(i(this,_t),e,r);i(this,Ve).setPeriodicWave(o)}else i(this,Ve).type=e}setPeriodicWave(e){i(this,Ve).setPeriodicWave(e)}connect(e){i(this,Pt).connect(e),i(this,ur).add(e)}disconnect(e){e?(i(this,Pt).disconnect(e),i(this,ur).delete(e)):(i(this,Pt).disconnect(),i(this,ur).clear())}setMusicalNote(e,r={}){const{divisor:o=1,glideTime:h=0,timestamp:u=this.now}=r,f=440*Math.pow(2,(e-69)/12)/o;if(h<=.001)return this.setFrequency(f,u),this;if(r.glideFromMidiNote){const y=440*Math.pow(2,(r.glideFromMidiNote-69)/12)/o;this.setFrequency(y,u)}i(this,Ve).frequency.setTargetAtTime(f,u+.001,h)}getPitchWobbleWaveform(){const e=new Float32Array(8),r=new Float32Array(8);e[0]=0,r[0]=0;for(let o=1;o<8;o++)e[o]=Math.random()*.5,r[o]=Math.random()*.5;return i(this,_t).createPeriodicWave(e,r,{disableNormalization:!0})}get now(){return i(this,_t).currentTime}dispose(){g(this,ni,!1),i(this,ur).clear(),g(this,ri,null),i(this,Ve).stop(),this.disconnect()}}_t=new WeakMap,Ve=new WeakMap,Pt=new WeakMap,ur=new WeakMap,ni=new WeakMap,ri=new WeakMap;var ii,hs,st,lr,Kt,cr,si;class ot{constructor(e,r,o,h={}){q(this,"nodeId"),q(this,"nodeType"),M(this,ii),M(this,hs,!1),M(this,st),M(this,lr),M(this,Kt),M(this,cr,new Set),M(this,si,new Set),this.nodeType=o,this.nodeId=Ot(o,this),g(this,ii,mn(this.nodeId)),g(this,st,e),h.createIOGains?(g(this,lr,new GainNode(r,{gain:1})),g(this,Kt,new GainNode(r,{gain:1})),i(this,lr).connect(i(this,st)),i(this,st).connect(i(this,Kt))):(g(this,lr,e),g(this,Kt,e)),g(this,hs,!0)}onMessage(e,r){return i(this,ii).onMessage(e,r)}sendUpstreamMessage(e,r){return i(this,ii).sendMessage(e,r),this}connect(e){var r;const o="input"in e?e.input:e;i(this,Kt).connect(o),"nodeId"in e&&(i(this,cr).add(e.nodeId),(r=e.addIncoming)==null||r.call(e,this.nodeId))}disconnect(e){var r;if(e){const o="input"in e?e.input:e;i(this,Kt).disconnect(o),"nodeId"in e&&(i(this,cr).delete(e.nodeId),(r=e.removeIncoming)==null||r.call(e,this.nodeId))}else i(this,Kt).disconnect(),i(this,cr).clear()}addIncoming(e){i(this,si).add(e)}removeIncoming(e){i(this,si).delete(e)}get connections(){return{outgoing:Array.from(i(this,cr)),incoming:Array.from(i(this,si))}}setParam(e,r,o=this.now){if("parameters"in i(this,st)){const u=i(this,st).parameters.get(e);if(u){u.setValueAtTime(r,o);return}}const h=i(this,st)[e];if(h!=null&&h.setValueAtTime){h.setValueAtTime(r,o);return}console.warn(`Parameter '${e}' not found on node`)}getParam(e){return i(this,st)[e]||null}get audioNode(){return i(this,st)}get input(){return i(this,lr)}get output(){return i(this,Kt)}get context(){return i(this,st).context}get now(){return i(this,st).context.currentTime}get initialized(){return i(this,hs)}dispose(){this.disconnect(),Ct(this.nodeId)}}ii=new WeakMap,hs=new WeakMap,st=new WeakMap,lr=new WeakMap,Kt=new WeakMap,cr=new WeakMap,si=new WeakMap;const Ic={threshold:-13,knee:6,ratio:4,attack:.003,release:.05},Sc={threshold:-1,ratio:20,attack:.001,release:.01,knee:0};var Bo,ds,hr,oi,ge,dr;const Eu=class Vo{constructor(e=pn()){q(this,"nodeId"),q(this,"nodeType","dattorro-reverb"),M(this,Bo,!1),M(this,ds),M(this,hr,new Set),M(this,oi,new Set),M(this,ge),M(this,dr),this.nodeId=Ot(this.nodeType,this),g(this,ds,e),g(this,ge,new AudioWorkletNode(e,"dattorro-reverb-processor",{outputChannelCount:[2]})),this.setParam("dry",0),this.setPreset("default"),g(this,dr,"default"),this.setAmountMacro(0)}connect(e){var r;const o="input"in e?e.input:e;i(this,ge).connect(o),"nodeId"in e&&(i(this,hr).add(e.nodeId),(r=e.addIncoming)==null||r.call(e,this.nodeId))}disconnect(e){var r;if(e){const o="input"in e?e.input:e;i(this,ge).disconnect(o),"nodeId"in e&&(i(this,hr).delete(e.nodeId),(r=e.removeIncoming)==null||r.call(e,this.nodeId))}else i(this,ge).disconnect(),i(this,hr).clear()}addIncoming(e){i(this,oi).add(e.nodeId)}removeIncoming(e){i(this,oi).delete(e.nodeId)}setParam(e,r,o=this.now){var h;if(!isFinite(r)){console.warn(`Skipping non-finite value for ${e}:`,r);return}if(e==="amount"){this.setAmountMacro(r);return}if(e==="diffusion"){this.setDiffusionMacro(r);return}(h=i(this,ge).parameters.get(e))==null||h.setValueAtTime(r,o)}getParam(e){return e==="diffusion"?{value:this.getDiffusionMacroValue(),setValueAtTime:(r,o)=>this.setDiffusionMacro(r)}:i(this,ge).parameters.get(e)||null}setAmountMacro(e){var r;if(e<0||e>1){console.warn("Reverb amount must be 0-1 range");return}const o=Vo.PRESETS[i(this,dr)],h=an(e,0,1,o.decay,.98),u=an(e,0,1,o.excursionRate,2),f=an(e,0,1,o.excursionDepth,2),y=an(e,0,1,o.damping,.65),P=an(e,0,1,o.bandwidth,.2),S=an(e,0,1,0,.7);this.setDiffusionMacro(S),(r=this.getParam("decay"))==null||r.setTargetAtTime(h,this.now,.1),this.setParam("excursionRate",u),this.setParam("excursionDepth",f),this.setParam("damping",y),this.setParam("bandwidth",P)}setPreset(e="default",r=.5){g(this,dr,e);const o=Vo.PRESETS[e],h=i(this,ge).context.currentTime;Object.entries(o).forEach(([u,f])=>{const y=i(this,ge).parameters.get(u);y?y.linearRampToValueAtTime(f,h+r):console.warn(`Parameter '${u}' not found in reverb node`)})}setDiffusionMacro(e){const r=Math.max(.1,e*.75),o=Math.max(.1,e*.625),h=Math.min(.7,Math.max(.1,e*.6)),u=Math.max(.2,e*.4);this.setParam("inputDiffusion1",r),this.setParam("inputDiffusion2",o),this.setParam("decayDiffusion1",h),this.setParam("decayDiffusion2",u)}getDiffusionMacroValue(){var e;return((((e=this.getParam("inputDiffusion1"))==null?void 0:e.value)??.75)-.1)/(.75-.1)}getCurrentSettings(){const e={};return Array.from(i(this,ge).parameters.keys()).forEach(r=>{var o;e[r]=((o=i(this,ge).parameters.get(r))==null?void 0:o.value)??0}),e}get audioNode(){return i(this,ge)}get context(){return i(this,ds)}get input(){return i(this,ge)}get output(){return i(this,ge)}get now(){return i(this,ge).context.currentTime}get initialized(){return i(this,Bo)}get currentPreset(){return i(this,dr)}get connections(){return{outgoing:Array.from(i(this,hr)),incoming:Array.from(i(this,oi))}}get numberOfInputs(){return this.input.numberOfInputs}get numberOfOutputs(){return this.output.numberOfOutputs}get workletInfo(){return{numberOfInputs:i(this,ge).numberOfInputs,numberOfOutputs:i(this,ge).numberOfOutputs,channelCount:i(this,ge).channelCount,channelCountMode:i(this,ge).channelCountMode}}dispose(){this.disconnect(),Ct(this.nodeId)}};Bo=new WeakMap,ds=new WeakMap,hr=new WeakMap,oi=new WeakMap,ge=new WeakMap,dr=new WeakMap,q(Eu,"PRESETS",{room:{preDelay:1525,bandwidth:.5683,inputDiffusion1:.4666,inputDiffusion2:.5853,decay:.3226,decayDiffusion1:.6954,decayDiffusion2:.6022,damping:.6446,excursionRate:0,excursionDepth:0},church:{preDelay:0,bandwidth:.928,inputDiffusion1:.7331,inputDiffusion2:.4534,decay:.7,decayDiffusion1:.7839,decayDiffusion2:.1992,damping:.5975,excursionRate:0,excursionDepth:0},freeze:{preDelay:0,bandwidth:.999,inputDiffusion1:.75,inputDiffusion2:.625,decay:1,decayDiffusion1:.5,decayDiffusion2:.711,damping:.005,excursionRate:.3,excursionDepth:1.4},ether:{preDelay:0,bandwidth:.999,inputDiffusion1:.23,inputDiffusion2:.667,decay:.45,decayDiffusion1:.7,decayDiffusion2:.5,damping:.3,excursionRate:.85,excursionDepth:1.2},default:{preDelay:100,bandwidth:.9,inputDiffusion1:.4,inputDiffusion2:.55,decay:.2,decayDiffusion1:.65,decayDiffusion2:.6,damping:.2,excursionRate:.5,excursionDepth:.5}});let Dc=Eu;class _o extends AudioWorkletNode{constructor(e,r){super(e,r)}setParam(e,r){const o=this.parameters.get(e);return o?(o.setValueAtTime(r,this.context.currentTime),this):(console.warn(`Parameter '${String(e)}' not found on worklet node`),this)}getParam(e){return this.parameters.get(e)}sendProcessorMessage(e){return this.port.postMessage(e),this}onProcessorMessage(e){return this.port.onmessage=e,this}dispose(){this.disconnect(),this.port.onmessage=null,this.port.close()}}function Oc(c){return new _o(c,"feedback-delay-processor")}function Cc(c){return new _o(c,"distortion-processor")}var fs,ai,Ke,ui,$t,fr,li,ci,ps,pr,Ko,Wo,qo,ms;class Tu{constructor(e=pn()){q(this,"nodeId"),q(this,"nodeType","harmonic-feedback"),M(this,fs,!1),M(this,ai),M(this,Ke),M(this,ui),M(this,$t),M(this,fr,new Set),M(this,li,new Set),M(this,ci),M(this,ps,1),M(this,pr,!1),M(this,Ko,0),M(this,Wo,.999),M(this,qo,95556e-8),M(this,ms,.0004774632),q(this,"currAmount",0),this.nodeId=Ot(this.nodeType,this),g(this,ai,e),g(this,Ke,Oc(e)),g(this,ui,new GainNode(e,{gain:1})),g(this,$t,new GainNode(e,{gain:1})),i(this,ui).connect(i(this,Ke)).connect(i(this,$t));const r=this.setPitch(60);g(this,ci,r),this.setDecay(0),g(this,fs,!0)}trigger(e,r={}){const{secondsFromNow:o=0,cents:h=0,velocity:u=100,glideTime:f=0,triggerDecay:y=!0}=r,P=this.now+o;return this.setPitch(e,h,P,f),y&&this.triggerDecay(),this}setAmountMacro(e){const r=hn(e,0,1);return this.setFeedbackAmount(r),this.currAmount=r,this}setPitch(e,r=0,o=this.now,h=0){const u=440*Math.pow(2,(e-69)/12),f=1/(r!==0?u*Math.pow(2,r/1200):u),y=i(this,qo),P=Math.max(y,f);return this.setDelay(P,o,h),P}setDelay(e,r=this.now,o=0){g(this,ci,e);const h=e*i(this,ps),u=hn(h,i(this,ms),4);return o===0||!isFinite(o)?(this.getParam("delayTime").setValueAtTime(u,r),this):(this.getParam("delayTime").linearRampToValueAtTime(u,r+o),this)}setDelayMultiplier(e,r=this.now,o=.75){if(typeof e!="number"||!isFinite(e)){console.warn("setDelayMultiplier:Invalid multiplier:",e);return}const h=e,u=this.getParam("delayTime");g(this,ps,h);const f=hn(h*i(this,ci),i(this,ms),4);return o===0||!isFinite(o)?(u.setValueAtTime(f,r),this):(u.setTargetAtTime(f,r,o/3),this)}setFeedbackAmount(e,r=this.now){const o=ac(e,{inputRange:{min:0,max:1},outputRange:{min:Math.max(.001,i(this,Ko)),max:i(this,Wo)},curve:"power4"});return i(this,Ke).parameters.get("feedbackAmount").setValueAtTime(o,r),this}setAutoGain(e,r=.965){return i(this,Ke).port.postMessage({type:"setAutoGain",enabled:e,amount:r}),this}setDecay(e,r=this.now){const o=hn(e,0,1);return this.getParam("decay").setValueAtTime(o,r),this}triggerDecay(){i(this,pr)&&this.stopDecay(),g(this,pr,!0);const e=this.getParam("feedbackAmount").value;return i(this,Ke).port.postMessage({type:"triggerDecay",baseFeedbackAmount:e}),this}stopDecay(){return g(this,pr,!1),i(this,Ke).port.postMessage({type:"stopDecay"}),this}connect(e){var r;const o="input"in e?e.input:e;i(this,$t).connect(o),"nodeId"in e&&(i(this,fr).add(e.nodeId),(r=e.addIncoming)==null||r.call(e,this.nodeId))}disconnect(e){var r;if(e){const o="input"in e?e.input:e;i(this,$t).disconnect(o),"nodeId"in e&&(i(this,fr).delete(e.nodeId),(r=e.removeIncoming)==null||r.call(e,this.nodeId))}else i(this,$t).disconnect(),i(this,fr).clear()}addIncoming(e){i(this,li).add(e.nodeId)}removeIncoming(e){i(this,li).delete(e.nodeId)}setParam(e,r,o=this.now){var h;switch(e){case"feedback":this.setFeedbackAmount(r,o);break;case"delayTime":this.setDelay(r,o);break;case"amount":this.setAmountMacro(r);break;case"decay":this.setDecay(r,o);break;default:(h=i(this,Ke).parameters.get(e))==null||h.setValueAtTime(r,o);break}}getParam(e){switch(e){default:return i(this,Ke).parameters.get(e)||null}}get audioNode(){return i(this,Ke)}get context(){return i(this,ai)}get now(){return i(this,ai).currentTime}get input(){return i(this,ui)}get output(){return i(this,$t)}get connections(){return{outgoing:Array.from(i(this,fr)),incoming:Array.from(i(this,li))}}get initialized(){return i(this,fs)}get decayActive(){return i(this,pr)}get numberOfInputs(){return this.input.numberOfInputs}get numberOfOutputs(){return this.output.numberOfOutputs}get workletInfo(){return{numberOfInputs:i(this,Ke).numberOfInputs,numberOfOutputs:i(this,Ke).numberOfOutputs,channelCount:i(this,Ke).channelCount,channelCountMode:i(this,Ke).channelCountMode}}dispose(){this.disconnect(),Ct(this.nodeId)}}fs=new WeakMap,ai=new WeakMap,Ke=new WeakMap,ui=new WeakMap,$t=new WeakMap,fr=new WeakMap,li=new WeakMap,ci=new WeakMap,ps=new WeakMap,pr=new WeakMap,Ko=new WeakMap,Wo=new WeakMap,qo=new WeakMap,ms=new WeakMap;var gs,re,vs,en,je,On,Cn,Rn,Fn,mr,hi,kt,tn,at,ut,Qe,nn,ys,gr,di,jo,Iu,oe,Su,Le,Xe,rn;class Rc{constructor(e){M(this,oe),q(this,"nodeId"),q(this,"nodeType","InstrumentBus"),M(this,gs),M(this,re),M(this,vs,!1),M(this,en),M(this,je),M(this,On),M(this,Cn),M(this,Rn),M(this,Fn),M(this,mr),M(this,hi),M(this,kt),M(this,tn),M(this,at),M(this,ut,new Map),M(this,Qe,new Map),M(this,nn,new Map),M(this,ys,new Map),M(this,gr,new Set),M(this,di,new Set),M(this,jo,()=>new ot(new GainNode(i(this,re),{gain:0}),i(this,re),"gain")),M(this,Iu,()=>new ot(new GainNode(i(this,re),{gain:1}),i(this,re),"gain")),M(this,rn,null),this.nodeId=Ot(this.nodeType,this),g(this,re,e||pn()),g(this,gs,mn(this.nodeId)),g(this,en,new ot(new GainNode(i(this,re),{gain:.75}),i(this,re),"gain")),g(this,On,new ot(new BiquadFilterNode(i(this,re),{type:"lowpass",Q:.5}),i(this,re),"lpf")),g(this,Cn,new ot(new BiquadFilterNode(i(this,re),{type:"highpass",Q:.707}),i(this,re),"hpf")),g(this,Rn,new ot(new GainNode(i(this,re),{gain:1}),i(this,re),"gain")),g(this,Fn,new ot(new GainNode(i(this,re),{gain:1}),i(this,re),"gain")),g(this,je,new ot(new GainNode(i(this,re),{gain:1}),i(this,re),"gain")),g(this,mr,new ot(new DynamicsCompressorNode(i(this,re),Ic),i(this,re),"compressor")),g(this,hi,new ot(new DynamicsCompressorNode(i(this,re),Sc),i(this,re),"limiter")),g(this,kt,new ot(Cc(i(this,re)),i(this,re),"distortion")),g(this,tn,new Dc(i(this,re))),g(this,at,new Tu(i(this,re))),K(this,oe,Le).call(this,"input",i(this,en)),K(this,oe,Le).call(this,"lpf",i(this,On)),K(this,oe,Le).call(this,"hpf",i(this,Cn)),K(this,oe,Le).call(this,"dryMix",i(this,Rn)),K(this,oe,Le).call(this,"wetMix",i(this,Fn)),K(this,oe,Le).call(this,"output",i(this,je)),K(this,oe,Le).call(this,"compressor",i(this,mr)),K(this,oe,Le).call(this,"limiter",i(this,hi)),K(this,oe,Le).call(this,"feedback",i(this,at)),K(this,oe,Le).call(this,"distortion",i(this,kt)),K(this,oe,Le).call(this,"reverb",i(this,tn));const r=i(this,jo).call(this);i(this,nn).set("reverb",r),K(this,oe,Le).call(this,"reverb_send",r),K(this,oe,Su).call(this),g(this,vs,!0)}getInput(){return i(this,en)}getOutput(){return i(this,je)}getLpf(){return i(this,On)}getHpf(){return i(this,Cn)}getDryMix(){return i(this,Rn)}getWetMix(){return i(this,Fn)}getCompressor(){return i(this,mr)}getLimiter(){return i(this,hi)}getDistortion(){return i(this,kt)}getReverb(){return i(this,tn)}getFeedback(){return i(this,at)}getSend(e){return i(this,nn).get(e)}addNode(e,r){return K(this,oe,Le).call(this,e,r),this}disconnectFromTo(e,r){const o=i(this,ut).get(e);if(!o)return this;if(r){const h=i(this,ut).get(r);if(h){o.disconnect(h);const u=i(this,Qe).get(e)||[],f=u.indexOf(r);f>-1&&(u.splice(f,1),i(this,Qe).set(e,u))}}else o.disconnect(),i(this,Qe).set(e,[]);return this}removeNode(e){if(i(this,ut).get(e)){this.disconnectFromTo(e);for(const[r,o]of i(this,Qe)){const h=o.indexOf(e);h>-1&&(o.splice(h,1),i(this,Qe).set(r,o))}i(this,ut).delete(e),i(this,Qe).delete(e)}return this}setHpfCutoff(e){return i(this,Cn).audioNode.frequency.setValueAtTime(e,this.now),this}setLpfCutoff(e){return i(this,On).audioNode.frequency.setValueAtTime(e,this.now),this}setCompressorParams(e){const r=i(this,mr).audioNode;return e.threshold!==void 0&&r.threshold.setValueAtTime(e.threshold,this.now),e.knee!==void 0&&r.knee.setValueAtTime(e.knee,this.now),e.ratio!==void 0&&r.ratio.setValueAtTime(e.ratio,this.now),e.attack!==void 0&&r.attack.setValueAtTime(e.attack,this.now),e.release!==void 0&&r.release.setValueAtTime(e.release,this.now),this}setSend(e,r){const o=i(this,nn).get(e);if(!o)return console.warn(`Send effect ${e} not found`),this;const h=Math.max(0,Math.min(1,r));return o.setParam("gain",h),this}setReturn(e,r){const o=i(this,ys).get(e);if(!o)return console.warn(`Return for effect ${e} not found`),this;const h=Math.max(0,Math.min(2,r));return o.setParam("gain",h),this}noteOn(e,r=100,o=0,h=0){return i(this,at).trigger&&i(this,at).trigger(e,{velocity:r,secondsFromNow:o,glideTime:h}),this}setDryWetMix(e){if(e.dry!==void 0){const r=Math.max(0,Math.min(1,e.dry));i(this,Rn).setParam("gain",r)}if(e.wet!==void 0){const r=Math.max(0,Math.min(1,e.wet));i(this,Fn).setParam("gain",r)}return this}setReverbAmount(e){return this.setSend("reverb",e),i(this,tn).setAmountMacro&&i(this,tn).setAmountMacro(e),this}setReverbDecay(e){return i(this,tn).setParam("decay",e),this}setDrive(e){return i(this,kt).setParam("distortionDrive",e),this}setClippingMacro(e){const r=hn(e,0,1);i(this,kt).setParam("clippingAmount",r);const o=an(r,0,1,.5,.1);return i(this,kt).setParam("clippingThreshold",o),this}setClippingMode(e){i(this,kt)instanceof _o&&i(this,kt).sendProcessorMessage({type:"setLimitingMode",mode:e})}setFeedbackAmount(e){return i(this,at).setAmountMacro&&i(this,at).setAmountMacro(e),this}setFeedbackPitchScale(e){return i(this,at).setDelayMultiplier&&i(this,at).setDelayMultiplier(e),this}setFeedbackDecay(e){return i(this,at).setDecay(e),this}connect(e){var r;i(this,je).connect(e),"nodeId"in e&&(i(this,gr).add(e.nodeId),(r=e.addIncoming)==null||r.call(e,this.nodeId))}disconnect(e){var r;i(this,je).disconnect(e),e&&"nodeId"in e?(i(this,gr).delete(e.nodeId),(r=e.removeIncoming)==null||r.call(e,this.nodeId)):e||i(this,gr).clear()}addIncoming(e){i(this,di).add(e)}removeIncoming(e){i(this,di).delete(e)}setParam(e,r){switch(e){case"outputLevel":this.outputLevel=r;break;case"reverbAmount":this.setReverbAmount(r);break;case"feedbackAmount":this.setFeedbackAmount(r);break;case"feedbackDecay":this.setFeedbackDecay(r);break;case"drive":this.setDrive(r);break;case"hpfCutoff":this.setHpfCutoff(r);break;case"lpfCutoff":this.setLpfCutoff(r);break;default:console.warn(`Parameter '${e}' not recognized on InstrumentMasterBus`);break}}getParam(e){switch(e){case"outputLevel":return i(this,je).getParam("gain");case"hpfCutoff":return i(this,Cn).getParam("frequency");case"lpfCutoff":return i(this,On).getParam("frequency");default:return null}}dispose(){for(const[e]of i(this,ut))this.disconnectFromTo(e);i(this,ut).clear(),i(this,Qe).clear(),i(this,nn).clear(),Ct(this.nodeId)}get audioNode(){return i(this,je).audioNode}get context(){return i(this,re)}get connections(){return{outgoing:Array.from(i(this,gr)),incoming:Array.from(i(this,di))}}get input(){return i(this,en).audioNode}get output(){return i(this,je).audioNode}get now(){return i(this,re).currentTime}set outputLevel(e){const r=Math.max(0,Math.min(1,e));i(this,je).setParam("gain",r)}get outputLevel(){const e=i(this,je).getParam("gain");return(e==null?void 0:e.value)||0}get initialized(){return i(this,vs)}get dryWetMix(){var e,r;return{dry:((e=i(this,Rn).getParam("gain"))==null?void 0:e.value)||0,wet:((r=i(this,Fn).getParam("gain"))==null?void 0:r.value)||0}}getSendAmount(e){var r;const o=i(this,nn).get(e);return((r=o==null?void 0:o.getParam("gain"))==null?void 0:r.value)??0}getReturnGain(e){var r;const o=i(this,ys).get(e);return((r=o==null?void 0:o.getParam("gain"))==null?void 0:r.value)??1}getRoutingMap(){const e={};for(const[r,o]of i(this,Qe))e[r]=[...o];return e}debugRouting(){console.debug("=== Bus Routing Map ===");for(const[e,r]of i(this,Qe))r.length>0&&console.debug(`${e} -> ${r.join(", ")}`);console.debug("======================")}debugSendReturn(){console.debug("=== Send/Return Configuration ===");for(const[e]of i(this,nn)){const r=this.getSendAmount(e),o=this.getReturnGain(e);console.debug(`${e}: Send=${r.toFixed(2)}, Return=${o.toFixed(2)}`)}console.debug("=================================")}listNodes(){return Array.from(i(this,ut).keys())}startLevelMonitoring(e=1e3,r=1024,o=!1){this.stopLevelMonitoring(),g(this,rn,new Ka(i(this,re),i(this,en).audioNode,i(this,je).audioNode,r)),i(this,rn).start(e,void 0,o),console.log("Level monitoring started")}stopLevelMonitoring(){i(this,rn)&&(i(this,rn).stop(),g(this,rn,null),console.log("Level monitoring stopped"))}logLevels(){let e=i(this,rn);e===null&&(e=new Ka(i(this,re),i(this,en).audioNode,i(this,je).audioNode));const r=e.getLevels();console.log(`Levels: Input RMS ${r.input.rmsDB.toFixed(1)} dB | Output RMS ${r.output.rmsDB.toFixed(1)} dB`)}onMessage(e,r){return i(this,gs).onMessage(e,r)}}gs=new WeakMap,re=new WeakMap,vs=new WeakMap,en=new WeakMap,je=new WeakMap,On=new WeakMap,Cn=new WeakMap,Rn=new WeakMap,Fn=new WeakMap,mr=new WeakMap,hi=new WeakMap,kt=new WeakMap,tn=new WeakMap,at=new WeakMap,ut=new WeakMap,Qe=new WeakMap,nn=new WeakMap,ys=new WeakMap,gr=new WeakMap,di=new WeakMap,jo=new WeakMap,Iu=new WeakMap,oe=new WeakSet,Su=function(){K(this,oe,Xe).call(this,"input","feedback"),K(this,oe,Xe).call(this,"feedback","distortion"),K(this,oe,Xe).call(this,"distortion","compressor"),K(this,oe,Xe).call(this,"compressor","hpf"),K(this,oe,Xe).call(this,"hpf","lpf"),K(this,oe,Xe).call(this,"lpf","dryMix"),K(this,oe,Xe).call(this,"lpf","reverb_send"),K(this,oe,Xe).call(this,"reverb_send","reverb"),K(this,oe,Xe).call(this,"reverb","wetMix"),K(this,oe,Xe).call(this,"dryMix","limiter"),K(this,oe,Xe).call(this,"wetMix","limiter"),K(this,oe,Xe).call(this,"limiter","output")},Le=function(c,e){i(this,ut).set(c,e),i(this,Qe).set(c,[])},Xe=function(c,e){const r=i(this,ut).get(c),o=i(this,ut).get(e);if(!r||!o)return console.warn(`Cannot connect ${c} -> ${e}: node not found`),this;r.connect(o);const h=i(this,Qe).get(c)||[];return h.includes(e)||(h.push(e),i(this,Qe).set(c,h)),this},rn=new WeakMap;const be={NOT_READY:"NOT_READY",LOADED:"LOADED",PLAYING:"PLAYING",RELEASING:"RELEASING",STOPPING:"STOPPING",STOPPED:"STOPPED"};var xr,vr,cn,We,xe,Mt,se,ve,Os,Te,ws,ki,bs,jn,xt,Wt,As,Lo,Ps,Qo,Tt,Za,Du,sn,ks,Ou,Ha,Cu;class Fc{constructor(e=pn(),r,o={}){M(this,Tt),q(this,"nodeId"),q(this,"nodeType","sample-voice"),M(this,xr),M(this,vr,null),M(this,cn),M(this,We),M(this,xe,null),M(this,Mt,null),M(this,se,new Map),M(this,ve,be.NOT_READY),M(this,Os,!1),M(this,Te,null),M(this,ws,-1),M(this,ki,0),M(this,bs,0),M(this,jn),M(this,xt,null),M(this,Wt,null),M(this,As,40),M(this,Lo,.707),M(this,Ps,18e3),M(this,Qo,.707),q(this,"logAvailableParams",()=>{console.table("Available worklet params:",Array.from(i(this,We).parameters.keys()))}),M(this,sn,null),q(this,"enableEnvelope",h=>{var u;(u=i(this,se).get(h))==null||u.enable()}),q(this,"disableEnvelope",h=>{var u;if((u=i(this,se).get(h))==null||u.disable(),h==="filter-env"&&i(this,jn)){const f=this.getParam("lpf");f==null||f.cancelScheduledValues(this.now),f==null||f.exponentialRampToValueAtTime(xu(this.context.sampleRate),this.now+.1)}}),q(this,"setEnvelopeTimeScale",(h,u)=>{var f;(f=i(this,se).get(h))==null||f.setTimeScale(u)}),q(this,"setEnvelopeSustainPoint",(h,u)=>{const f=i(this,se).get(h);f!=null&&f.isEnabled&&f.setSustainPoint(u)}),q(this,"setEnvelopeReleasePoint",(h,u)=>{const f=i(this,se).get(h);f!=null&&f.isEnabled&&f.setReleasePoint(u)}),q(this,"getEnvelope",h=>i(this,se).get(h)),q(this,"setStartPoint",(h,u=this.now)=>{this.setParam("startPoint",h,u)}),q(this,"setEndPoint",(h,u=this.now)=>{this.setParam("endPoint",h,u)}),q(this,"setEnvelopeLoop",(h,u,f="normal")=>{const y=i(this,se).get(h);return y==null||y.setLoopEnabled(u,f),this}),q(this,"syncEnvelopeToPlaybackRate",(h,u)=>{const f=i(this,se).get(h);return f==null||f.syncToPlaybackRate(u),this}),q(this,"setPanDriftEnabled",h=>this.sendToProcessor({type:"setPanDriftEnabled",value:h})),this.context=e,this.nodeId=Ot(this.nodeType,this),g(this,xr,mn(this.nodeId)),g(this,We,new AudioWorkletNode(e,"sample-player-processor",{numberOfInputs:0,numberOfOutputs:1,outputChannelCount:[2],processorOptions:o.processorOptions||{}})),g(this,Mt,new Tu(this.context)),i(this,Mt).input.gain.setValueAtTime(1.5,this.now),g(this,cn,new GainNode(e,{gain:1})),g(this,vr,r),g(this,jn,o.enableFilters??!0),i(this,jn)?(g(this,As,50),g(this,Ps,this.context.sampleRate/2-1e3),i(this,xt)||g(this,xt,new BiquadFilterNode(e,{type:"highpass",frequency:i(this,As),Q:i(this,Lo)})),i(this,Wt)||g(this,Wt,new BiquadFilterNode(e,{type:"lowpass",frequency:i(this,Ps),Q:i(this,Qo)})),i(this,We).connect(i(this,Mt).input),i(this,We).connect(i(this,xt)),i(this,Mt).output.connect(i(this,xt)),i(this,xt).connect(i(this,Wt)),i(this,Wt).connect(i(this,cn))):(i(this,We).connect(i(this,Mt).input),i(this,Mt).output.connect(i(this,cn))),i(this,cn).connect(r),K(this,Tt,ks).call(this),K(this,Tt,Cu).call(this),this.sendToProcessor({type:"voice:init"}),i(this,We).port.start()}async loadBuffer(e,r){if(g(this,ve,be.NOT_READY),e.sampleRate!==this.context.sampleRate)return console.warn(`Sample rate mismatch - buffer: ${e.sampleRate}, context: ${this.context.sampleRate}`),!1;const o=Array.from({length:e.numberOfChannels},(h,u)=>e.getChannelData(u).slice());return this.sendToProcessor({type:"voice:setBuffer",buffer:o,durationSeconds:e.duration}),r!=null&&r.length&&(K(this,Tt,Du).call(this,r),this.sendToProcessor({type:"voice:setZeroCrossings",zeroCrossings:r})),!0}set transposeSemitones(e){this.sendToProcessor({type:"transpose",semitones:e})}setGlideTime(e){g(this,bs,e)}trigger(e){var r,o,h,u;const{midiNote:f=60,velocity:y=100,secondsFromNow:P=0}={...e},S=this.now+P;if(i(this,ve)===be.PLAYING||i(this,ve)===be.RELEASING)return console.log(`had to stop a playing voice, midinote: ${f}`),this.stop(S),null;g(this,ve,be.PLAYING),g(this,ws,S),g(this,Te,f);const F=(((r=e.glide)==null?void 0:r.glideTime)??i(this,bs))/8,N=Wa(f);if(e.glide&&F>0){const U=this.getParam("playbackRate"),te=Wa(e.glide.prevMidiNote);te>0&&U.setValueAtTime(te,S),this.getParam("playbackRate").setTargetAtTime(N,S,F)}else this.setParam("playbackRate",N,S);return this.setParam("velocity",y,S),this.sendToProcessor({type:"voice:start",timestamp:S}),this.applyEnvelopes(S,N,f),(o=i(this,Mt))==null||o.trigger(f,{velocity:y,secondsFromNow:P,glideTime:F,triggerDecay:!0}),(u=i(this,xe))==null||u.setMusicalNote(f,{divisor:1,glideTime:F,glideFromMidiNote:(h=e==null?void 0:e.glide)==null?void 0:h.prevMidiNote,timestamp:S}),i(this,Te)}applyEnvelopes(e,r,o,h){i(this,se).forEach((P,S)=>{if(!P.isEnabled)return;const F=this.getParam(P.param);if(!F||S==="pitch-env"&&!P.hasVariation())return;const N=(()=>{switch(S){case"amp-env":return o?o/127:1;case"pitch-env":return r;case"filter-env":return 1;default:return 1}})();P.triggerEnvelope(F,e,{baseValue:N,playbackRate:r,voiceId:this.nodeId,midiNote:h??60})});const u=i(this,se).get("amp-env"),f=i(this,se).get("pitch-env"),y=i(this,se).get("filter-env");this.sendUpstreamMessage("sample-envelopes:trigger",{voiceId:this.nodeId,midiNote:i(this,Te),envDurations:{"amp-env":u.syncedToPlaybackRate?u.fullDuration/r/u.timeScale:u.fullDuration/u.timeScale,"pitch-env":f.syncedToPlaybackRate?f.fullDuration/r/f.timeScale:f.fullDuration/f.timeScale,"filter-env":y.syncedToPlaybackRate?y.fullDuration/r/y.timeScale:y.fullDuration/y.timeScale},loopEnabled:{"amp-env":u.loopEnabled,"pitch-env":f.loopEnabled,"filter-env":y.loopEnabled}})}release({releaseTime:e=this.releaseTime,secondsFromNow:r=0}){var o;if(i(this,ve)===be.RELEASING)return this;if(!this.getParam("envGain"))throw new Error("Cannot release - envGain parameter is null");g(this,ve,be.RELEASING);const h=this.now+r,u=((o=this.getParam("playbackRate"))==null?void 0:o.value)??1;if(i(this,se).forEach(P=>{if(!P.isEnabled)return;const S=this.getParam(P.param);S&&P.releaseEnvelope(S,h,{playbackRate:u,voiceId:this.nodeId,midiNote:i(this,Te)??60})}),e<=0)return this.stop(h);this.sendToProcessor({type:"voice:release",timestamp:h});const f=Array.from(i(this,se).values()).filter(P=>P.isEnabled),y=f.length>0?Math.max(...f.map(P=>P.releaseTime)):e;return i(this,sn)&&clearTimeout(i(this,sn)),g(this,sn,setTimeout(()=>{try{i(this,ve)===be.RELEASING&&this.stop()}finally{g(this,sn,null)}},y*1e3+50)),this}stop(e=this.now){return i(this,ve)===be.STOPPED||i(this,ve)===be.STOPPING?this:(g(this,ve,be.STOPPING),this.setParam("envGain",0,e,{cancelPrevious:!0,glideTime:0}),this.sendToProcessor({type:"voice:stop",timestamp:e}),g(this,ve,be.STOPPED),this)}setModulationAmount(e,r){var o;const h=hn(r,0,1,{warn:!0,name:"sampleVoice.setModulationAmount"});return e==="AM"?(i(this,xe)||K(this,Tt,ks).call(this,h),(o=i(this,xe))==null||o.setDepth(h)):e==="FM"&&console.info("SampleVoice: FM modulation not implemented yet"),this}setModulationWaveform(e="AM",r="triangle",o={}){var h;return e==="AM"?(i(this,xe)||K(this,Tt,ks).call(this),(h=i(this,xe))==null||h.setWaveform(r,o)):e==="FM"&&console.info("SampleVoice: FM modulation not implemented yet"),this}addEnvelopePoint(e,r,o){const h=i(this,se).get(e);h!=null&&h.isEnabled&&h.addPoint(r,o)}updateEnvelopePoint(e,r,o,h){const u=i(this,se).get(e);u!=null&&u.isEnabled&&u.updatePoint(r,o,h)}deleteEnvelopePoint(e,r){const o=i(this,se).get(e);o!=null&&o.isEnabled&&o.deletePoint(r)}get envelopes(){return i(this,se)}setParam(e,r,o,h={}){const u=this.getParam(e);if(!u||u.value===r)return this;const{glideTime:f=0,cancelPrevious:y=!0}=h;return y&&u.cancelScheduledValues(o),f<=0?u.setValueAtTime(r,Math.max(o,this.now+.001)):u.linearRampToValueAtTime(r,o+Math.max(f,.001)),this}setParams(e,r,o={}){const h=e.filter(u=>this.getParam(u.name)!==null);return h.length===0?this:(h.forEach(({name:u,value:f})=>{this.setParam(u,f,r,{...o})}),this)}setLoopPoints(e,r,o=this.now,h=0){return e>=r?this:(e!==void 0&&this.setParam("loopStart",e,o,{glideTime:h,cancelPrevious:!0}),r!==void 0&&this.setParam("loopEnd",r,o,{glideTime:h,cancelPrevious:!0}),this)}setAllowedPeriods(e){return this.sendToProcessor({type:"setAllowedPeriods",allowedPeriods:e}),this}connect(e,r,o){return e===i(this,vr)?i(this,vr):(e instanceof ot?this.out.connect(e.input,r):e instanceof AudioParam?this.out.connect(e,r):e instanceof AudioNode?this.out.connect(e,r,o):console.warn(`SampleVoice: Unsupported destination: ${e}`),e)}disconnect(e="main",r){return e==="alt"?(console.warn('SampleVoice has no "alt" output to disconnect'),this):(r?r instanceof AudioNode?this.out.disconnect(r):r instanceof AudioParam&&this.out.disconnect(r):this.out.disconnect(),this)}onMessage(e,r){return i(this,xr).onMessage(e,r)}sendToProcessor(e){return i(this,We).port.postMessage(e),this}sendUpstreamMessage(e,r){return i(this,xr).sendMessage(e,r),this}getPlaybackDuration(){const e=this.getParam("startPoint").value;return this.getParam("endPoint").value-e}get feedback(){return i(this,Mt)}get currMidiNote(){return i(this,Te)}get hpf(){return i(this,xt)}get lpf(){return i(this,Wt)}get in(){return null}get out(){return i(this,cn)}get destination(){return i(this,vr)}get state(){return i(this,ve)}get initialized(){return i(this,Os)}get now(){return this.context.currentTime}get activeNoteId(){return i(this,Te)}get triggerTimestamp(){return i(this,ws)}get sampleDurationSeconds(){return i(this,ki)}get startPoint(){return this.getParam("startPoint").value}get endPoint(){return this.getParam("endPoint").value}get releaseTime(){return i(this,se).get("amp-env").releaseTime}setMasterGain(e){const r=i(this,We).parameters.get("masterGain");r.cancelScheduledValues(this.context.currentTime),r.setTargetAtTime(e,this.context.currentTime,.006)}enablePositionTracking(e){return this.sendToProcessor({type:"voice:usePlaybackPosition",value:e}),this}setLoopEnabled(e){return this.sendToProcessor({type:"setLoopEnabled",value:e}),!e&&i(this,Te)&&this.release({}),this}setPlaybackRate(e,r=this.now,o){return this.setParam("playbackRate",e,r,o),this}setPlaybackDirection(e){return this.sendToProcessor({type:"voice:setPlaybackDirection",playbackDirection:e}),this}setLoopDurationDriftAmount(e){if(e===0)return this.setParam("loopDurationDriftAmount",0,this.now),this;const r=uc(e,{inputRange:{min:0,max:1},outputRange:{min:1e-4,max:1},blend:1,curve:"linear"});return this.setParam("loopDurationDriftAmount",r,this.now),this}debugDuration(){console.info(`
      sample duration: ${this.sampleDurationSeconds}, 
      startPoint: ${this.getParam("startPoint").value}, 
      endPoint: ${this.getParam("endPoint").value}, 
      playback duration: ${this.getPlaybackDuration()}
      `)}dispose(){this.stop(),this.disconnect(),K(this,Tt,Ou).call(this),i(this,se).forEach(e=>e.dispose()),i(this,We).port.close(),i(this,sn)&&clearTimeout(i(this,sn)),Ct(this.nodeId)}getParam(e){var r,o,h,u;if(i(this,We)&&i(this,We).parameters.has(e))return i(this,We).parameters.get(e)??null;if(i(this,jn))switch(e){case"highpass":case"hpf":return((r=i(this,xt))==null?void 0:r.frequency)||null;case"lowpass":case"lpf":return((o=i(this,Wt))==null?void 0:o.frequency)||null;case"hpfQ":return((h=i(this,xt))==null?void 0:h.Q)||null;case"lpfQ":return((u=i(this,Wt))==null?void 0:u.Q)||null}return null}}xr=new WeakMap,vr=new WeakMap,cn=new WeakMap,We=new WeakMap,xe=new WeakMap,Mt=new WeakMap,se=new WeakMap,ve=new WeakMap,Os=new WeakMap,Te=new WeakMap,ws=new WeakMap,ki=new WeakMap,bs=new WeakMap,jn=new WeakMap,xt=new WeakMap,Wt=new WeakMap,As=new WeakMap,Lo=new WeakMap,Ps=new WeakMap,Qo=new WeakMap,Tt=new WeakSet,Za=function(){i(this,se).forEach(o=>o.dispose()),i(this,se).clear();const c=i(this,ki)||void 0,e=To(this.context,"amp-env",{durationSeconds:c});i(this,se).set("amp-env",e);const r=To(this.context,"pitch-env",{durationSeconds:c});if(i(this,se).set("pitch-env",r),i(this,jn)){const o=this.context.sampleRate/2-1e3,h=To(this.context,"filter-env",{durationSeconds:c,paramValueRange:[20,o],initEnable:!1});i(this,se).set("filter-env",h)}K(this,Tt,Ha).call(this)},Du=function(c){return this.sendToProcessor({type:"voice:set_zero_crossings",zeroCrossings:c}),this},sn=new WeakMap,ks=function(c=0,e="square",r={}){return i(this,xe)===null?(g(this,xe,new No(this.context)),i(this,xe).setWaveform(e,r),i(this,xe).setDepth(c),i(this,xe).setMusicalNote(i(this,Te)??60),i(this,xe).connect(i(this,cn).gain)):console.debug("setupAmpModLFO: LFO already setup: ",i(this,xe)),this},Ou=function(){if(i(this,xe))return i(this,xe).dispose(),g(this,xe,null),this},Ha=function(){i(this,se).forEach((c,e)=>{i(this,xr).forwardFrom(c,[`${e}:trigger`,`${e}:release`,`${e}:trigger:loop`],r=>({...r,voiceId:this.nodeId,midiNote:i(this,Te)}))})},Cu=function(){i(this,We).port.onmessage=c=>{var e;let{type:r,...o}=c.data;switch(r){case"initialized":g(this,Os,!0),g(this,ve,be.NOT_READY),this.sendUpstreamMessage("voice:initialized",{voice:this,voiceId:this.nodeId});break;case"voice:loaded":g(this,Te,null),g(this,ve,be.LOADED),o.durationSeconds&&(g(this,Te,null),g(this,ki,o.durationSeconds),K(this,Tt,Za).call(this),this.setStartPoint(0),this.setEndPoint(o.durationSeconds),this.setParam("loopEnd",0,this.now));break;case"voice:transposed":break;case"voice:started":g(this,ve,be.PLAYING),o={voice:this,midiNote:i(this,Te)};break;case"voice:stopped":g(this,ve,be.STOPPED),o={voiceId:this.nodeId,voice:this,midiNote:i(this,Te)},g(this,Te,null);break;case"voice:releasing":g(this,ve,be.RELEASING),o={voiceId:this.nodeId,voice:this,midiNote:i(this,Te)};break;case"loop:enabled":break;case"voice:looped":break;case"voice:playbackDirectionChange":break;case"voice:position":(e=this.getParam("playbackPosition"))==null||e.setValueAtTime(o.position,this.context.currentTime);break;case"debug:params":console.debug("Debug params: ",{loopStart:o.loopStart},{loopStartSamples:o.loopStartSamples},{loopEnd:o.loopEnd},{loopEndSamples:o.loopEndSamples});break;case"debug:loop":console.log("Loop debug:",o);break;default:console.warn(`Unhandled message type: ${r}`);break}this.sendUpstreamMessage(r,o)}};var Er,fi,tt,Dr,Ue,nt,ht,vt,pi,Ms,Tr,Ru,Uo,Xa,Io;class Nc{constructor(e,r,o,h=!0){M(this,Tr),q(this,"nodeId"),q(this,"nodeType","pool"),M(this,Er),M(this,fi,1),M(this,tt),M(this,Dr,new Set),M(this,Ue,new Map),M(this,nt,new Set),M(this,ht,new Set),M(this,vt,new Set),M(this,pi,!1),M(this,Ms,new Set),q(this,"prevMidiNote",60),M(this,Uo,.4),this.nodeId=Ot(this.nodeType,this),g(this,Er,mn(this.nodeId)),g(this,tt,Array.from({length:r},()=>{const u=new Fc(e,o,{enableFilters:h});return u.connect(o),u})),i(this,tt).forEach(u=>{i(this,nt).add(u),K(this,Tr,Ru).call(this,u)}),g(this,pi,!0)}onMessage(e,r){return i(this,Er).onMessage(e,r)}sendUpstreamMessage(e,r){return i(this,Er).sendMessage(e,r),this}setBuffer(e,r){return i(this,Dr).clear(),i(this,tt).forEach(o=>o.loadBuffer(e,r)),this}allocate(e=i(this,nt),r=i(this,vt),o=i(this,ht)){let h;if(e.size?h=Mo(e):r.size?(h=Mo(r),h==null||h.stop()):o.size&&(h=Mo(o),h==null||h.stop()),!h)throw new Error("Could not allocate voice");return h}noteOn(e,r=100,o=0,h=0,u){const f=this.allocate();return f.trigger({midiNote:e,velocity:r,secondsFromNow:o,currentLoopEnd:u,glide:{prevMidiNote:this.prevMidiNote,glideTime:h}})?(i(this,Ue).set(e,f),this.prevMidiNote=e,e):null}noteOff(e,r=0,o){const h=i(this,Ue).get(e);if(h)return(h==null?void 0:h.state)===be.PLAYING&&h.release({secondsFromNow:r,releaseTime:o}),this}allNotesOff(e=0){return i(this,Ue).forEach(r=>{r.release({releaseTime:e})}),i(this,Ue).clear(),this}applyToAllVoices(e){i(this,tt).forEach(r=>e(r))}applyToActiveVoices(e){i(this,Ue).forEach(r=>e(r))}applyToInactiveVoices(e){i(this,nt).forEach(r=>e(r))}applyToActiveNote(e,r){const o=i(this,Ue).get(e);o?r(o):console.warn(`No active voice found for midiNote: ${e}`)}debug(){console.debug(`
      releasing: ${i(this,vt).size}
      playing: ${i(this,ht).size}
      available: ${i(this,nt).size}
      Sum: ${i(this,vt).size+i(this,ht).size+i(this,nt).size}
      Sum should be: ${this.allVoicesCount}
      `,{midiToVoiceMap:i(this,Ue)})}dispose(){this.applyToAllVoices(e=>e.dispose()),g(this,tt,[]),i(this,Ue).clear(),i(this,nt).clear(),i(this,vt).clear(),i(this,ht).clear(),i(this,Dr).clear(),g(this,pi,!1),Ct(this.nodeId)}get initialized(){return i(this,pi)}get availableVoices(){return i(this,nt)}get playingVoicesCount(){return i(this,ht).size}get releasingVoicesCount(){return i(this,vt).size}get availableVoicesCount(){return i(this,nt).size}get allVoices(){return i(this,tt)}get allVoicesCount(){return i(this,tt).length}get assignedVoicesMidiMap(){return i(this,Ue)}set transposeSemitones(e){i(this,tt).forEach(r=>r.transposeSemitones=e)}}Er=new WeakMap,fi=new WeakMap,tt=new WeakMap,Dr=new WeakMap,Ue=new WeakMap,nt=new WeakMap,ht=new WeakMap,vt=new WeakMap,pi=new WeakMap,Ms=new WeakMap,Tr=new WeakSet,Ru=function(c){c.onMessage("voice:started",e=>{i(this,nt).delete(e.voice),i(this,vt).delete(e.voice),i(this,ht).add(e.voice),K(this,Tr,Io).call(this),i(this,Ue).set(e.midiNote,e.voice)}),c.onMessage("voice:releasing",e=>{i(this,nt).delete(e.voice),i(this,ht).delete(e.voice),i(this,vt).add(e.voice),i(this,Ue).get(e.midiNote)===e.voice&&i(this,Ue).delete(e.midiNote)}),c.onMessage("voice:stopped",e=>{i(this,ht).delete(e.voice),i(this,vt).delete(e.voice),K(this,Tr,Io).call(this),i(this,nt).add(e.voice)}),c.onMessage("voice:initialized",e=>{i(this,Ms).add(e.voice),i(this,Ms).size===i(this,tt).length&&this.sendUpstreamMessage("voice-pool:initialized",{voiceCount:i(this,tt).length})}),i(this,Er).forwardFrom(c,["voice:initialized","voice:started","voice:stopped","voice:releasing","voice:loaded","voice:transposed","amp-env:trigger","amp-env:trigger:loop","amp-env:release","pitch-env:trigger","pitch-env:trigger:loop","pitch-env:release","filter-env:trigger","filter-env:trigger:loop","filter-env:release"],e=>e.type==="voice:loaded"?(i(this,Dr).add(e.senderId),i(this,Dr).size===i(this,tt).length?{...e,type:"sample:loaded"}:null):e)},Uo=new WeakMap,Xa=function(){const c=i(this,ht).size+i(this,vt).size;if(c===0){g(this,fi,1);return}g(this,fi,1/(1+Math.log10(c)*i(this,Uo))),[...i(this,ht)].forEach(e=>{e.setMasterGain(i(this,fi))})},Io=function(){K(this,Tr,Xa).call(this)};function Bc(c,e){localStorage.setItem(c,e.toString())}function Vc(c,e){const r=localStorage.getItem(c);return r===null?e:typeof e=="number"?Number(r):r}var Ir,_e,yr,mi,gi,It,wr,vi,yi,br,$e,Fe,Me,mt,lt,xs,Es,zo,wi,Sr,Nn,Ts,Go,Ln,Fu,Nu,Bu,Vu,Ja,Bn;class Kc{constructor(e,r=16,o,h){M(this,Ln),q(this,"nodeId"),q(this,"nodeType","sample-player"),q(this,"context"),M(this,Ir),M(this,_e,null),M(this,yr,new Set),M(this,mi,new Set),M(this,gi,null),M(this,It,0),M(this,wr,!1),M(this,vi,!1),M(this,yi,!1),M(this,br,!1),M(this,$e),M(this,Fe),M(this,Me),M(this,mt,null),M(this,lt,null),M(this,xs,!1),M(this,Es,!1),M(this,zo,new Map),M(this,wi,!1),M(this,Sr,!1),M(this,Nn,[]),M(this,Ts,!0),M(this,Go,!0),q(this,"randomizeVelocity",!1),q(this,"voicePool"),q(this,"outBus"),q(this,"setModulationAmount",(u,f)=>this.voicePool.applyToAllVoices(y=>y.setModulationAmount(u,f))),q(this,"setTransposition",u=>{this.voicePool.transposeSemitones=u,console.info(`transposing by ${u} semitones`),this.sendUpstreamMessage("sample:auto-transpose:success",{transposedBy:u})}),q(this,"panic",u=>this.releaseAll(u)),q(this,"setPanDriftEnabled",u=>this.voicePool.applyToAllVoices(f=>f.setPanDriftEnabled(u))),q(this,"isNormalized",(u,f=[0,1])=>u>=f[0]&&u<=f[1]),q(this,"MIN_LOOP_DURATION_SECONDS",1/1046.502),q(this,"setLoopStart",(u,f=this.getLoopRampDuration())=>this.setLoopPoint("start",u,this.loopEnd,f)),q(this,"setLoopEnd",(u,f=this.getLoopRampDuration())=>this.setLoopPoint("end",this.loopStart,u,f)),q(this,"setLoopDuration",(u,f=this.getLoopRampDuration())=>this.setLoopPoint("end",this.loopStart,this.loopStart+u,f)),q(this,"getHpfCutoff",()=>this.getStoredParamValue("hpfCutoff",NaN)),q(this,"getLpfCutoff",()=>this.getStoredParamValue("lpfCutoff",NaN)),q(this,"enableEnvelope",u=>{this.voicePool.applyToAllVoices(f=>f.enableEnvelope(u))}),q(this,"disableEnvelope",u=>{this.voicePool.applyToAllVoices(f=>f.disableEnvelope(u))}),q(this,"setEnvelopeLoop",(u,f,y="normal")=>{this.voicePool.applyToAllVoices(P=>P.setEnvelopeLoop(u,f,y))}),q(this,"setEnvelopeSync",(u,f)=>{this.voicePool.applyToAllVoices(y=>y.syncEnvelopeToPlaybackRate(u,f))}),q(this,"setEnvelopeTimeScale",(u,f)=>{this.voicePool.applyToAllVoices(y=>y.setEnvelopeTimeScale(u,f))}),q(this,"setDryWetMix",u=>{this.outBus.setDryWetMix(u)}),q(this,"send",(u,f)=>{this.outBus.setSend(u,f)}),q(this,"setLpfCutoff",u=>this.outBus.setLpfCutoff(u)),q(this,"setHpfCutoff",u=>this.outBus.setHpfCutoff(u)),q(this,"setReverbAmount",u=>{this.outBus.setReverbAmount(u)}),q(this,"setFeedbackAmount",u=>{(i(this,Bn)==="monophonic"||i(this,Bn)==="double-trouble")&&this.outBus.setFeedbackAmount(u),(i(this,Bn)==="polyphonic"||i(this,Bn)==="double-trouble")&&this.voicePool.applyToAllVoices(f=>{var y;(y=f.feedback)==null||y.setAmountMacro(u)})}),M(this,Bn,"monophonic"),this.nodeId=Ot("sample-player",this),this.context=e,g(this,Ir,mn(this.nodeId)),g(this,_e,h||null),this.outBus=new Rc,this.voicePool=new Nc(e,r,this.outBus.input,!0),g(this,$e,new GainNode(e,{gain:.5})),this.outBus.connect(i(this,$e)),i(this,$e).connect(e.destination),g(this,Fe,new Ua(e,Be.LOOP_START)),g(this,Me,new Ua(e,Be.LOOP_END)),K(this,Ln,Nu).call(this),K(this,Ln,Vu).call(this),K(this,Ln,Fu).call(this),g(this,wi,!0),o!=null&&o.duration&&this.loadSample(o,o.sampleRate)}onMessage(e,r){return i(this,Ir).onMessage(e,r)}sendUpstreamMessage(e,r){return i(this,Ir).sendMessage(e,r),this}connect(e){var r;const o="input"in e&&e.input?e.input:e;i(this,$e).connect(o),"nodeId"in e&&(i(this,yr).add(e.nodeId),(r=e.addIncoming)==null||r.call(e,this.nodeId))}disconnect(e){var r;if(e){const o="input"in e?e.input:e;i(this,$e).disconnect(o),"nodeId"in e&&(i(this,yr).delete(e.nodeId),(r=e.removeIncoming)==null||r.call(e,this.nodeId))}else i(this,$e).disconnect(),i(this,yr).clear()}addIncoming(e){i(this,mi).add(e.nodeId)}removeIncoming(e){i(this,mi).delete(e.nodeId)}get connections(){return{outgoing:Array.from(i(this,yr)),incoming:Array.from(i(this,mi))}}setParam(e,r,o=this.now){this.setParameterValue(e,r)}getParam(e){switch(e){case"loopStart":return i(this,Fe).audioParam;case"loopEnd":return i(this,Me).audioParam;default:return console.warn(`Parameter '${e}' not found on SamplePlayer`),null}}get audioNode(){return i(this,$e)}get input(){return this.outBus.input}get output(){return i(this,$e)}get now(){return this.context.currentTime}get initialized(){return i(this,wi)}storeParamValue(e,r){const o=this.getLocalStorageKey(e);Bc(o,r)}getStoredParamValue(e,r){const o=this.getLocalStorageKey(e);return Vc(o,r)}getLocalStorageKey(e){return`${e}-${this.nodeId}`}getMacrosAudioParam(e){switch(e){case"loopStart":return i(this,Fe).audioParam;case"loopEnd":return i(this,Me).audioParam;default:const r=e;throw new Error(`Unknown macro parameter: ${r}`)}}getMacro(e){switch(e){case"loopStart":return i(this,Fe);case"loopEnd":return i(this,Me);default:const r=e;throw new Error(`Unknown macro parameter: ${r}`)}}setModulationWaveform(e="AM",r="triangle",o={}){this.voicePool.applyToAllVoices(h=>h.setModulationWaveform(e,r,o))}syncLFOsToNoteFreq(e,r){var o,h,u,f,y,P;if(e==="gain-lfo"){if(r===!0)(o=i(this,mt))==null||o.storeCurrentValues();else{const S=(h=i(this,mt))==null?void 0:h.getStoredValues();S&&((u=i(this,mt))==null||u.setFrequency(S.rate))}g(this,xs,r)}if(e==="pitch-lfo"){if(r===!0)(f=i(this,lt))==null||f.storeCurrentValues();else{const S=(y=i(this,lt))==null?void 0:y.getStoredValues();S&&((P=i(this,lt))==null||P.setFrequency(S.rate))}g(this,Es,r)}}async loadSample(e,r,o){if(e instanceof ArrayBuffer&&(e=await pn().decodeAudioData(e)),!xl(e))return null;(e.sampleRate!==this.context.sampleRate||r&&this.context.sampleRate!==r)&&console.warn(`sample rate mismatch, 
        buffer rate: ${e.sampleRate}, 
        context rate: ${this.context.sampleRate}
        requested rate: ${r}`),this.releaseAll(0),this.voicePool.transposeSemitones=0,g(this,Sr,!1),g(this,gi,null);let h;i(this,Go)&&(h=await mu(this.context,e,o),e=h.audiobuffer,i(this,Ts)&&h.zeroCrossings&&g(this,Nn,h.zeroCrossings)),this.voicePool.setBuffer(e,i(this,Nn)),g(this,It,e.duration),K(this,Ln,Bu).call(this,e.duration);const u={rootNote:"C",scale:[0],lowestOctave:0,highestOctave:6,tuningOffset:0,normalize:!1};return this.setScale(u),g(this,gi,e),e}async detectPitch(e){const r=await pu(e),o=hu(r.frequency),h=69+12*Math.log2(r.frequency/440),u=o.frequency/r.frequency;return console.table({pitchSource:r,targetNoteInfo:o,playbackRateMultiplier:u,midiFloat:h}),this.sendUpstreamMessage("sample:pitch-detected",{pitchResults:r,closestNoteInfo:o}),{frequency:r.frequency,confidence:r.confidence,midiFloat:h,targetNoteInfo:o}}detectedPitchToTransposition(e,r){let o=r-e;for(;o>6;)o-=12;for(;o<-6;)o+=12;return o}play(e,r=100,o=this.getGlideTime()){var h,u;const f=Gl(r)?r:100;return i(this,xs)&&((h=i(this,mt))==null||h.setMusicalNote(e)),i(this,Es)&&((u=i(this,lt))==null||u.setMusicalNote(e,{divisor:4})),this.outBus.noteOn(e,f,0,o),this.voicePool.noteOn(e,f,0,o,i(this,Me).getValue())}release(e){return this.holdEnabled||i(this,br)?this:(this.voicePool.noteOff(e),this.sendUpstreamMessage("note:off",{midiNote:e}),this)}releaseAll(e){return this.voicePool.allNotesOff(e),this}setScale(e){return i(this,Fe).setScale({snapToZeroCrossings:i(this,Nn),...e}),i(this,Me).setScale({snapToZeroCrossings:i(this,Nn),...e}),this}setSampleStartPoint(e){return this.storeParamValue("startPoint",e),this.voicePool.applyToAllVoices(r=>r.setStartPoint(e)),this}setSampleEndPoint(e){return this.storeParamValue("endPoint",e),this.voicePool.applyToAllVoices(r=>r.setEndPoint(e)),this}setLoopRampDuration(e){return this.storeParamValue("loopRampDuration",e),this}setGlideTime(e){return this.storeParamValue("glideTime",e),this}setLoopEnabled(e){return i(this,wr)===e?this:i(this,vi)&&!e?this:(this.voicePool.allVoices.forEach(r=>r.setLoopEnabled(e)),g(this,wr,e),this.sendUpstreamMessage("loop:enabled",{enabled:e}),this)}setLoopLocked(e){return i(this,vi)===e?this:(g(this,vi,e),this.setLoopEnabled(e),this.sendUpstreamMessage("loop:locked",{locked:e}),this)}setHoldEnabled(e){return i(this,yi)===e?this:i(this,br)&&!e?this:(g(this,yi,e),e||this.releaseAll(this.getReleaseTime()),this.sendUpstreamMessage("hold:enabled",{enabled:e}),this)}setHoldLocked(e){return i(this,br)===e?this:(g(this,br,e),e===!1&&this.releaseAll(),console.debug(`sending hold:locked message, locked: ${e}`),this.sendUpstreamMessage("hold:locked",{locked:e}),this)}setPlaybackDirection(e){return this.voicePool.applyToAllVoices(r=>r.setPlaybackDirection(e)),this}setLoopDurationDriftAmount(e){return this.voicePool.applyToAllVoices(r=>r.setLoopDurationDriftAmount(e)),this}setLoopPoint(e,r,o,h=this.getLoopRampDuration()){r>=o&&(console.debug(`samplePlayer.setLoopPoint: Loop points out of bounds.
      Adjusting: ${e}, loopStart: ${r}, loopEnd: ${o}`),e==="start"?r=Math.max(0,o-.001):o=Math.min(i(this,It),r+.001)),this.isLoaded&&o>=i(this,It)&&(o=i(this,It)-.001);const u=h*1;if(e==="start"&&r!==this.loopStart){const f=()=>this.storeParamValue("loopStart",r);i(this,Fe).ramp(r,u,o,{onComplete:()=>{f()}})}else if(e==="end"&&o!==this.loopEnd){const f=()=>this.storeParamValue("loopEnd",o);i(this,Me).ramp(o,u,r,{onComplete:()=>{f()}})}return this}scrollLoopPoints(e,r){const o=this.context.currentTime;return i(this,Fe).setValue(e,o),i(this,Me).setValue(r,o),this}setParameterValue(e,r){switch(e){case"startPoint":this.setSampleStartPoint(r);break;case"endPoint":this.setSampleEndPoint(r);break;case"glideTime":this.setGlideTime(r);break;case"loopStart":this.setLoopStart(r);break;case"loopEnd":this.setLoopEnd(r);break;case"loopRampDuration":this.setLoopRampDuration(r);break;default:console.warn(`Unknown parameter: ${e}`)}return this}getAttackTime(){return this.getStoredParamValue("attack",Be.ATTACK.defaultValue)}getReleaseTime(){return this.getStoredParamValue("release",Be.RELEASE.defaultValue)}getStartPoint(){return this.getStoredParamValue("startPoint",Be.START_POINT.defaultValue)}getEndPoint(){return this.getStoredParamValue("endPoint",Be.END_POINT.defaultValue)}getLoopRampDuration(){return this.getStoredParamValue("loopRampDuration",Be.LOOP_RAMP_DURATION.defaultValue)}getGlideTime(){return this.getStoredParamValue("glideTime",0)}getParameterDescriptors(){return{attack:Be.ATTACK,release:Be.RELEASE,startPoint:Be.START_POINT,endPoint:Be.END_POINT,playbackRate:Be.PLAYBACK_RATE,loopStart:i(this,Fe).descriptor,loopEnd:i(this,Me).descriptor,loopRampDuration:Be.LOOP_RAMP_DURATION,hpfCutoff:Be.HIGHPASS_CUTOFF,lpfCutoff:Be.LOWPASS_CUTOFF}}getParameterValue(e){switch(e){case"loopStart":return this.loopStart;case"loopEnd":return this.loopEnd;case"loopRampDuration":return this.getLoopRampDuration();case"attack":return this.getAttackTime();case"release":return this.getReleaseTime();case"startPoint":return this.getStartPoint();case"endPoint":return this.getEndPoint();case"glideTime":return this.getGlideTime();case"hpfCutoff":return this.getHpfCutoff();case"lpfCutoff":return this.getLpfCutoff();default:console.warn(`Unknown parameter: ${e}`);return}}getEnvelope(e){const r=this.voicePool.allVoices[0];if(!r)throw new Error("No voices available in voice pool");const o=r.getEnvelope(e);if(!o)throw new Error(`Envelope type '${e}' not found`);return o}setEnvelopeSustainPoint(e,r){this.voicePool.applyToAllVoices(o=>o.setEnvelopeSustainPoint(e,r))}setEnvelopeReleasePoint(e,r){this.voicePool.applyToAllVoices(o=>o.setEnvelopeReleasePoint(e,r))}updateEnvelopePoint(e,r,o,h){this.voicePool.applyToAllVoices(u=>u.updateEnvelopePoint(e,r,o,h))}addEnvelopePoint(e,r,o){this.voicePool.applyToAllVoices(h=>h.addEnvelopePoint(e,r,o))}deleteEnvelopePoint(e,r){this.voicePool.applyToAllVoices(o=>o.deleteEnvelopePoint(e,r))}startLevelMonitoring(e){this.outBus.startLevelMonitoring(e)}setFeedbackDecay(e){this.outBus.setFeedbackDecay(e);const r=an(e,0,1,0,.75);this.voicePool.applyToAllVoices(o=>{var h;(h=o.feedback)==null||h.setDecay(r)})}setFeedbackMode(e){var r;if(g(this,Bn,e),e==="monophonic"){let o=((r=this.voicePool.allVoices[0].feedback)==null?void 0:r.currAmount)??0;this.voicePool.applyToAllVoices(h=>{var u;(u=h.feedback)==null||u.setAmountMacro(0)}),this.outBus.setFeedbackAmount(o)}else if(e==="polyphonic"){const o=this.outBus.getFeedback().currAmount;this.outBus.setFeedbackAmount(0),this.voicePool.applyToAllVoices(h=>{var u;(u=h.feedback)==null||u.setAmountMacro(o)})}else console.info("Feedback mode set to double-trouble, radical!")}setFeedbackPitchScale(e){this.outBus.setFeedbackPitchScale(e),this.voicePool.applyToAllVoices(r=>{var o;(o=r.feedback)==null||o.setDelayMultiplier(e)})}async initMidiController(){var e;if((e=i(this,_e))!=null&&e.isInitialized)return!0;i(this,_e)||g(this,_e,new ja),fn(i(this,_e),"SamplePlayer: Failed to create MIDI controller");const r=await Jo(()=>i(this,_e).initialize());return fn(!r.error,"SamplePlayer: Failed to initialize MIDI"),r.data}setMidiController(e){return g(this,_e,e),this}async enableMIDI(e,r=0){return e||(e=new ja,await e.initialize()),e.isInitialized&&(g(this,_e,e),e.connectInstrument(this,r)),this}disableMIDI(e,r=0){const o=e||i(this,_e);return o==null||o.disconnectInstrument(r),o===i(this,_e)&&g(this,_e,null),this}get mainOut(){return i(this,$e)}get outputBus(){return this.outBus}get sampleDuration(){return i(this,It)}get volume(){return i(this,$e).gain.value}set volume(e){i(this,$e).gain.setValueAtTime(e,this.context.currentTime)}get loopEnabled(){return i(this,wr)}get holdEnabled(){return i(this,yi)}get gainLFO(){return i(this,mt)}get pitchLFO(){return i(this,lt)}get loopStart(){return i(this,Fe).getValue()}get loopEnd(){return i(this,Me).getValue()}get isLoaded(){return i(this,Sr)}get audiobuffer(){return i(this,gi)}dispose(){var e,r,o,h;try{this.releaseAll(),this.voicePool&&(this.voicePool.dispose(),this.voicePool=null),this.outBus&&(this.outBus.dispose(),this.outBus=null),(e=i(this,Fe))==null||e.dispose(),(r=i(this,Me))==null||r.dispose(),g(this,Fe,null),g(this,Me,null),(o=i(this,mt))==null||o.dispose(),(h=i(this,lt))==null||h.dispose(),this.disconnect(),this.disableMIDI(),g(this,It,0),g(this,wi,!1),g(this,Sr,!1),g(this,Nn,[]),g(this,Ts,!1),g(this,wr,!1),Ct(this.nodeId)}catch(u){console.error(`Error disposing Sampler ${this.nodeId}:`,u)}}}Ir=new WeakMap,_e=new WeakMap,yr=new WeakMap,mi=new WeakMap,gi=new WeakMap,It=new WeakMap,wr=new WeakMap,vi=new WeakMap,yi=new WeakMap,br=new WeakMap,$e=new WeakMap,Fe=new WeakMap,Me=new WeakMap,mt=new WeakMap,lt=new WeakMap,xs=new WeakMap,Es=new WeakMap,zo=new WeakMap,wi=new WeakMap,Sr=new WeakMap,Nn=new WeakMap,Ts=new WeakMap,Go=new WeakMap,Ln=new WeakSet,Fu=function(){return this.voicePool.onMessage("sample:loaded",c=>{i(this,zo).forEach(e=>{e.setDurationSeconds(c.durationSeconds)}),g(this,Sr,!0)}),this.voicePool.onMessage("voice-pool:initialized",()=>{this.sendUpstreamMessage("sample-player:ready",{})}),i(this,Ir).forwardFrom(this.voicePool,["voice-pool:initialized","voice:started","voice:stopped","voice:releasing","sample:loaded","amp-env:trigger","amp-env:trigger:loop","amp-env:release","pitch-env:trigger","pitch-env:trigger:loop","pitch-env:release","filter-env:trigger","filter-env:trigger:loop","filter-env:release"]),this},Nu=function(){const c=this.voicePool.allVoices;return i(this,Fe).audioParam.setValueAtTime(0,this.context.currentTime),i(this,Me).audioParam.setValueAtTime(i(this,It),this.context.currentTime),c.forEach((e,r)=>{const o=e.getParam("loopStart"),h=e.getParam("loopEnd");o?i(this,Fe).addTarget(o,"loopStart"):console.error("loopStart param is null!"),h?i(this,Me).addTarget(h,"loopEnd"):console.error("loopEnd param is null!")}),this},Bu=function(c=i(this,It)){return i(this,Fe).audioParam.setValueAtTime(0,this.context.currentTime),i(this,Me).audioParam.setValueAtTime(c,this.context.currentTime),this},Vu=function(){g(this,mt,new No(this.context)),i(this,mt).setWaveform("sine"),g(this,lt,new No(this.context));const c=i(this,lt).getPitchWobbleWaveform();i(this,lt).setWaveform(c),K(this,Ln,Ja).call(this,i(this,lt),"playbackRate"),i(this,mt).connect(this.outBus.input.gain)},Ja=function(c,e){this.voicePool.applyToAllVoices(r=>{const o=r.getParam(e);o&&c.connect(o)})},Bn=new WeakMap;const xi=[];function Wc(c){xi.push(c)}function qc(c){return xi.includes(c)}function jc(){return[...xi]}function Lc(){return xi.length=0,xi.length===0}const is={has:qc,add:Wc,getAll:jc,clear:Lc};let So=!1;const Qc=["/node_modules/@repo/audiolib/dist/processors/processors.js","./processors/processors.js","/processors/processors.js",new URL(""+new URL("processors-CnsiuGH9.js",import.meta.url).href,import.meta.url).href];async function Uc(){try{const c=[new URL(""+new URL("processors-CnsiuGH9.js",import.meta.url).href,import.meta.url).href,"/processors/processors.js","./processors/processors.js"];let e=null,r=null;for(const h of c)try{const u=await fetch(h);if(!u.ok)throw new Error(`HTTP error ${u.status}`);e=await u.text(),console.info(`Fetched processor code from: ${h}`);break}catch(u){console.debug(`Failed to fetch from ${h}:`,u),r=u}if(!e)throw r||new Error("Couldn't fetch processor code from any URL");const o=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(o)}catch(c){throw console.error("Failed to create Blob URL:",c),c}}async function zc(c){if(So)return console.info("AudioWorklet processors already initialized, skipping"),{success:!0,loadedPath:"already-initialized",timestamp:new Date().toISOString()};if(!c.audioWorklet)return console.warn("AudioWorklet API is not fully supported on this browser."),console.warn("The audio sampler requires AudioWorklet support. Please try:"),console.warn("1. Using Chrome, Firefox, or Edge on desktop"),console.warn("2. Updating your mobile browser to the latest version"),console.warn("3. Using a different browser on mobile (Chrome or Firefox)"),{success:!1,loadedPath:"none-worklet-not-supported",timestamp:new Date().toISOString(),error:"AudioWorklet not supported on this browser"};let e=null;for(const r of Qc)if(!is.has(r))try{return await c.audioWorklet.addModule(r),is.add(r),So=!0,console.info("Audiolib: AudioWorklet module loaded."),{success:!0,loadedPath:r,timestamp:new Date().toISOString()}}catch(o){e=o}try{const r=await Uc();return is.has(r)||(await c.audioWorklet.addModule(r),is.add(r),So=!0,console.info("AudioWorklet module loaded from Blob URL")),URL.revokeObjectURL(r),{success:!0,loadedPath:"blob-url",timestamp:new Date().toISOString()}}catch(r){console.error("Failed to load AudioWorklet from Blob URL:",r),e=new Error(`Failed to load AudioWorklet from all paths. Last error: ${e instanceof Error&&e.message||"Unknown error"}. Blob URL error: ${typeof r=="object"&&r&&"message"in r?r.message:String(r)}`)}throw e||new Error("Failed to load AudioWorklet from all paths")}var Gc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yc(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Yo={exports:{}},Zc=Yo.exports,_a;function Hc(){return _a||(_a=1,function(c,e){(function(r,o){c.exports=o()})(Zc,function(){var r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(s[l]=a[l])})(t,n)},o=function(){return(o=Object.assign||function(t){for(var n,s=1,a=arguments.length;s<a;s++)for(var l in n=arguments[s])Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l]);return t}).apply(this,arguments)};function h(t,n,s){for(var a,l=0,d=n.length;l<d;l++)!a&&l in n||((a=a||Array.prototype.slice.call(n,0,l))[l]=n[l]);return t.concat(a||Array.prototype.slice.call(n))}var u=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Gc,f=Object.keys,y=Array.isArray;function P(t,n){return typeof n!="object"||f(n).forEach(function(s){t[s]=n[s]}),t}typeof Promise>"u"||u.Promise||(u.Promise=Promise);var S=Object.getPrototypeOf,F={}.hasOwnProperty;function N(t,n){return F.call(t,n)}function U(t,n){typeof n=="function"&&(n=n(S(t))),(typeof Reflect>"u"?f:Reflect.ownKeys)(n).forEach(function(s){H(t,s,n[s])})}var te=Object.defineProperty;function H(t,n,s,a){te(t,n,P(s&&N(s,"get")&&typeof s.get=="function"?{get:s.get,set:s.set,configurable:!0}:{value:s,configurable:!0,writable:!0},a))}function ce(t){return{from:function(n){return t.prototype=Object.create(n.prototype),H(t.prototype,"constructor",t),{extend:U.bind(null,t.prototype)}}}}var de=Object.getOwnPropertyDescriptor,Se=[].slice;function yt(t,n,s){return Se.call(t,n,s)}function Ei(t,n){return n(t)}function ue(t){if(!t)throw new Error("Assertion Failed")}function dt(t){u.setImmediate?setImmediate(t):setTimeout(t,0)}function qe(t,n){if(typeof n=="string"&&N(t,n))return t[n];if(!n)return t;if(typeof n!="string"){for(var s=[],a=0,l=n.length;a<l;++a){var d=qe(t,n[a]);s.push(d)}return s}var p=n.indexOf(".");if(p!==-1){var m=t[n.substr(0,p)];return m==null?void 0:qe(m,n.substr(p+1))}}function Ye(t,n,s){if(t&&n!==void 0&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof n!="string"&&"length"in n){ue(typeof s!="string"&&"length"in s);for(var a=0,l=n.length;a<l;++a)Ye(t,n[a],s[a])}else{var d,p,m=n.indexOf(".");m!==-1?(d=n.substr(0,m),(p=n.substr(m+1))===""?s===void 0?y(t)&&!isNaN(parseInt(d))?t.splice(d,1):delete t[d]:t[d]=s:Ye(m=!(m=t[d])||!N(t,d)?t[d]={}:m,p,s)):s===void 0?y(t)&&!isNaN(parseInt(n))?t.splice(n,1):delete t[n]:t[n]=s}}function $o(t){var n,s={};for(n in t)N(t,n)&&(s[n]=t[n]);return s}var Lu=[].concat;function ea(t){return Lu.apply([],t)}var wn="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ea([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(n){return n+t+"Array"})}))).filter(function(t){return u[t]}),ta=new Set(wn.map(function(t){return u[t]})),Or=null;function gn(t){return Or=new WeakMap,t=function n(s){if(!s||typeof s!="object")return s;var a=Or.get(s);if(a)return a;if(y(s)){a=[],Or.set(s,a);for(var l=0,d=s.length;l<d;++l)a.push(n(s[l]))}else if(ta.has(s.constructor))a=s;else{var p,m=S(s);for(p in a=m===Object.prototype?{}:Object.create(m),Or.set(s,a),s)N(s,p)&&(a[p]=n(s[p]))}return a}(t),Or=null,t}var Qu={}.toString;function Ns(t){return Qu.call(t).slice(8,-1)}var Bs=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Uu=typeof Bs=="symbol"?function(t){var n;return t!=null&&(n=t[Bs])&&n.apply(t)}:function(){return null};function vn(t,n){return n=t.indexOf(n),0<=n&&t.splice(n,1),0<=n}var Un={};function Rt(t){var n,s,a,l;if(arguments.length===1){if(y(t))return t.slice();if(this===Un&&typeof t=="string")return[t];if(l=Uu(t)){for(s=[];!(a=l.next()).done;)s.push(a.value);return s}if(t==null)return[t];if(typeof(n=t.length)!="number")return[t];for(s=new Array(n);n--;)s[n]=t[n];return s}for(n=arguments.length,s=new Array(n);n--;)s[n]=arguments[n];return s}var Vs=typeof Symbol<"u"?function(t){return t[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Fr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],rt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Fr),zu={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function zn(t,n){this.name=t,this.message=n}function na(t,n){return t+". Errors: "+Object.keys(n).map(function(s){return n[s].toString()}).filter(function(s,a,l){return l.indexOf(s)===a}).join(`
`)}function Ti(t,n,s,a){this.failures=n,this.failedKeys=a,this.successCount=s,this.message=na(t,n)}function Gn(t,n){this.name="BulkError",this.failures=Object.keys(n).map(function(s){return n[s]}),this.failuresByPos=n,this.message=na(t,this.failures)}ce(zn).from(Error).extend({toString:function(){return this.name+": "+this.message}}),ce(Ti).from(zn),ce(Gn).from(zn);var Ks=rt.reduce(function(t,n){return t[n]=n+"Error",t},{}),Gu=zn,Z=rt.reduce(function(t,n){var s=n+"Error";function a(l,d){this.name=s,l?typeof l=="string"?(this.message="".concat(l).concat(d?`
 `+d:""),this.inner=d||null):typeof l=="object"&&(this.message="".concat(l.name," ").concat(l.message),this.inner=l):(this.message=zu[n]||s,this.inner=null)}return ce(a).from(Gu),t[n]=a,t},{});Z.Syntax=SyntaxError,Z.Type=TypeError,Z.Range=RangeError;var ra=Fr.reduce(function(t,n){return t[n+"Error"]=Z[n],t},{}),Ii=rt.reduce(function(t,n){return["Syntax","Type","Range"].indexOf(n)===-1&&(t[n+"Error"]=Z[n]),t},{});function ie(){}function Cr(t){return t}function Yu(t,n){return t==null||t===Cr?n:function(s){return n(t(s))}}function yn(t,n){return function(){t.apply(this,arguments),n.apply(this,arguments)}}function Zu(t,n){return t===ie?n:function(){var s=t.apply(this,arguments);s!==void 0&&(arguments[0]=s);var a=this.onsuccess,l=this.onerror;this.onsuccess=null,this.onerror=null;var d=n.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?yn(a,this.onsuccess):a),l&&(this.onerror=this.onerror?yn(l,this.onerror):l),d!==void 0?d:s}}function Hu(t,n){return t===ie?n:function(){t.apply(this,arguments);var s=this.onsuccess,a=this.onerror;this.onsuccess=this.onerror=null,n.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?yn(s,this.onsuccess):s),a&&(this.onerror=this.onerror?yn(a,this.onerror):a)}}function Xu(t,n){return t===ie?n:function(s){var a=t.apply(this,arguments);P(s,a);var l=this.onsuccess,d=this.onerror;return this.onsuccess=null,this.onerror=null,s=n.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?yn(l,this.onsuccess):l),d&&(this.onerror=this.onerror?yn(d,this.onerror):d),a===void 0?s===void 0?void 0:s:P(a,s)}}function Ju(t,n){return t===ie?n:function(){return n.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function Ws(t,n){return t===ie?n:function(){var s=t.apply(this,arguments);if(s&&typeof s.then=="function"){for(var a=this,l=arguments.length,d=new Array(l);l--;)d[l]=arguments[l];return s.then(function(){return n.apply(a,d)})}return n.apply(this,arguments)}}Ii.ModifyError=Ti,Ii.DexieError=zn,Ii.BulkError=Gn;var wt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ia(t){wt=t}var Rr={},sa=100,wn=typeof Promise>"u"?[]:function(){var t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,S(t),t];var n=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[n,S(n),t]}(),Fr=wn[0],rt=wn[1],wn=wn[2],rt=rt&&rt.then,bn=Fr&&Fr.constructor,qs=!!wn,Nr=function(t,n){Br.push([t,n]),Si&&(queueMicrotask($u),Si=!1)},js=!0,Si=!0,An=[],Di=[],Ls=Cr,Lt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ie,pgp:!1,env:{},finalize:ie},Y=Lt,Br=[],Pn=0,Oi=[];function z(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var n=this._PSD=Y;if(typeof t!="function"){if(t!==Rr)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Us(this,this._value))}this._state=null,this._value=null,++n.ref,function s(a,l){try{l(function(d){if(a._state===null){if(d===a)throw new TypeError("A promise cannot be resolved with itself.");var p=a._lib&&Yn();d&&typeof d.then=="function"?s(a,function(m,w){d instanceof z?d._then(m,w):d.then(m,w)}):(a._state=!0,a._value=d,aa(a)),p&&Zn()}},Us.bind(null,a))}catch(d){Us(a,d)}}(this,t)}var Qs={get:function(){var t=Y,n=Ni;function s(a,l){var d=this,p=!t.global&&(t!==Y||n!==Ni),m=p&&!Ut(),w=new z(function(A,E){zs(d,new oa(la(a,t,p,m),la(l,t,p,m),A,E,t))});return this._consoleTask&&(w._consoleTask=this._consoleTask),w}return s.prototype=Rr,s},set:function(t){H(this,"then",t&&t.prototype===Rr?Qs:{get:function(){return t},set:Qs.set})}};function oa(t,n,s,a,l){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof n=="function"?n:null,this.resolve=s,this.reject=a,this.psd=l}function Us(t,n){var s,a;Di.push(n),t._state===null&&(s=t._lib&&Yn(),n=Ls(n),t._state=!1,t._value=n,a=t,An.some(function(l){return l._value===a._value})||An.push(a),aa(t),s&&Zn())}function aa(t){var n=t._listeners;t._listeners=[];for(var s=0,a=n.length;s<a;++s)zs(t,n[s]);var l=t._PSD;--l.ref||l.finalize(),Pn===0&&(++Pn,Nr(function(){--Pn==0&&Gs()},[]))}function zs(t,n){if(t._state!==null){var s=t._state?n.onFulfilled:n.onRejected;if(s===null)return(t._state?n.resolve:n.reject)(t._value);++n.psd.ref,++Pn,Nr(_u,[s,t,n])}else t._listeners.push(n)}function _u(t,n,s){try{var a,l=n._value;!n._state&&Di.length&&(Di=[]),a=wt&&n._consoleTask?n._consoleTask.run(function(){return t(l)}):t(l),n._state||Di.indexOf(l)!==-1||function(d){for(var p=An.length;p;)if(An[--p]._value===d._value)return An.splice(p,1)}(n),s.resolve(a)}catch(d){s.reject(d)}finally{--Pn==0&&Gs(),--s.psd.ref||s.psd.finalize()}}function $u(){kn(Lt,function(){Yn()&&Zn()})}function Yn(){var t=js;return Si=js=!1,t}function Zn(){var t,n,s;do for(;0<Br.length;)for(t=Br,Br=[],s=t.length,n=0;n<s;++n){var a=t[n];a[0].apply(null,a[1])}while(0<Br.length);Si=js=!0}function Gs(){var t=An;An=[],t.forEach(function(a){a._PSD.onunhandled.call(null,a._value,a)});for(var n=Oi.slice(0),s=n.length;s;)n[--s]()}function Ci(t){return new z(Rr,!1,t)}function he(t,n){var s=Y;return function(){var a=Yn(),l=Y;try{return zt(s,!0),t.apply(this,arguments)}catch(d){n&&n(d)}finally{zt(l,!1),a&&Zn()}}}U(z.prototype,{then:Qs,_then:function(t,n){zs(this,new oa(null,null,t,n,Y))},catch:function(t){if(arguments.length===1)return this.then(null,t);var n=t,s=arguments[1];return typeof n=="function"?this.then(null,function(a){return(a instanceof n?s:Ci)(a)}):this.then(null,function(a){return(a&&a.name===n?s:Ci)(a)})},finally:function(t){return this.then(function(n){return z.resolve(t()).then(function(){return n})},function(n){return z.resolve(t()).then(function(){return Ci(n)})})},timeout:function(t,n){var s=this;return t<1/0?new z(function(a,l){var d=setTimeout(function(){return l(new Z.Timeout(n))},t);s.then(a,l).finally(clearTimeout.bind(null,d))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&H(z.prototype,Symbol.toStringTag,"Dexie.Promise"),Lt.env=ua(),U(z,{all:function(){var t=Rt.apply(null,arguments).map(Bi);return new z(function(n,s){t.length===0&&n([]);var a=t.length;t.forEach(function(l,d){return z.resolve(l).then(function(p){t[d]=p,--a||n(t)},s)})})},resolve:function(t){return t instanceof z?t:t&&typeof t.then=="function"?new z(function(n,s){t.then(n,s)}):new z(Rr,!0,t)},reject:Ci,race:function(){var t=Rt.apply(null,arguments).map(Bi);return new z(function(n,s){t.map(function(a){return z.resolve(a).then(n,s)})})},PSD:{get:function(){return Y},set:function(t){return Y=t}},totalEchoes:{get:function(){return Ni}},newPSD:Qt,usePSD:kn,scheduler:{get:function(){return Nr},set:function(t){Nr=t}},rejectionMapper:{get:function(){return Ls},set:function(t){Ls=t}},follow:function(t,n){return new z(function(s,a){return Qt(function(l,d){var p=Y;p.unhandleds=[],p.onunhandled=d,p.finalize=yn(function(){var m,w=this;m=function(){w.unhandleds.length===0?l():d(w.unhandleds[0])},Oi.push(function A(){m(),Oi.splice(Oi.indexOf(A),1)}),++Pn,Nr(function(){--Pn==0&&Gs()},[])},p.finalize),t()},n,s,a)})}}),bn&&(bn.allSettled&&H(z,"allSettled",function(){var t=Rt.apply(null,arguments).map(Bi);return new z(function(n){t.length===0&&n([]);var s=t.length,a=new Array(s);t.forEach(function(l,d){return z.resolve(l).then(function(p){return a[d]={status:"fulfilled",value:p}},function(p){return a[d]={status:"rejected",reason:p}}).then(function(){return--s||n(a)})})})}),bn.any&&typeof AggregateError<"u"&&H(z,"any",function(){var t=Rt.apply(null,arguments).map(Bi);return new z(function(n,s){t.length===0&&s(new AggregateError([]));var a=t.length,l=new Array(a);t.forEach(function(d,p){return z.resolve(d).then(function(m){return n(m)},function(m){l[p]=m,--a||s(new AggregateError(l))})})})}),bn.withResolvers&&(z.withResolvers=bn.withResolvers));var ye={awaits:0,echoes:0,id:0},el=0,Ri=[],Fi=0,Ni=0,tl=0;function Qt(t,n,s,a){var l=Y,d=Object.create(l);return d.parent=l,d.ref=0,d.global=!1,d.id=++tl,Lt.env,d.env=qs?{Promise:z,PromiseProp:{value:z,configurable:!0,writable:!0},all:z.all,race:z.race,allSettled:z.allSettled,any:z.any,resolve:z.resolve,reject:z.reject}:{},n&&P(d,n),++l.ref,d.finalize=function(){--this.parent.ref||this.parent.finalize()},a=kn(d,t,s,a),d.ref===0&&d.finalize(),a}function Hn(){return ye.id||(ye.id=++el),++ye.awaits,ye.echoes+=sa,ye.id}function Ut(){return!!ye.awaits&&(--ye.awaits==0&&(ye.id=0),ye.echoes=ye.awaits*sa,!0)}function Bi(t){return ye.echoes&&t&&t.constructor===bn?(Hn(),t.then(function(n){return Ut(),n},function(n){return Ut(),fe(n)})):t}function nl(){var t=Ri[Ri.length-1];Ri.pop(),zt(t,!1)}function zt(t,n){var s,a=Y;(n?!ye.echoes||Fi++&&t===Y:!Fi||--Fi&&t===Y)||queueMicrotask(n?(function(l){++Ni,ye.echoes&&--ye.echoes!=0||(ye.echoes=ye.awaits=ye.id=0),Ri.push(Y),zt(l,!0)}).bind(null,t):nl),t!==Y&&(Y=t,a===Lt&&(Lt.env=ua()),qs&&(s=Lt.env.Promise,n=t.env,(a.global||t.global)&&(Object.defineProperty(u,"Promise",n.PromiseProp),s.all=n.all,s.race=n.race,s.resolve=n.resolve,s.reject=n.reject,n.allSettled&&(s.allSettled=n.allSettled),n.any&&(s.any=n.any))))}function ua(){var t=u.Promise;return qs?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(u,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject}:{}}function kn(t,n,s,a,l){var d=Y;try{return zt(t,!0),n(s,a,l)}finally{zt(d,!1)}}function la(t,n,s,a){return typeof t!="function"?t:function(){var l=Y;s&&Hn(),zt(n,!0);try{return t.apply(this,arguments)}finally{zt(l,!1),a&&queueMicrotask(Ut)}}}function Ys(t){Promise===bn&&ye.echoes===0?Fi===0?t():enqueueNativeMicroTask(t):setTimeout(t,0)}(""+rt).indexOf("[native code]")===-1&&(Hn=Ut=ie);var fe=z.reject,Mn="￿",Ft="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ca="String expected.",Xn=[],Vi="__dbnames",Zs="readonly",Hs="readwrite";function xn(t,n){return t?n?function(){return t.apply(this,arguments)&&n.apply(this,arguments)}:t:n}var ha={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ki(t){return typeof t!="string"||/\./.test(t)?function(n){return n}:function(n){return n[t]===void 0&&t in n&&delete(n=gn(n))[t],n}}function da(){throw Z.Type()}function ee(t,n){try{var s=fa(t),a=fa(n);if(s!==a)return s==="Array"?1:a==="Array"?-1:s==="binary"?1:a==="binary"?-1:s==="string"?1:a==="string"?-1:s==="Date"?1:a!=="Date"?NaN:-1;switch(s){case"number":case"Date":case"string":return n<t?1:t<n?-1:0;case"binary":return function(l,d){for(var p=l.length,m=d.length,w=p<m?p:m,A=0;A<w;++A)if(l[A]!==d[A])return l[A]<d[A]?-1:1;return p===m?0:p<m?-1:1}(pa(t),pa(n));case"Array":return function(l,d){for(var p=l.length,m=d.length,w=p<m?p:m,A=0;A<w;++A){var E=ee(l[A],d[A]);if(E!==0)return E}return p===m?0:p<m?-1:1}(t,n)}}catch{}return NaN}function fa(t){var n=typeof t;return n!="object"?n:ArrayBuffer.isView(t)?"binary":(t=Ns(t),t==="ArrayBuffer"?"binary":t)}function pa(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var ma=(le.prototype._trans=function(t,n,s){var a=this._tx||Y.trans,l=this.name,d=wt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function p(A,E,v){if(!v.schema[l])throw new Z.NotFound("Table "+l+" not part of transaction");return n(v.idbtrans,v)}var m=Yn();try{var w=a&&a.db._novip===this.db._novip?a===Y.trans?a._promise(t,p,s):Qt(function(){return a._promise(t,p,s)},{trans:a,transless:Y.transless||Y}):function A(E,v,I,b){if(E.idbdb&&(E._state.openComplete||Y.letThrough||E._vip)){var x=E._createTransaction(v,I,E._dbSchema);try{x.create(),E._state.PR1398_maxLoop=3}catch(T){return T.name===Ks.InvalidState&&E.isOpen()&&0<--E._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),E.close({disableAutoOpen:!1}),E.open().then(function(){return A(E,v,I,b)})):fe(T)}return x._promise(v,function(T,k){return Qt(function(){return Y.trans=x,b(T,k,x)})}).then(function(T){if(v==="readwrite")try{x.idbtrans.commit()}catch{}return v==="readonly"?T:x._completion.then(function(){return T})})}if(E._state.openComplete)return fe(new Z.DatabaseClosed(E._state.dbOpenError));if(!E._state.isBeingOpened){if(!E._state.autoOpen)return fe(new Z.DatabaseClosed);E.open().catch(ie)}return E._state.dbReadyPromise.then(function(){return A(E,v,I,b)})}(this.db,t,[this.name],p);return d&&(w._consoleTask=d,w=w.catch(function(A){return console.trace(A),fe(A)})),w}finally{m&&Zn()}},le.prototype.get=function(t,n){var s=this;return t&&t.constructor===Object?this.where(t).first(n):t==null?fe(new Z.Type("Invalid argument to Table.get()")):this._trans("readonly",function(a){return s.core.get({trans:a,key:t}).then(function(l){return s.hook.reading.fire(l)})}).then(n)},le.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(y(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var n=f(t);if(n.length===1)return this.where(n[0]).equals(t[n[0]]);var s=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&n.every(function(A){return 0<=m.keyPath.indexOf(A)})){for(var w=0;w<n.length;++w)if(n.indexOf(m.keyPath[w])===-1)return!1;return!0}return!1}).sort(function(m,w){return m.keyPath.length-w.keyPath.length})[0];if(s&&this.db._maxKey!==Mn){var d=s.keyPath.slice(0,n.length);return this.where(d).equals(d.map(function(w){return t[w]}))}!s&&wt&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(n.join("+"),"]"));var a=this.schema.idxByName;function l(m,w){return ee(m,w)===0}var p=n.reduce(function(v,w){var A=v[0],E=v[1],v=a[w],I=t[w];return[A||v,A||!v?xn(E,v&&v.multi?function(b){return b=qe(b,w),y(b)&&b.some(function(x){return l(I,x)})}:function(b){return l(I,qe(b,w))}):E]},[null,null]),d=p[0],p=p[1];return d?this.where(d.name).equals(t[d.keyPath]).filter(p):s?this.filter(p):this.where(n).equals("")},le.prototype.filter=function(t){return this.toCollection().and(t)},le.prototype.count=function(t){return this.toCollection().count(t)},le.prototype.offset=function(t){return this.toCollection().offset(t)},le.prototype.limit=function(t){return this.toCollection().limit(t)},le.prototype.each=function(t){return this.toCollection().each(t)},le.prototype.toArray=function(t){return this.toCollection().toArray(t)},le.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},le.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,y(t)?"[".concat(t.join("+"),"]"):t))},le.prototype.reverse=function(){return this.toCollection().reverse()},le.prototype.mapToClass=function(t){var n,s=this.db,a=this.name;function l(){return n!==null&&n.apply(this,arguments)||this}(this.schema.mappedClass=t).prototype instanceof da&&(function(w,A){if(typeof A!="function"&&A!==null)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");function E(){this.constructor=w}r(w,A),w.prototype=A===null?Object.create(A):(E.prototype=A.prototype,new E)}(l,n=t),Object.defineProperty(l.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),l.prototype.table=function(){return a},t=l);for(var d=new Set,p=t.prototype;p;p=S(p))Object.getOwnPropertyNames(p).forEach(function(w){return d.add(w)});function m(w){if(!w)return w;var A,E=Object.create(t.prototype);for(A in w)if(!d.has(A))try{E[A]=w[A]}catch{}return E}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=m,this.hook("reading",m),t},le.prototype.defineClass=function(){return this.mapToClass(function(t){P(this,t)})},le.prototype.add=function(t,n){var s=this,a=this.schema.primKey,l=a.auto,d=a.keyPath,p=t;return d&&l&&(p=Ki(d)(t)),this._trans("readwrite",function(m){return s.core.mutate({trans:m,type:"add",keys:n!=null?[n]:null,values:[p]})}).then(function(m){return m.numFailures?z.reject(m.failures[0]):m.lastResult}).then(function(m){if(d)try{Ye(t,d,m)}catch{}return m})},le.prototype.update=function(t,n){return typeof t!="object"||y(t)?this.where(":id").equals(t).modify(n):(t=qe(t,this.schema.primKey.keyPath),t===void 0?fe(new Z.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(t).modify(n))},le.prototype.put=function(t,n){var s=this,a=this.schema.primKey,l=a.auto,d=a.keyPath,p=t;return d&&l&&(p=Ki(d)(t)),this._trans("readwrite",function(m){return s.core.mutate({trans:m,type:"put",values:[p],keys:n!=null?[n]:null})}).then(function(m){return m.numFailures?z.reject(m.failures[0]):m.lastResult}).then(function(m){if(d)try{Ye(t,d,m)}catch{}return m})},le.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"delete",keys:[t]})}).then(function(s){return s.numFailures?z.reject(s.failures[0]):void 0})},le.prototype.clear=function(){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"deleteRange",range:ha})}).then(function(n){return n.numFailures?z.reject(n.failures[0]):void 0})},le.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(s){return n.core.getMany({keys:t,trans:s}).then(function(a){return a.map(function(l){return n.hook.reading.fire(l)})})})},le.prototype.bulkAdd=function(t,n,s){var a=this,l=Array.isArray(n)?n:void 0,d=(s=s||(l?void 0:n))?s.allKeys:void 0;return this._trans("readwrite",function(p){var A=a.schema.primKey,m=A.auto,A=A.keyPath;if(A&&l)throw new Z.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(l&&l.length!==t.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var w=t.length,A=A&&m?t.map(Ki(A)):t;return a.core.mutate({trans:p,type:"add",keys:l,values:A,wantResults:d}).then(function(x){var v=x.numFailures,I=x.results,b=x.lastResult,x=x.failures;if(v===0)return d?I:b;throw new Gn("".concat(a.name,".bulkAdd(): ").concat(v," of ").concat(w," operations failed"),x)})})},le.prototype.bulkPut=function(t,n,s){var a=this,l=Array.isArray(n)?n:void 0,d=(s=s||(l?void 0:n))?s.allKeys:void 0;return this._trans("readwrite",function(p){var A=a.schema.primKey,m=A.auto,A=A.keyPath;if(A&&l)throw new Z.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(l&&l.length!==t.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var w=t.length,A=A&&m?t.map(Ki(A)):t;return a.core.mutate({trans:p,type:"put",keys:l,values:A,wantResults:d}).then(function(x){var v=x.numFailures,I=x.results,b=x.lastResult,x=x.failures;if(v===0)return d?I:b;throw new Gn("".concat(a.name,".bulkPut(): ").concat(v," of ").concat(w," operations failed"),x)})})},le.prototype.bulkUpdate=function(t){var n=this,s=this.core,a=t.map(function(p){return p.key}),l=t.map(function(p){return p.changes}),d=[];return this._trans("readwrite",function(p){return s.getMany({trans:p,keys:a,cache:"clone"}).then(function(m){var w=[],A=[];t.forEach(function(v,I){var b=v.key,x=v.changes,T=m[I];if(T){for(var k=0,D=Object.keys(x);k<D.length;k++){var O=D[k],C=x[O];if(O===n.schema.primKey.keyPath){if(ee(C,b)!==0)throw new Z.Constraint("Cannot update primary key in bulkUpdate()")}else Ye(T,O,C)}d.push(I),w.push(b),A.push(T)}});var E=w.length;return s.mutate({trans:p,type:"put",keys:w,values:A,updates:{keys:a,changeSpecs:l}}).then(function(v){var I=v.numFailures,b=v.failures;if(I===0)return E;for(var x=0,T=Object.keys(b);x<T.length;x++){var k,D=T[x],O=d[Number(D)];O!=null&&(k=b[D],delete b[D],b[O]=k)}throw new Gn("".concat(n.name,".bulkUpdate(): ").concat(I," of ").concat(E," operations failed"),b)})})})},le.prototype.bulkDelete=function(t){var n=this,s=t.length;return this._trans("readwrite",function(a){return n.core.mutate({trans:a,type:"delete",keys:t})}).then(function(p){var l=p.numFailures,d=p.lastResult,p=p.failures;if(l===0)return d;throw new Gn("".concat(n.name,".bulkDelete(): ").concat(l," of ").concat(s," operations failed"),p)})},le);function le(){}function Vr(t){function n(p,m){if(m){for(var w=arguments.length,A=new Array(w-1);--w;)A[w-1]=arguments[w];return s[p].subscribe.apply(null,A),t}if(typeof p=="string")return s[p]}var s={};n.addEventType=d;for(var a=1,l=arguments.length;a<l;++a)d(arguments[a]);return n;function d(p,m,w){if(typeof p!="object"){var A;m=m||Ju;var E={subscribers:[],fire:w=w||ie,subscribe:function(v){E.subscribers.indexOf(v)===-1&&(E.subscribers.push(v),E.fire=m(E.fire,v))},unsubscribe:function(v){E.subscribers=E.subscribers.filter(function(I){return I!==v}),E.fire=E.subscribers.reduce(m,w)}};return s[p]=n[p]=E}f(A=p).forEach(function(v){var I=A[v];if(y(I))d(v,A[v][0],A[v][1]);else{if(I!=="asap")throw new Z.InvalidArgument("Invalid event config");var b=d(v,Cr,function(){for(var x=arguments.length,T=new Array(x);x--;)T[x]=arguments[x];b.subscribers.forEach(function(k){dt(function(){k.apply(null,T)})})})}})}}function Kr(t,n){return ce(n).from({prototype:t}),n}function Jn(t,n){return!(t.filter||t.algorithm||t.or)&&(n?t.justLimit:!t.replayFilter)}function Xs(t,n){t.filter=xn(t.filter,n)}function Js(t,n,s){var a=t.replayFilter;t.replayFilter=a?function(){return xn(a(),n())}:n,t.justLimit=s&&!a}function Wi(t,n){if(t.isPrimKey)return n.primaryKey;var s=n.getIndexByKeyPath(t.index);if(!s)throw new Z.Schema("KeyPath "+t.index+" on object store "+n.name+" is not indexed");return s}function ga(t,n,s){var a=Wi(t,n.schema);return n.openCursor({trans:s,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:a,range:t.range}})}function qi(t,n,s,a){var l=t.replayFilter?xn(t.filter,t.replayFilter()):t.filter;if(t.or){var d={},p=function(m,w,A){var E,v;l&&!l(w,A,function(I){return w.stop(I)},function(I){return w.fail(I)})||((v=""+(E=w.primaryKey))=="[object ArrayBuffer]"&&(v=""+new Uint8Array(E)),N(d,v)||(d[v]=!0,n(m,w,A)))};return Promise.all([t.or._iterate(p,s),va(ga(t,a,s),t.algorithm,p,!t.keysOnly&&t.valueMapper)])}return va(ga(t,a,s),xn(t.algorithm,l),n,!t.keysOnly&&t.valueMapper)}function va(t,n,s,a){var l=he(a?function(d,p,m){return s(a(d),p,m)}:s);return t.then(function(d){if(d)return d.start(function(){var p=function(){return d.continue()};n&&!n(d,function(m){return p=m},function(m){d.stop(m),p=ie},function(m){d.fail(m),p=ie})||l(d.value,d,function(m){return p=m}),p()})})}var Wr=(ya.prototype.execute=function(t){var n=this["@@propmod"];if(n.add!==void 0){var s=n.add;if(y(s))return h(h([],y(t)?t:[],!0),s).sort();if(typeof s=="number")return(Number(t)||0)+s;if(typeof s=="bigint")try{return BigInt(t)+s}catch{return BigInt(0)+s}throw new TypeError("Invalid term ".concat(s))}if(n.remove!==void 0){var a=n.remove;if(y(a))return y(t)?t.filter(function(l){return!a.includes(l)}).sort():[];if(typeof a=="number")return Number(t)-a;if(typeof a=="bigint")try{return BigInt(t)-a}catch{return BigInt(0)-a}throw new TypeError("Invalid subtrahend ".concat(a))}return s=(s=n.replacePrefix)===null||s===void 0?void 0:s[0],s&&typeof t=="string"&&t.startsWith(s)?n.replacePrefix[1]+t.substring(s.length):t},ya);function ya(t){this["@@propmod"]=t}var rl=(ne.prototype._read=function(t,n){var s=this._ctx;return s.error?s.table._trans(null,fe.bind(null,s.error)):s.table._trans("readonly",t).then(n)},ne.prototype._write=function(t){var n=this._ctx;return n.error?n.table._trans(null,fe.bind(null,n.error)):n.table._trans("readwrite",t,"locked")},ne.prototype._addAlgorithm=function(t){var n=this._ctx;n.algorithm=xn(n.algorithm,t)},ne.prototype._iterate=function(t,n){return qi(this._ctx,t,n,this._ctx.table.core)},ne.prototype.clone=function(t){var n=Object.create(this.constructor.prototype),s=Object.create(this._ctx);return t&&P(s,t),n._ctx=s,n},ne.prototype.raw=function(){return this._ctx.valueMapper=null,this},ne.prototype.each=function(t){var n=this._ctx;return this._read(function(s){return qi(n,t,s,n.table.core)})},ne.prototype.count=function(t){var n=this;return this._read(function(s){var a=n._ctx,l=a.table.core;if(Jn(a,!0))return l.count({trans:s,query:{index:Wi(a,l.schema),range:a.range}}).then(function(p){return Math.min(p,a.limit)});var d=0;return qi(a,function(){return++d,!1},s,l).then(function(){return d})}).then(t)},ne.prototype.sortBy=function(t,n){var s=t.split(".").reverse(),a=s[0],l=s.length-1;function d(w,A){return A?d(w[s[A]],A-1):w[a]}var p=this._ctx.dir==="next"?1:-1;function m(w,A){return ee(d(w,l),d(A,l))*p}return this.toArray(function(w){return w.sort(m)}).then(n)},ne.prototype.toArray=function(t){var n=this;return this._read(function(s){var a=n._ctx;if(a.dir==="next"&&Jn(a,!0)&&0<a.limit){var l=a.valueMapper,d=Wi(a,a.table.core.schema);return a.table.core.query({trans:s,limit:a.limit,values:!0,query:{index:d,range:a.range}}).then(function(m){return m=m.result,l?m.map(l):m})}var p=[];return qi(a,function(m){return p.push(m)},s,a.table.core).then(function(){return p})},t)},ne.prototype.offset=function(t){var n=this._ctx;return t<=0||(n.offset+=t,Jn(n)?Js(n,function(){var s=t;return function(a,l){return s===0||(s===1?--s:l(function(){a.advance(s),s=0}),!1)}}):Js(n,function(){var s=t;return function(){return--s<0}})),this},ne.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),Js(this._ctx,function(){var n=t;return function(s,a,l){return--n<=0&&a(l),0<=n}},!0),this},ne.prototype.until=function(t,n){return Xs(this._ctx,function(s,a,l){return!t(s.value)||(a(l),n)}),this},ne.prototype.first=function(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)},ne.prototype.last=function(t){return this.reverse().first(t)},ne.prototype.filter=function(t){var n;return Xs(this._ctx,function(s){return t(s.value)}),(n=this._ctx).isMatch=xn(n.isMatch,t),this},ne.prototype.and=function(t){return this.filter(t)},ne.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},ne.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ne.prototype.desc=function(){return this.reverse()},ne.prototype.eachKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(s,a){t(a.key,a)})},ne.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},ne.prototype.eachPrimaryKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(s,a){t(a.primaryKey,a)})},ne.prototype.keys=function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var s=[];return this.each(function(a,l){s.push(l.key)}).then(function(){return s}).then(t)},ne.prototype.primaryKeys=function(t){var n=this._ctx;if(n.dir==="next"&&Jn(n,!0)&&0<n.limit)return this._read(function(a){var l=Wi(n,n.table.core.schema);return n.table.core.query({trans:a,values:!1,limit:n.limit,query:{index:l,range:n.range}})}).then(function(a){return a.result}).then(t);n.keysOnly=!n.isMatch;var s=[];return this.each(function(a,l){s.push(l.primaryKey)}).then(function(){return s}).then(t)},ne.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},ne.prototype.firstKey=function(t){return this.limit(1).keys(function(n){return n[0]}).then(t)},ne.prototype.lastKey=function(t){return this.reverse().firstKey(t)},ne.prototype.distinct=function(){var t=this._ctx,t=t.index&&t.table.schema.idxByName[t.index];if(!t||!t.multi)return this;var n={};return Xs(this._ctx,function(l){var a=l.primaryKey.toString(),l=N(n,a);return n[a]=!0,!l}),this},ne.prototype.modify=function(t){var n=this,s=this._ctx;return this._write(function(a){var l,d,p;p=typeof t=="function"?t:(l=f(t),d=l.length,function(k){for(var D=!1,O=0;O<d;++O){var C=l[O],R=t[C],B=qe(k,C);R instanceof Wr?(Ye(k,C,R.execute(B)),D=!0):B!==R&&(Ye(k,C,R),D=!0)}return D});var m=s.table.core,v=m.schema.primaryKey,w=v.outbound,A=v.extractKey,E=200,v=n.db._options.modifyChunkSize;v&&(E=typeof v=="object"?v[m.name]||v["*"]||200:v);function I(k,C){var O=C.failures,C=C.numFailures;x+=k-C;for(var R=0,B=f(O);R<B.length;R++){var L=B[R];b.push(O[L])}}var b=[],x=0,T=[];return n.clone().primaryKeys().then(function(k){function D(C){var R=Math.min(E,k.length-C);return m.getMany({trans:a,keys:k.slice(C,C+R),cache:"immutable"}).then(function(B){for(var L=[],V=[],W=w?[]:null,Q=[],j=0;j<R;++j){var G=B[j],J={value:gn(G),primKey:k[C+j]};p.call(J,J.value,J)!==!1&&(J.value==null?Q.push(k[C+j]):w||ee(A(G),A(J.value))===0?(V.push(J.value),w&&W.push(k[C+j])):(Q.push(k[C+j]),L.push(J.value)))}return Promise.resolve(0<L.length&&m.mutate({trans:a,type:"add",values:L}).then(function(_){for(var $ in _.failures)Q.splice(parseInt($),1);I(L.length,_)})).then(function(){return(0<V.length||O&&typeof t=="object")&&m.mutate({trans:a,type:"put",keys:W,values:V,criteria:O,changeSpec:typeof t!="function"&&t,isAdditionalChunk:0<C}).then(function(_){return I(V.length,_)})}).then(function(){return(0<Q.length||O&&t===_s)&&m.mutate({trans:a,type:"delete",keys:Q,criteria:O,isAdditionalChunk:0<C}).then(function(_){return I(Q.length,_)})}).then(function(){return k.length>C+R&&D(C+E)})})}var O=Jn(s)&&s.limit===1/0&&(typeof t!="function"||t===_s)&&{index:s.index,range:s.range};return D(0).then(function(){if(0<b.length)throw new Ti("Error modifying one or more objects",b,x,T);return k.length})})})},ne.prototype.delete=function(){var t=this._ctx,n=t.range;return Jn(t)&&(t.isPrimKey||n.type===3)?this._write(function(s){var a=t.table.core.schema.primaryKey,l=n;return t.table.core.count({trans:s,query:{index:a,range:l}}).then(function(d){return t.table.core.mutate({trans:s,type:"deleteRange",range:l}).then(function(p){var m=p.failures;if(p.lastResult,p.results,p=p.numFailures,p)throw new Ti("Could not delete some values",Object.keys(m).map(function(w){return m[w]}),d-p);return d-p})})}):this.modify(_s)},ne);function ne(){}var _s=function(t,n){return n.value=null};function il(t,n){return t<n?-1:t===n?0:1}function sl(t,n){return n<t?-1:t===n?0:1}function Ze(t,n,s){return t=t instanceof ba?new t.Collection(t):t,t._ctx.error=new(s||TypeError)(n),t}function _n(t){return new t.Collection(t,function(){return wa("")}).limit(0)}function ji(t,n,s,a){var l,d,p,m,w,A,E,v=s.length;if(!s.every(function(x){return typeof x=="string"}))return Ze(t,ca);function I(x){l=x==="next"?function(k){return k.toUpperCase()}:function(k){return k.toLowerCase()},d=x==="next"?function(k){return k.toLowerCase()}:function(k){return k.toUpperCase()},p=x==="next"?il:sl;var T=s.map(function(k){return{lower:d(k),upper:l(k)}}).sort(function(k,D){return p(k.lower,D.lower)});m=T.map(function(k){return k.upper}),w=T.map(function(k){return k.lower}),E=(A=x)==="next"?"":a}I("next"),t=new t.Collection(t,function(){return Gt(m[0],w[v-1]+a)}),t._ondirectionchange=function(x){I(x)};var b=0;return t._addAlgorithm(function(x,T,k){var D=x.key;if(typeof D!="string")return!1;var O=d(D);if(n(O,w,b))return!0;for(var C=null,R=b;R<v;++R){var B=function(L,V,W,Q,j,G){for(var J=Math.min(L.length,Q.length),_=-1,$=0;$<J;++$){var He=V[$];if(He!==Q[$])return j(L[$],W[$])<0?L.substr(0,$)+W[$]+W.substr($+1):j(L[$],Q[$])<0?L.substr(0,$)+Q[$]+W.substr($+1):0<=_?L.substr(0,_)+V[_]+W.substr(_+1):null;j(L[$],He)<0&&(_=$)}return J<Q.length&&G==="next"?L+W.substr(L.length):J<L.length&&G==="prev"?L.substr(0,W.length):_<0?null:L.substr(0,_)+Q[_]+W.substr(_+1)}(D,O,m[R],w[R],p,A);B===null&&C===null?b=R+1:(C===null||0<p(C,B))&&(C=B)}return T(C!==null?function(){x.continue(C+E)}:k),!1}),t}function Gt(t,n,s,a){return{type:2,lower:t,upper:n,lowerOpen:s,upperOpen:a}}function wa(t){return{type:1,lower:t,upper:t}}var ba=(Object.defineProperty(we.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),we.prototype.between=function(t,n,s,a){s=s!==!1,a=a===!0;try{return 0<this._cmp(t,n)||this._cmp(t,n)===0&&(s||a)&&(!s||!a)?_n(this):new this.Collection(this,function(){return Gt(t,n,!s,!a)})}catch{return Ze(this,Ft)}},we.prototype.equals=function(t){return t==null?Ze(this,Ft):new this.Collection(this,function(){return wa(t)})},we.prototype.above=function(t){return t==null?Ze(this,Ft):new this.Collection(this,function(){return Gt(t,void 0,!0)})},we.prototype.aboveOrEqual=function(t){return t==null?Ze(this,Ft):new this.Collection(this,function(){return Gt(t,void 0,!1)})},we.prototype.below=function(t){return t==null?Ze(this,Ft):new this.Collection(this,function(){return Gt(void 0,t,!1,!0)})},we.prototype.belowOrEqual=function(t){return t==null?Ze(this,Ft):new this.Collection(this,function(){return Gt(void 0,t)})},we.prototype.startsWith=function(t){return typeof t!="string"?Ze(this,ca):this.between(t,t+Mn,!0,!0)},we.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):ji(this,function(n,s){return n.indexOf(s[0])===0},[t],Mn)},we.prototype.equalsIgnoreCase=function(t){return ji(this,function(n,s){return n===s[0]},[t],"")},we.prototype.anyOfIgnoreCase=function(){var t=Rt.apply(Un,arguments);return t.length===0?_n(this):ji(this,function(n,s){return s.indexOf(n)!==-1},t,"")},we.prototype.startsWithAnyOfIgnoreCase=function(){var t=Rt.apply(Un,arguments);return t.length===0?_n(this):ji(this,function(n,s){return s.some(function(a){return n.indexOf(a)===0})},t,Mn)},we.prototype.anyOf=function(){var t=this,n=Rt.apply(Un,arguments),s=this._cmp;try{n.sort(s)}catch{return Ze(this,Ft)}if(n.length===0)return _n(this);var a=new this.Collection(this,function(){return Gt(n[0],n[n.length-1])});a._ondirectionchange=function(d){s=d==="next"?t._ascending:t._descending,n.sort(s)};var l=0;return a._addAlgorithm(function(d,p,m){for(var w=d.key;0<s(w,n[l]);)if(++l===n.length)return p(m),!1;return s(w,n[l])===0||(p(function(){d.continue(n[l])}),!1)}),a},we.prototype.notEqual=function(t){return this.inAnyRange([[-1/0,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},we.prototype.noneOf=function(){var t=Rt.apply(Un,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return Ze(this,Ft)}var n=t.reduce(function(s,a){return s?s.concat([[s[s.length-1][1],a]]):[[-1/0,a]]},null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},we.prototype.inAnyRange=function(D,n){var s=this,a=this._cmp,l=this._ascending,d=this._descending,p=this._min,m=this._max;if(D.length===0)return _n(this);if(!D.every(function(O){return O[0]!==void 0&&O[1]!==void 0&&l(O[0],O[1])<=0}))return Ze(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Z.InvalidArgument);var w=!n||n.includeLowers!==!1,A=n&&n.includeUppers===!0,E,v=l;function I(O,C){return v(O[0],C[0])}try{(E=D.reduce(function(O,C){for(var R=0,B=O.length;R<B;++R){var L=O[R];if(a(C[0],L[1])<0&&0<a(C[1],L[0])){L[0]=p(L[0],C[0]),L[1]=m(L[1],C[1]);break}}return R===B&&O.push(C),O},[])).sort(I)}catch{return Ze(this,Ft)}var b=0,x=A?function(O){return 0<l(O,E[b][1])}:function(O){return 0<=l(O,E[b][1])},T=w?function(O){return 0<d(O,E[b][0])}:function(O){return 0<=d(O,E[b][0])},k=x,D=new this.Collection(this,function(){return Gt(E[0][0],E[E.length-1][1],!w,!A)});return D._ondirectionchange=function(O){v=O==="next"?(k=x,l):(k=T,d),E.sort(I)},D._addAlgorithm(function(O,C,R){for(var B,L=O.key;k(L);)if(++b===E.length)return C(R),!1;return!x(B=L)&&!T(B)||(s._cmp(L,E[b][1])===0||s._cmp(L,E[b][0])===0||C(function(){v===l?O.continue(E[b][0]):O.continue(E[b][1])}),!1)}),D},we.prototype.startsWithAnyOf=function(){var t=Rt.apply(Un,arguments);return t.every(function(n){return typeof n=="string"})?t.length===0?_n(this):this.inAnyRange(t.map(function(n){return[n,n+Mn]})):Ze(this,"startsWithAnyOf() only works with strings")},we);function we(){}function bt(t){return he(function(n){return qr(n),t(n.target.error),!1})}function qr(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var jr="storagemutated",$s="x-storagemutated-1",Yt=Vr(null,jr),ol=(At.prototype._lock=function(){return ue(!Y.global),++this._reculock,this._reculock!==1||Y.global||(Y.lockOwnerFor=this),this},At.prototype._unlock=function(){if(ue(!Y.global),--this._reculock==0)for(Y.global||(Y.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var t=this._blockedFuncs.shift();try{kn(t[1],t[0])}catch{}}return this},At.prototype._locked=function(){return this._reculock&&Y.lockOwnerFor!==this},At.prototype.create=function(t){var n=this;if(!this.mode)return this;var s=this.db.idbdb,a=this.db._state.dbOpenError;if(ue(!this.idbtrans),!t&&!s)switch(a&&a.name){case"DatabaseClosedError":throw new Z.DatabaseClosed(a);case"MissingAPIError":throw new Z.MissingAPI(a.message,a);default:throw new Z.OpenFailed(a)}if(!this.active)throw new Z.TransactionInactive;return ue(this._completion._state===null),(t=this.idbtrans=t||(this.db.core||s).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=he(function(l){qr(l),n._reject(t.error)}),t.onabort=he(function(l){qr(l),n.active&&n._reject(new Z.Abort(t.error)),n.active=!1,n.on("abort").fire(l)}),t.oncomplete=he(function(){n.active=!1,n._resolve(),"mutatedParts"in t&&Yt.storagemutated.fire(t.mutatedParts)}),this},At.prototype._promise=function(t,n,s){var a=this;if(t==="readwrite"&&this.mode!=="readwrite")return fe(new Z.ReadOnly("Transaction is readonly"));if(!this.active)return fe(new Z.TransactionInactive);if(this._locked())return new z(function(d,p){a._blockedFuncs.push([function(){a._promise(t,n,s).then(d,p)},Y])});if(s)return Qt(function(){var d=new z(function(p,m){a._lock();var w=n(p,m,a);w&&w.then&&w.then(p,m)});return d.finally(function(){return a._unlock()}),d._lib=!0,d});var l=new z(function(d,p){var m=n(d,p,a);m&&m.then&&m.then(d,p)});return l._lib=!0,l},At.prototype._root=function(){return this.parent?this.parent._root():this},At.prototype.waitFor=function(t){var n,s=this._root(),a=z.resolve(t);s._waitingFor?s._waitingFor=s._waitingFor.then(function(){return a}):(s._waitingFor=a,s._waitingQueue=[],n=s.idbtrans.objectStore(s.storeNames[0]),function d(){for(++s._spinCount;s._waitingQueue.length;)s._waitingQueue.shift()();s._waitingFor&&(n.get(-1/0).onsuccess=d)}());var l=s._waitingFor;return new z(function(d,p){a.then(function(m){return s._waitingQueue.push(he(d.bind(null,m)))},function(m){return s._waitingQueue.push(he(p.bind(null,m)))}).finally(function(){s._waitingFor===l&&(s._waitingFor=null)})})},At.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Z.Abort))},At.prototype.table=function(t){var n=this._memoizedTables||(this._memoizedTables={});if(N(n,t))return n[t];var s=this.schema[t];if(!s)throw new Z.NotFound("Table "+t+" not part of transaction");return s=new this.db.Table(t,s,this),s.core=this.db.core.table(t),n[t]=s},At);function At(){}function eo(t,n,s,a,l,d,p){return{name:t,keyPath:n,unique:s,multi:a,auto:l,compound:d,src:(s&&!p?"&":"")+(a?"*":"")+(l?"++":"")+Aa(n)}}function Aa(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function to(t,n,s){return{name:t,primKey:n,indexes:s,mappedClass:null,idxByName:(a=function(l){return[l.name,l]},s.reduce(function(l,d,p){return p=a(d,p),p&&(l[p[0]]=p[1]),l},{}))};var a}var Lr=function(t){try{return t.only([[]]),Lr=function(){return[[]]},[[]]}catch{return Lr=function(){return Mn},Mn}};function no(t){return t==null?function(){}:typeof t=="string"?(n=t).split(".").length===1?function(s){return s[n]}:function(s){return qe(s,n)}:function(s){return qe(s,t)};var n}function Pa(t){return[].slice.call(t)}var al=0;function Qr(t){return t==null?":id":typeof t=="string"?t:"[".concat(t.join("+"),"]")}function ul(t,n,w){function a(k){if(k.type===3)return null;if(k.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var b=k.lower,x=k.upper,T=k.lowerOpen,k=k.upperOpen;return b===void 0?x===void 0?null:n.upperBound(x,!!k):x===void 0?n.lowerBound(b,!!T):n.bound(b,x,!!T,!!k)}function l(I){var b,x=I.name;return{name:x,schema:I,mutate:function(T){var k=T.trans,D=T.type,O=T.keys,C=T.values,R=T.range;return new Promise(function(B,L){B=he(B);var V=k.objectStore(x),W=V.keyPath==null,Q=D==="put"||D==="add";if(!Q&&D!=="delete"&&D!=="deleteRange")throw new Error("Invalid operation type: "+D);var j,G=(O||C||{length:1}).length;if(O&&C&&O.length!==C.length)throw new Error("Given keys array must have same length as given values array.");if(G===0)return B({numFailures:0,failures:{},results:[],lastResult:void 0});function J(Ne){++He,qr(Ne)}var _=[],$=[],He=0;if(D==="deleteRange"){if(R.type===4)return B({numFailures:He,failures:$,results:[],lastResult:void 0});R.type===3?_.push(j=V.clear()):_.push(j=V.delete(a(R)))}else{var W=Q?W?[C,O]:[C,null]:[O,null],X=W[0],Oe=W[1];if(Q)for(var Ce=0;Ce<G;++Ce)_.push(j=Oe&&Oe[Ce]!==void 0?V[D](X[Ce],Oe[Ce]):V[D](X[Ce])),j.onerror=J;else for(Ce=0;Ce<G;++Ce)_.push(j=V[D](X[Ce])),j.onerror=J}function es(Ne){Ne=Ne.target.result,_.forEach(function(In,Ao){return In.error!=null&&($[Ao]=In.error)}),B({numFailures:He,failures:$,results:D==="delete"?O:_.map(function(In){return In.result}),lastResult:Ne})}j.onerror=function(Ne){J(Ne),es(Ne)},j.onsuccess=es})},getMany:function(T){var k=T.trans,D=T.keys;return new Promise(function(O,C){O=he(O);for(var R,B=k.objectStore(x),L=D.length,V=new Array(L),W=0,Q=0,j=function(_){_=_.target,V[_._pos]=_.result,++Q===W&&O(V)},G=bt(C),J=0;J<L;++J)D[J]!=null&&((R=B.get(D[J]))._pos=J,R.onsuccess=j,R.onerror=G,++W);W===0&&O(V)})},get:function(T){var k=T.trans,D=T.key;return new Promise(function(O,C){O=he(O);var R=k.objectStore(x).get(D);R.onsuccess=function(B){return O(B.target.result)},R.onerror=bt(C)})},query:(b=A,function(T){return new Promise(function(k,D){k=he(k);var O,C,R,W=T.trans,B=T.values,L=T.limit,j=T.query,V=L===1/0?void 0:L,Q=j.index,j=j.range,W=W.objectStore(x),Q=Q.isPrimaryKey?W:W.index(Q.name),j=a(j);if(L===0)return k({result:[]});b?((V=B?Q.getAll(j,V):Q.getAllKeys(j,V)).onsuccess=function(G){return k({result:G.target.result})},V.onerror=bt(D)):(O=0,C=!B&&"openKeyCursor"in Q?Q.openKeyCursor(j):Q.openCursor(j),R=[],C.onsuccess=function(G){var J=C.result;return J?(R.push(B?J.value:J.primaryKey),++O===L?k({result:R}):void J.continue()):k({result:R})},C.onerror=bt(D))})}),openCursor:function(T){var k=T.trans,D=T.values,O=T.query,C=T.reverse,R=T.unique;return new Promise(function(B,L){B=he(B);var Q=O.index,V=O.range,W=k.objectStore(x),W=Q.isPrimaryKey?W:W.index(Q.name),Q=C?R?"prevunique":"prev":R?"nextunique":"next",j=!D&&"openKeyCursor"in W?W.openKeyCursor(a(V),Q):W.openCursor(a(V),Q);j.onerror=bt(L),j.onsuccess=he(function(G){var J,_,$,He,X=j.result;X?(X.___id=++al,X.done=!1,J=X.continue.bind(X),_=(_=X.continuePrimaryKey)&&_.bind(X),$=X.advance.bind(X),He=function(){throw new Error("Cursor not stopped")},X.trans=k,X.stop=X.continue=X.continuePrimaryKey=X.advance=function(){throw new Error("Cursor not started")},X.fail=he(L),X.next=function(){var Oe=this,Ce=1;return this.start(function(){return Ce--?Oe.continue():Oe.stop()}).then(function(){return Oe})},X.start=function(Oe){function Ce(){if(j.result)try{Oe()}catch(Ne){X.fail(Ne)}else X.done=!0,X.start=function(){throw new Error("Cursor behind last entry")},X.stop()}var es=new Promise(function(Ne,In){Ne=he(Ne),j.onerror=bt(In),X.fail=In,X.stop=function(Ao){X.stop=X.continue=X.continuePrimaryKey=X.advance=He,Ne(Ao)}});return j.onsuccess=he(function(Ne){j.onsuccess=Ce,Ce()}),X.continue=J,X.continuePrimaryKey=_,X.advance=$,Ce(),es},B(X)):B(null)},L)})},count:function(T){var k=T.query,D=T.trans,O=k.index,C=k.range;return new Promise(function(R,B){var L=D.objectStore(x),V=O.isPrimaryKey?L:L.index(O.name),L=a(C),V=L?V.count(L):V.count();V.onsuccess=he(function(W){return R(W.target.result)}),V.onerror=bt(B)})}}}var d,p,m,E=(p=w,m=Pa((d=t).objectStoreNames),{schema:{name:d.name,tables:m.map(function(I){return p.objectStore(I)}).map(function(I){var b=I.keyPath,k=I.autoIncrement,x=y(b),T={},k={name:I.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:b==null,compound:x,keyPath:b,autoIncrement:k,unique:!0,extractKey:no(b)},indexes:Pa(I.indexNames).map(function(D){return I.index(D)}).map(function(R){var O=R.name,C=R.unique,B=R.multiEntry,R=R.keyPath,B={name:O,compound:y(R),keyPath:R,unique:C,multiEntry:B,extractKey:no(R)};return T[Qr(R)]=B}),getIndexByKeyPath:function(D){return T[Qr(D)]}};return T[":id"]=k.primaryKey,b!=null&&(T[Qr(b)]=k.primaryKey),k})},hasGetAll:0<m.length&&"getAll"in p.objectStore(m[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),w=E.schema,A=E.hasGetAll,E=w.tables.map(l),v={};return E.forEach(function(I){return v[I.name]=I}),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(I){if(!v[I])throw new Error("Table '".concat(I,"' not found"));return v[I]},MIN_KEY:-1/0,MAX_KEY:Lr(n),schema:w}}function ll(t,n,s,a){var l=s.IDBKeyRange;return s.indexedDB,{dbcore:(a=ul(n,l,a),t.dbcore.reduce(function(d,p){return p=p.create,o(o({},d),p(d))},a))}}function Li(t,a){var s=a.db,a=ll(t._middlewares,s,t._deps,a);t.core=a.dbcore,t.tables.forEach(function(l){var d=l.name;t.core.schema.tables.some(function(p){return p.name===d})&&(l.core=t.core.table(d),t[d]instanceof t.Table&&(t[d].core=l.core))})}function Qi(t,n,s,a){s.forEach(function(l){var d=a[l];n.forEach(function(p){var m=function w(A,E){return de(A,E)||(A=S(A))&&w(A,E)}(p,l);(!m||"value"in m&&m.value===void 0)&&(p===t.Transaction.prototype||p instanceof t.Transaction?H(p,l,{get:function(){return this.table(l)},set:function(w){te(this,l,{value:w,writable:!0,configurable:!0,enumerable:!0})}}):p[l]=new t.Table(l,d))})})}function ro(t,n){n.forEach(function(s){for(var a in s)s[a]instanceof t.Table&&delete s[a]})}function cl(t,n){return t._cfg.version-n._cfg.version}function hl(t,n,s,a){var l=t._dbSchema;s.objectStoreNames.contains("$meta")&&!l.$meta&&(l.$meta=to("$meta",Ma("")[0],[]),t._storeNames.push("$meta"));var d=t._createTransaction("readwrite",t._storeNames,l);d.create(s),d._completion.catch(a);var p=d._reject.bind(d),m=Y.transless||Y;Qt(function(){return Y.trans=d,Y.transless=m,n!==0?(Li(t,s),A=n,((w=d).storeNames.includes("$meta")?w.table("$meta").get("version").then(function(E){return E??A}):z.resolve(A)).then(function(E){return I=E,b=d,x=s,T=[],E=(v=t)._versions,k=v._dbSchema=zi(0,v.idbdb,x),(E=E.filter(function(D){return D._cfg.version>=I})).length!==0?(E.forEach(function(D){T.push(function(){var O=k,C=D._cfg.dbschema;Gi(v,O,x),Gi(v,C,x),k=v._dbSchema=C;var R=io(O,C);R.add.forEach(function(Q){so(x,Q[0],Q[1].primKey,Q[1].indexes)}),R.change.forEach(function(Q){if(Q.recreate)throw new Z.Upgrade("Not yet support for changing primary key");var j=x.objectStore(Q.name);Q.add.forEach(function(G){return Ui(j,G)}),Q.change.forEach(function(G){j.deleteIndex(G.name),Ui(j,G)}),Q.del.forEach(function(G){return j.deleteIndex(G)})});var B=D._cfg.contentUpgrade;if(B&&D._cfg.version>I){Li(v,x),b._memoizedTables={};var L=$o(C);R.del.forEach(function(Q){L[Q]=O[Q]}),ro(v,[v.Transaction.prototype]),Qi(v,[v.Transaction.prototype],f(L),L),b.schema=L;var V,W=Vs(B);return W&&Hn(),R=z.follow(function(){var Q;(V=B(b))&&W&&(Q=Ut.bind(null,null),V.then(Q,Q))}),V&&typeof V.then=="function"?z.resolve(V):R.then(function(){return V})}}),T.push(function(O){var C,R,B=D._cfg.dbschema;C=B,R=O,[].slice.call(R.db.objectStoreNames).forEach(function(L){return C[L]==null&&R.db.deleteObjectStore(L)}),ro(v,[v.Transaction.prototype]),Qi(v,[v.Transaction.prototype],v._storeNames,v._dbSchema),b.schema=v._dbSchema}),T.push(function(O){v.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(v.idbdb.version/10)===D._cfg.version?(v.idbdb.deleteObjectStore("$meta"),delete v._dbSchema.$meta,v._storeNames=v._storeNames.filter(function(C){return C!=="$meta"})):O.objectStore("$meta").put(D._cfg.version,"version"))})}),function D(){return T.length?z.resolve(T.shift()(b.idbtrans)).then(D):z.resolve()}().then(function(){ka(k,x)})):z.resolve();var v,I,b,x,T,k}).catch(p)):(f(l).forEach(function(E){so(s,E,l[E].primKey,l[E].indexes)}),Li(t,s),void z.follow(function(){return t.on.populate.fire(d)}).catch(p));var w,A})}function dl(t,n){ka(t._dbSchema,n),n.db.version%10!=0||n.objectStoreNames.contains("$meta")||n.db.createObjectStore("$meta").add(Math.ceil(n.db.version/10-1),"version");var s=zi(0,t.idbdb,n);Gi(t,t._dbSchema,n);for(var a=0,l=io(s,t._dbSchema).change;a<l.length;a++){var d=function(p){if(p.change.length||p.recreate)return console.warn("Unable to patch indexes of table ".concat(p.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=n.objectStore(p.name);p.add.forEach(function(w){wt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(p.name,".").concat(w.src)),Ui(m,w)})}(l[a]);if(typeof d=="object")return d.value}}function io(t,n){var s,a={del:[],add:[],change:[]};for(s in t)n[s]||a.del.push(s);for(s in n){var l=t[s],d=n[s];if(l){var p={name:s,def:d,recreate:!1,del:[],add:[],change:[]};if(""+(l.primKey.keyPath||"")!=""+(d.primKey.keyPath||"")||l.primKey.auto!==d.primKey.auto)p.recreate=!0,a.change.push(p);else{var m=l.idxByName,w=d.idxByName,A=void 0;for(A in m)w[A]||p.del.push(A);for(A in w){var E=m[A],v=w[A];E?E.src!==v.src&&p.change.push(v):p.add.push(v)}(0<p.del.length||0<p.add.length||0<p.change.length)&&a.change.push(p)}}else a.add.push([s,d])}return a}function so(t,n,s,a){var l=t.db.createObjectStore(n,s.keyPath?{keyPath:s.keyPath,autoIncrement:s.auto}:{autoIncrement:s.auto});return a.forEach(function(d){return Ui(l,d)}),l}function ka(t,n){f(t).forEach(function(s){n.db.objectStoreNames.contains(s)||(wt&&console.debug("Dexie: Creating missing table",s),so(n,s,t[s].primKey,t[s].indexes))})}function Ui(t,n){t.createIndex(n.name,n.keyPath,{unique:n.unique,multiEntry:n.multi})}function zi(t,n,s){var a={};return yt(n.objectStoreNames,0).forEach(function(l){for(var d=s.objectStore(l),p=eo(Aa(A=d.keyPath),A||"",!0,!1,!!d.autoIncrement,A&&typeof A!="string",!0),m=[],w=0;w<d.indexNames.length;++w){var E=d.index(d.indexNames[w]),A=E.keyPath,E=eo(E.name,A,!!E.unique,!!E.multiEntry,!1,A&&typeof A!="string",!1);m.push(E)}a[l]=to(l,p,m)}),a}function Gi(t,n,s){for(var a=s.db.objectStoreNames,l=0;l<a.length;++l){var d=a[l],p=s.objectStore(d);t._hasGetAll="getAll"in p;for(var m=0;m<p.indexNames.length;++m){var w=p.indexNames[m],A=p.index(w).keyPath,E=typeof A=="string"?A:"["+yt(A).join("+")+"]";!n[d]||(A=n[d].idxByName[E])&&(A.name=w,delete n[d].idxByName[E],n[d].idxByName[w]=A)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&u.WorkerGlobalScope&&u instanceof u.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}function Ma(t){return t.split(",").map(function(n,s){var a=(n=n.trim()).replace(/([&*]|\+\+)/g,""),l=/^\[/.test(a)?a.match(/^\[(.*)\]$/)[1].split("+"):a;return eo(a,l||null,/\&/.test(n),/\*/.test(n),/\+\+/.test(n),y(l),s===0)})}var fl=(Yi.prototype._parseStoresSpec=function(t,n){f(t).forEach(function(s){if(t[s]!==null){var a=Ma(t[s]),l=a.shift();if(l.unique=!0,l.multi)throw new Z.Schema("Primary key cannot be multi-valued");a.forEach(function(d){if(d.auto)throw new Z.Schema("Only primary key can be marked as autoIncrement (++)");if(!d.keyPath)throw new Z.Schema("Index must have a name and cannot be an empty string")}),n[s]=to(s,l,a)}})},Yi.prototype.stores=function(s){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?P(this._cfg.storesSource,s):s;var s=n._versions,a={},l={};return s.forEach(function(d){P(a,d._cfg.storesSource),l=d._cfg.dbschema={},d._parseStoresSpec(a,l)}),n._dbSchema=l,ro(n,[n._allTables,n,n.Transaction.prototype]),Qi(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],f(l),l),n._storeNames=f(l),this},Yi.prototype.upgrade=function(t){return this._cfg.contentUpgrade=Ws(this._cfg.contentUpgrade||ie,t),this},Yi);function Yi(){}function oo(t,n){var s=t._dbNamesDB;return s||(s=t._dbNamesDB=new Nt(Vi,{addons:[],indexedDB:t,IDBKeyRange:n})).version(1).stores({dbnames:"name"}),s.table("dbnames")}function ao(t){return t&&typeof t.databases=="function"}function uo(t){return Qt(function(){return Y.letThrough=!0,t()})}function lo(t){return!("from"in t)}var De=function(t,n){if(!this){var s=new De;return t&&"d"in t&&P(s,t),s}P(this,arguments.length?{d:1,from:t,to:1<arguments.length?n:t}:{d:0})};function Ur(t,n,s){var a=ee(n,s);if(!isNaN(a)){if(0<a)throw RangeError();if(lo(t))return P(t,{from:n,to:s,d:1});var l=t.l,a=t.r;if(ee(s,t.from)<0)return l?Ur(l,n,s):t.l={from:n,to:s,d:1,l:null,r:null},Ea(t);if(0<ee(n,t.to))return a?Ur(a,n,s):t.r={from:n,to:s,d:1,l:null,r:null},Ea(t);ee(n,t.from)<0&&(t.from=n,t.l=null,t.d=a?a.d+1:1),0<ee(s,t.to)&&(t.to=s,t.r=null,t.d=t.l?t.l.d+1:1),s=!t.r,l&&!t.l&&zr(t,l),a&&s&&zr(t,a)}}function zr(t,n){lo(n)||function s(a,w){var d=w.from,p=w.to,m=w.l,w=w.r;Ur(a,d,p),m&&s(a,m),w&&s(a,w)}(t,n)}function xa(t,n){var s=Zi(n),a=s.next();if(a.done)return!1;for(var l=a.value,d=Zi(t),p=d.next(l.from),m=p.value;!a.done&&!p.done;){if(ee(m.from,l.to)<=0&&0<=ee(m.to,l.from))return!0;ee(l.from,m.from)<0?l=(a=s.next(m.from)).value:m=(p=d.next(l.from)).value}return!1}function Zi(t){var n=lo(t)?null:{s:0,n:t};return{next:function(s){for(var a=0<arguments.length;n;)switch(n.s){case 0:if(n.s=1,a)for(;n.n.l&&ee(s,n.n.from)<0;)n={up:n,n:n.n.l,s:1};else for(;n.n.l;)n={up:n,n:n.n.l,s:1};case 1:if(n.s=2,!a||ee(s,n.n.to)<=0)return{value:n.n,done:!1};case 2:if(n.n.r){n.s=3,n={up:n,n:n.n.r,s:0};continue}case 3:n=n.up}return{done:!0}}}}function Ea(t){var n,s,a=(((n=t.r)===null||n===void 0?void 0:n.d)||0)-(((s=t.l)===null||s===void 0?void 0:s.d)||0),l=1<a?"r":a<-1?"l":"";l&&(n=l=="r"?"l":"r",s=o({},t),a=t[l],t.from=a.from,t.to=a.to,t[l]=a[l],s[l]=a[n],(t[n]=s).d=Ta(s)),t.d=Ta(t)}function Ta(s){var n=s.r,s=s.l;return(n?s?Math.max(n.d,s.d):n.d:s?s.d:0)+1}function Hi(t,n){return f(n).forEach(function(s){t[s]?zr(t[s],n[s]):t[s]=function a(l){var d,p,m={};for(d in l)N(l,d)&&(p=l[d],m[d]=!p||typeof p!="object"||ta.has(p.constructor)?p:a(p));return m}(n[s])}),t}function co(t,n){return t.all||n.all||Object.keys(t).some(function(s){return n[s]&&xa(n[s],t[s])})}U(De.prototype,((rt={add:function(t){return zr(this,t),this},addKey:function(t){return Ur(this,t,t),this},addKeys:function(t){var n=this;return t.forEach(function(s){return Ur(n,s,s)}),this},hasKey:function(t){var n=Zi(this).next(t).value;return n&&ee(n.from,t)<=0&&0<=ee(n.to,t)}})[Bs]=function(){return Zi(this)},rt));var En={},ho={},fo=!1;function Xi(t){Hi(ho,t),fo||(fo=!0,setTimeout(function(){fo=!1,po(ho,!(ho={}))},0))}function po(t,n){n===void 0&&(n=!1);var s=new Set;if(t.all)for(var a=0,l=Object.values(En);a<l.length;a++)Ia(p=l[a],t,s,n);else for(var d in t){var p,m=/^idb\:\/\/(.*)\/(.*)\//.exec(d);m&&(d=m[1],m=m[2],(p=En["idb://".concat(d,"/").concat(m)])&&Ia(p,t,s,n))}s.forEach(function(w){return w()})}function Ia(t,n,s,a){for(var l=[],d=0,p=Object.entries(t.queries.query);d<p.length;d++){for(var m=p[d],w=m[0],A=[],E=0,v=m[1];E<v.length;E++){var I=v[E];co(n,I.obsSet)?I.subscribers.forEach(function(k){return s.add(k)}):a&&A.push(I)}a&&l.push([w,A])}if(a)for(var b=0,x=l;b<x.length;b++){var T=x[b],w=T[0],A=T[1];t.queries.query[w]=A}}function pl(t){var n=t._state,s=t._deps.indexedDB;if(n.isBeingOpened||t.idbdb)return n.dbReadyPromise.then(function(){return n.dbOpenError?fe(n.dbOpenError):t});n.isBeingOpened=!0,n.dbOpenError=null,n.openComplete=!1;var a=n.openCanceller,l=Math.round(10*t.verno),d=!1;function p(){if(n.openCanceller!==a)throw new Z.DatabaseClosed("db.open() was cancelled")}function m(){return new z(function(I,b){if(p(),!s)throw new Z.MissingAPI;var x=t.name,T=n.autoSchema||!l?s.open(x):s.open(x,l);if(!T)throw new Z.MissingAPI;T.onerror=bt(b),T.onblocked=he(t._fireOnBlocked),T.onupgradeneeded=he(function(k){var D;E=T.transaction,n.autoSchema&&!t._options.allowEmptyDB?(T.onerror=qr,E.abort(),T.result.close(),(D=s.deleteDatabase(x)).onsuccess=D.onerror=he(function(){b(new Z.NoSuchDatabase("Database ".concat(x," doesnt exist")))})):(E.onerror=bt(b),k=k.oldVersion>Math.pow(2,62)?0:k.oldVersion,v=k<1,t.idbdb=T.result,d&&dl(t,E),hl(t,k/10,E,b))},b),T.onsuccess=he(function(){E=null;var k,D,O,C,R,B=t.idbdb=T.result,L=yt(B.objectStoreNames);if(0<L.length)try{var V=B.transaction((C=L).length===1?C[0]:C,"readonly");if(n.autoSchema)D=B,O=V,(k=t).verno=D.version/10,O=k._dbSchema=zi(0,D,O),k._storeNames=yt(D.objectStoreNames,0),Qi(k,[k._allTables],f(O),O);else if(Gi(t,t._dbSchema,V),((R=io(zi(0,(R=t).idbdb,V),R._dbSchema)).add.length||R.change.some(function(W){return W.add.length||W.change.length}))&&!d)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),B.close(),l=B.version+1,d=!0,I(m());Li(t,V)}catch{}Xn.push(t),B.onversionchange=he(function(W){n.vcFired=!0,t.on("versionchange").fire(W)}),B.onclose=he(function(W){t.on("close").fire(W)}),v&&(R=t._deps,V=x,B=R.indexedDB,R=R.IDBKeyRange,ao(B)||V===Vi||oo(B,R).put({name:V}).catch(ie)),I()},b)}).catch(function(I){switch(I==null?void 0:I.name){case"UnknownError":if(0<n.PR1398_maxLoop)return n.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<l)return l=0,m()}return z.reject(I)})}var w,A=n.dbReadyResolve,E=null,v=!1;return z.race([a,(typeof navigator>"u"?z.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(I){function b(){return indexedDB.databases().finally(I)}w=setInterval(b,100),b()}).finally(function(){return clearInterval(w)}):Promise.resolve()).then(m)]).then(function(){return p(),n.onReadyBeingFired=[],z.resolve(uo(function(){return t.on.ready.fire(t.vip)})).then(function I(){if(0<n.onReadyBeingFired.length){var b=n.onReadyBeingFired.reduce(Ws,ie);return n.onReadyBeingFired=[],z.resolve(uo(function(){return b(t.vip)})).then(I)}})}).finally(function(){n.openCanceller===a&&(n.onReadyBeingFired=null,n.isBeingOpened=!1)}).catch(function(I){n.dbOpenError=I;try{E&&E.abort()}catch{}return a===n.openCanceller&&t._close(),fe(I)}).finally(function(){n.openComplete=!0,A()}).then(function(){var I;return v&&(I={},t.tables.forEach(function(b){b.schema.indexes.forEach(function(x){x.name&&(I["idb://".concat(t.name,"/").concat(b.name,"/").concat(x.name)]=new De(-1/0,[[[]]]))}),I["idb://".concat(t.name,"/").concat(b.name,"/")]=I["idb://".concat(t.name,"/").concat(b.name,"/:dels")]=new De(-1/0,[[[]]])}),Yt(jr).fire(I),po(I,!0)),t})}function mo(t){function n(d){return t.next(d)}var s=l(n),a=l(function(d){return t.throw(d)});function l(d){return function(w){var m=d(w),w=m.value;return m.done?w:w&&typeof w.then=="function"?w.then(s,a):y(w)?Promise.all(w).then(s,a):s(w)}}return l(n)()}function Ji(t,n,s){for(var a=y(t)?t.slice():[t],l=0;l<s;++l)a.push(n);return a}var ml={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return o(o({},t),{table:function(n){var s=t.table(n),a=s.schema,l={},d=[];function p(v,I,b){var x=Qr(v),T=l[x]=l[x]||[],k=v==null?0:typeof v=="string"?1:v.length,D=0<I,D=o(o({},b),{name:D?"".concat(x,"(virtual-from:").concat(b.name,")"):b.name,lowLevelIndex:b,isVirtual:D,keyTail:I,keyLength:k,extractKey:no(v),unique:!D&&b.unique});return T.push(D),D.isPrimaryKey||d.push(D),1<k&&p(k===2?v[0]:v.slice(0,k-1),I+1,b),T.sort(function(O,C){return O.keyTail-C.keyTail}),D}n=p(a.primaryKey.keyPath,0,a.primaryKey),l[":id"]=[n];for(var m=0,w=a.indexes;m<w.length;m++){var A=w[m];p(A.keyPath,0,A)}function E(v){var I,b=v.query.index;return b.isVirtual?o(o({},v),{query:{index:b.lowLevelIndex,range:(I=v.query.range,b=b.keyTail,{type:I.type===1?2:I.type,lower:Ji(I.lower,I.lowerOpen?t.MAX_KEY:t.MIN_KEY,b),lowerOpen:!0,upper:Ji(I.upper,I.upperOpen?t.MIN_KEY:t.MAX_KEY,b),upperOpen:!0})}}):v}return o(o({},s),{schema:o(o({},a),{primaryKey:n,indexes:d,getIndexByKeyPath:function(v){return(v=l[Qr(v)])&&v[0]}}),count:function(v){return s.count(E(v))},query:function(v){return s.query(E(v))},openCursor:function(v){var I=v.query.index,b=I.keyTail,x=I.isVirtual,T=I.keyLength;return x?s.openCursor(E(v)).then(function(D){return D&&k(D)}):s.openCursor(v);function k(D){return Object.create(D,{continue:{value:function(O){O!=null?D.continue(Ji(O,v.reverse?t.MAX_KEY:t.MIN_KEY,b)):v.unique?D.continue(D.key.slice(0,T).concat(v.reverse?t.MIN_KEY:t.MAX_KEY,b)):D.continue()}},continuePrimaryKey:{value:function(O,C){D.continuePrimaryKey(Ji(O,t.MAX_KEY,b),C)}},primaryKey:{get:function(){return D.primaryKey}},key:{get:function(){var O=D.key;return T===1?O[0]:O.slice(0,T)}},value:{get:function(){return D.value}}})}}})}})}};function go(t,n,s,a){return s=s||{},a=a||"",f(t).forEach(function(l){var d,p,m;N(n,l)?(d=t[l],p=n[l],typeof d=="object"&&typeof p=="object"&&d&&p?(m=Ns(d))!==Ns(p)?s[a+l]=n[l]:m==="Object"?go(d,p,s,a+l+"."):d!==p&&(s[a+l]=n[l]):d!==p&&(s[a+l]=n[l])):s[a+l]=void 0}),f(n).forEach(function(l){N(t,l)||(s[a+l]=n[l])}),s}function vo(t,n){return n.type==="delete"?n.keys:n.keys||n.values.map(t.extractKey)}var gl={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return o(o({},t),{table:function(n){var s=t.table(n),a=s.schema.primaryKey;return o(o({},s),{mutate:function(l){var d=Y.trans,p=d.table(n).hook,m=p.deleting,w=p.creating,A=p.updating;switch(l.type){case"add":if(w.fire===ie)break;return d._promise("readwrite",function(){return E(l)},!0);case"put":if(w.fire===ie&&A.fire===ie)break;return d._promise("readwrite",function(){return E(l)},!0);case"delete":if(m.fire===ie)break;return d._promise("readwrite",function(){return E(l)},!0);case"deleteRange":if(m.fire===ie)break;return d._promise("readwrite",function(){return function v(I,b,x){return s.query({trans:I,values:!1,query:{index:a,range:b},limit:x}).then(function(T){var k=T.result;return E({type:"delete",keys:k,trans:I}).then(function(D){return 0<D.numFailures?Promise.reject(D.failures[0]):k.length<x?{failures:[],numFailures:0,lastResult:void 0}:v(I,o(o({},b),{lower:k[k.length-1],lowerOpen:!0}),x)})})}(l.trans,l.range,1e4)},!0)}return s.mutate(l);function E(v){var I,b,x,T=Y.trans,k=v.keys||vo(a,v);if(!k)throw new Error("Keys missing");return(v=v.type==="add"||v.type==="put"?o(o({},v),{keys:k}):o({},v)).type!=="delete"&&(v.values=h([],v.values)),v.keys&&(v.keys=h([],v.keys)),I=s,x=k,((b=v).type==="add"?Promise.resolve([]):I.getMany({trans:b.trans,keys:x,cache:"immutable"})).then(function(D){var O=k.map(function(C,R){var B,L,V,W=D[R],Q={onerror:null,onsuccess:null};return v.type==="delete"?m.fire.call(Q,C,W,T):v.type==="add"||W===void 0?(B=w.fire.call(Q,C,v.values[R],T),C==null&&B!=null&&(v.keys[R]=C=B,a.outbound||Ye(v.values[R],a.keyPath,C))):(B=go(W,v.values[R]),(L=A.fire.call(Q,B,C,W,T))&&(V=v.values[R],Object.keys(L).forEach(function(j){N(V,j)?V[j]=L[j]:Ye(V,j,L[j])}))),Q});return s.mutate(v).then(function(C){for(var R=C.failures,B=C.results,L=C.numFailures,C=C.lastResult,V=0;V<k.length;++V){var W=(B||k)[V],Q=O[V];W==null?Q.onerror&&Q.onerror(R[V]):Q.onsuccess&&Q.onsuccess(v.type==="put"&&D[V]?v.values[V]:W)}return{failures:R,results:B,numFailures:L,lastResult:C}}).catch(function(C){return O.forEach(function(R){return R.onerror&&R.onerror(C)}),Promise.reject(C)})})}}})}})}};function Sa(t,n,s){try{if(!n||n.keys.length<t.length)return null;for(var a=[],l=0,d=0;l<n.keys.length&&d<t.length;++l)ee(n.keys[l],t[d])===0&&(a.push(s?gn(n.values[l]):n.values[l]),++d);return a.length===t.length?a:null}catch{return null}}var vl={stack:"dbcore",level:-1,create:function(t){return{table:function(n){var s=t.table(n);return o(o({},s),{getMany:function(a){if(!a.cache)return s.getMany(a);var l=Sa(a.keys,a.trans._cache,a.cache==="clone");return l?z.resolve(l):s.getMany(a).then(function(d){return a.trans._cache={keys:a.keys,values:a.cache==="clone"?gn(d):d},d})},mutate:function(a){return a.type!=="add"&&(a.trans._cache=null),s.mutate(a)}})}}}};function Da(t,n){return t.trans.mode==="readonly"&&!!t.subscr&&!t.trans.explicit&&t.trans.db._options.cache!=="disabled"&&!n.schema.primaryKey.outbound}function Oa(t,n){switch(t){case"query":return n.values&&!n.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var yl={stack:"dbcore",level:0,name:"Observability",create:function(t){var n=t.schema.name,s=new De(t.MIN_KEY,t.MAX_KEY);return o(o({},t),{transaction:function(a,l,d){if(Y.subscr&&l!=="readonly")throw new Z.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Y.querier));return t.transaction(a,l,d)},table:function(a){var l=t.table(a),d=l.schema,p=d.primaryKey,v=d.indexes,m=p.extractKey,w=p.outbound,A=p.autoIncrement&&v.filter(function(b){return b.compound&&b.keyPath.includes(p.keyPath)}),E=o(o({},l),{mutate:function(b){function x(j){return j="idb://".concat(n,"/").concat(a,"/").concat(j),C[j]||(C[j]=new De)}var T,k,D,O=b.trans,C=b.mutatedParts||(b.mutatedParts={}),R=x(""),B=x(":dels"),L=b.type,Q=b.type==="deleteRange"?[b.range]:b.type==="delete"?[b.keys]:b.values.length<50?[vo(p,b).filter(function(j){return j}),b.values]:[],V=Q[0],W=Q[1],Q=b.trans._cache;return y(V)?(R.addKeys(V),(Q=L==="delete"||V.length===W.length?Sa(V,Q):null)||B.addKeys(V),(Q||W)&&(T=x,k=Q,D=W,d.indexes.forEach(function(j){var G=T(j.name||"");function J($){return $!=null?j.extractKey($):null}function _($){return j.multiEntry&&y($)?$.forEach(function(He){return G.addKey(He)}):G.addKey($)}(k||D).forEach(function($,Oe){var X=k&&J(k[Oe]),Oe=D&&J(D[Oe]);ee(X,Oe)!==0&&(X!=null&&_(X),Oe!=null&&_(Oe))})}))):V?(W={from:(W=V.lower)!==null&&W!==void 0?W:t.MIN_KEY,to:(W=V.upper)!==null&&W!==void 0?W:t.MAX_KEY},B.add(W),R.add(W)):(R.add(s),B.add(s),d.indexes.forEach(function(j){return x(j.name).add(s)})),l.mutate(b).then(function(j){return!V||b.type!=="add"&&b.type!=="put"||(R.addKeys(j.results),A&&A.forEach(function(G){for(var J=b.values.map(function(X){return G.extractKey(X)}),_=G.keyPath.findIndex(function(X){return X===p.keyPath}),$=0,He=j.results.length;$<He;++$)J[$][_]=j.results[$];x(G.name).addKeys(J)})),O.mutatedParts=Hi(O.mutatedParts||{},C),j})}}),v=function(x){var T=x.query,x=T.index,T=T.range;return[x,new De((x=T.lower)!==null&&x!==void 0?x:t.MIN_KEY,(T=T.upper)!==null&&T!==void 0?T:t.MAX_KEY)]},I={get:function(b){return[p,new De(b.key)]},getMany:function(b){return[p,new De().addKeys(b.keys)]},count:v,query:v,openCursor:v};return f(I).forEach(function(b){E[b]=function(x){var T=Y.subscr,k=!!T,D=Da(Y,l)&&Oa(b,x)?x.obsSet={}:T;if(k){var O=function(W){return W="idb://".concat(n,"/").concat(a,"/").concat(W),D[W]||(D[W]=new De)},C=O(""),R=O(":dels"),T=I[b](x),k=T[0],T=T[1];if((b==="query"&&k.isPrimaryKey&&!x.values?R:O(k.name||"")).add(T),!k.isPrimaryKey){if(b!=="count"){var B=b==="query"&&w&&x.values&&l.query(o(o({},x),{values:!1}));return l[b].apply(this,arguments).then(function(W){if(b==="query"){if(w&&x.values)return B.then(function(J){return J=J.result,C.addKeys(J),W});var Q=x.values?W.result.map(m):W.result;(x.values?C:R).addKeys(Q)}else if(b==="openCursor"){var j=W,G=x.values;return j&&Object.create(j,{key:{get:function(){return R.addKey(j.primaryKey),j.key}},primaryKey:{get:function(){var J=j.primaryKey;return R.addKey(J),J}},value:{get:function(){return G&&C.addKey(j.primaryKey),j.value}}})}return W})}R.add(s)}}return l[b].apply(this,arguments)}}),E}})}};function Ca(t,n,s){if(s.numFailures===0)return n;if(n.type==="deleteRange")return null;var a=n.keys?n.keys.length:"values"in n&&n.values?n.values.length:1;return s.numFailures===a?null:(n=o({},n),y(n.keys)&&(n.keys=n.keys.filter(function(l,d){return!(d in s.failures)})),"values"in n&&y(n.values)&&(n.values=n.values.filter(function(l,d){return!(d in s.failures)})),n)}function yo(t,n){return s=t,((a=n).lower===void 0||(a.lowerOpen?0<ee(s,a.lower):0<=ee(s,a.lower)))&&(t=t,(n=n).upper===void 0||(n.upperOpen?ee(t,n.upper)<0:ee(t,n.upper)<=0));var s,a}function Ra(t,n,I,a,l,d){if(!I||I.length===0)return t;var p=n.query.index,m=p.multiEntry,w=n.query.range,A=a.schema.primaryKey.extractKey,E=p.extractKey,v=(p.lowLevelIndex||p).extractKey,I=I.reduce(function(b,x){var T=b,k=[];if(x.type==="add"||x.type==="put")for(var D=new De,O=x.values.length-1;0<=O;--O){var C,R=x.values[O],B=A(R);D.hasKey(B)||(C=E(R),(m&&y(C)?C.some(function(j){return yo(j,w)}):yo(C,w))&&(D.addKey(B),k.push(R)))}switch(x.type){case"add":var L=new De().addKeys(n.values?b.map(function(G){return A(G)}):b),T=b.concat(n.values?k.filter(function(G){return G=A(G),!L.hasKey(G)&&(L.addKey(G),!0)}):k.map(function(G){return A(G)}).filter(function(G){return!L.hasKey(G)&&(L.addKey(G),!0)}));break;case"put":var V=new De().addKeys(x.values.map(function(G){return A(G)}));T=b.filter(function(G){return!V.hasKey(n.values?A(G):G)}).concat(n.values?k:k.map(function(G){return A(G)}));break;case"delete":var W=new De().addKeys(x.keys);T=b.filter(function(G){return!W.hasKey(n.values?A(G):G)});break;case"deleteRange":var Q=x.range;T=b.filter(function(G){return!yo(A(G),Q)})}return T},t);return I===t?t:(I.sort(function(b,x){return ee(v(b),v(x))||ee(A(b),A(x))}),n.limit&&n.limit<1/0&&(I.length>n.limit?I.length=n.limit:t.length===n.limit&&I.length<n.limit&&(l.dirty=!0)),d?Object.freeze(I):I)}function Fa(t,n){return ee(t.lower,n.lower)===0&&ee(t.upper,n.upper)===0&&!!t.lowerOpen==!!n.lowerOpen&&!!t.upperOpen==!!n.upperOpen}function wl(t,n){return function(s,a,l,d){if(s===void 0)return a!==void 0?-1:0;if(a===void 0)return 1;if((a=ee(s,a))===0){if(l&&d)return 0;if(l)return 1;if(d)return-1}return a}(t.lower,n.lower,t.lowerOpen,n.lowerOpen)<=0&&0<=function(s,a,l,d){if(s===void 0)return a!==void 0?1:0;if(a===void 0)return-1;if((a=ee(s,a))===0){if(l&&d)return 0;if(l)return-1;if(d)return 1}return a}(t.upper,n.upper,t.upperOpen,n.upperOpen)}function bl(t,n,s,a){t.subscribers.add(s),a.addEventListener("abort",function(){var l,d;t.subscribers.delete(s),t.subscribers.size===0&&(l=t,d=n,setTimeout(function(){l.subscribers.size===0&&vn(d,l)},3e3))})}var Al={stack:"dbcore",level:0,name:"Cache",create:function(t){var n=t.schema.name;return o(o({},t),{transaction:function(s,a,l){var d,p,m=t.transaction(s,a,l);return a==="readwrite"&&(p=(d=new AbortController).signal,l=function(w){return function(){if(d.abort(),a==="readwrite"){for(var A=new Set,E=0,v=s;E<v.length;E++){var I=v[E],b=En["idb://".concat(n,"/").concat(I)];if(b){var x=t.table(I),T=b.optimisticOps.filter(function(G){return G.trans===m});if(m._explicit&&w&&m.mutatedParts)for(var k=0,D=Object.values(b.queries.query);k<D.length;k++)for(var O=0,C=(L=D[k]).slice();O<C.length;O++)co((V=C[O]).obsSet,m.mutatedParts)&&(vn(L,V),V.subscribers.forEach(function(G){return A.add(G)}));else if(0<T.length){b.optimisticOps=b.optimisticOps.filter(function(G){return G.trans!==m});for(var R=0,B=Object.values(b.queries.query);R<B.length;R++)for(var L,V,W,Q=0,j=(L=B[R]).slice();Q<j.length;Q++)(V=j[Q]).res!=null&&m.mutatedParts&&(w&&!V.dirty?(W=Object.isFrozen(V.res),W=Ra(V.res,V.req,T,x,V,W),V.dirty?(vn(L,V),V.subscribers.forEach(function(G){return A.add(G)})):W!==V.res&&(V.res=W,V.promise=z.resolve({result:W}))):(V.dirty&&vn(L,V),V.subscribers.forEach(function(G){return A.add(G)})))}}}A.forEach(function(G){return G()})}}},m.addEventListener("abort",l(!1),{signal:p}),m.addEventListener("error",l(!1),{signal:p}),m.addEventListener("complete",l(!0),{signal:p})),m},table:function(s){var a=t.table(s),l=a.schema.primaryKey;return o(o({},a),{mutate:function(d){var p=Y.trans;if(l.outbound||p.db._options.cache==="disabled"||p.explicit||p.idbtrans.mode!=="readwrite")return a.mutate(d);var m=En["idb://".concat(n,"/").concat(s)];return m?(p=a.mutate(d),d.type!=="add"&&d.type!=="put"||!(50<=d.values.length||vo(l,d).some(function(w){return w==null}))?(m.optimisticOps.push(d),d.mutatedParts&&Xi(d.mutatedParts),p.then(function(w){0<w.numFailures&&(vn(m.optimisticOps,d),(w=Ca(0,d,w))&&m.optimisticOps.push(w),d.mutatedParts&&Xi(d.mutatedParts))}),p.catch(function(){vn(m.optimisticOps,d),d.mutatedParts&&Xi(d.mutatedParts)})):p.then(function(w){var A=Ca(0,o(o({},d),{values:d.values.map(function(E,v){var I;return w.failures[v]||(E=(I=l.keyPath)!==null&&I!==void 0&&I.includes(".")?gn(E):o({},E),Ye(E,l.keyPath,w.results[v])),E})}),w);m.optimisticOps.push(A),queueMicrotask(function(){return d.mutatedParts&&Xi(d.mutatedParts)})}),p):a.mutate(d)},query:function(d){if(!Da(Y,a)||!Oa("query",d))return a.query(d);var p=((A=Y.trans)===null||A===void 0?void 0:A.db._options.cache)==="immutable",v=Y,m=v.requery,w=v.signal,A=function(x,T,k,D){var O=En["idb://".concat(x,"/").concat(T)];if(!O)return[];if(!(T=O.queries[k]))return[null,!1,O,null];var C=T[(D.query?D.query.index.name:null)||""];if(!C)return[null,!1,O,null];switch(k){case"query":var R=C.find(function(B){return B.req.limit===D.limit&&B.req.values===D.values&&Fa(B.req.query.range,D.query.range)});return R?[R,!0,O,C]:[C.find(function(B){return("limit"in B.req?B.req.limit:1/0)>=D.limit&&(!D.values||B.req.values)&&wl(B.req.query.range,D.query.range)}),!1,O,C];case"count":return R=C.find(function(B){return Fa(B.req.query.range,D.query.range)}),[R,!!R,O,C]}}(n,s,"query",d),E=A[0],v=A[1],I=A[2],b=A[3];return E&&v?E.obsSet=d.obsSet:(v=a.query(d).then(function(x){var T=x.result;if(E&&(E.res=T),p){for(var k=0,D=T.length;k<D;++k)Object.freeze(T[k]);Object.freeze(T)}else x.result=gn(T);return x}).catch(function(x){return b&&E&&vn(b,E),Promise.reject(x)}),E={obsSet:d.obsSet,promise:v,subscribers:new Set,type:"query",req:d,dirty:!1},b?b.push(E):(b=[E],(I=I||(En["idb://".concat(n,"/").concat(s)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[d.query.index.name||""]=b)),bl(E,b,m,w),E.promise.then(function(x){return{result:Ra(x.result,d,I==null?void 0:I.optimisticOps,a,E,p)}})}})}})}};function _i(t,n){return new Proxy(t,{get:function(s,a,l){return a==="db"?n:Reflect.get(s,a,l)}})}var Nt=(pe.prototype.version=function(t){if(isNaN(t)||t<.1)throw new Z.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new Z.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=this._versions,s=n.filter(function(a){return a._cfg.version===t})[0];return s||(s=new this.Version(t),n.push(s),n.sort(cl),s.stores({}),this._state.autoSchema=!1,s)},pe.prototype._whenReady=function(t){var n=this;return this.idbdb&&(this._state.openComplete||Y.letThrough||this._vip)?t():new z(function(s,a){if(n._state.openComplete)return a(new Z.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._state.autoOpen)return void a(new Z.DatabaseClosed);n.open().catch(ie)}n._state.dbReadyPromise.then(s,a)}).then(t)},pe.prototype.use=function(t){var n=t.stack,s=t.create,a=t.level,l=t.name;return l&&this.unuse({stack:n,name:l}),t=this._middlewares[n]||(this._middlewares[n]=[]),t.push({stack:n,create:s,level:a??10,name:l}),t.sort(function(d,p){return d.level-p.level}),this},pe.prototype.unuse=function(t){var n=t.stack,s=t.name,a=t.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(l){return a?l.create!==a:!!s&&l.name!==s})),this},pe.prototype.open=function(){var t=this;return kn(Lt,function(){return pl(t)})},pe.prototype._close=function(){var t=this._state,n=Xn.indexOf(this);if(0<=n&&Xn.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new z(function(s){t.dbReadyResolve=s}),t.openCanceller=new z(function(s,a){t.cancelOpen=a}))},pe.prototype.close=function(s){var n=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,s=this._state;n?(s.isBeingOpened&&s.cancelOpen(new Z.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new Z.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},pe.prototype.delete=function(t){var n=this;t===void 0&&(t={disableAutoOpen:!0});var s=0<arguments.length&&typeof arguments[0]!="object",a=this._state;return new z(function(l,d){function p(){n.close(t);var m=n._deps.indexedDB.deleteDatabase(n.name);m.onsuccess=he(function(){var w,A,E;w=n._deps,A=n.name,E=w.indexedDB,w=w.IDBKeyRange,ao(E)||A===Vi||oo(E,w).delete(A).catch(ie),l()}),m.onerror=bt(d),m.onblocked=n._fireOnBlocked}if(s)throw new Z.InvalidArgument("Invalid closeOptions argument to db.delete()");a.isBeingOpened?a.dbReadyPromise.then(p):p()})},pe.prototype.backendDB=function(){return this.idbdb},pe.prototype.isOpen=function(){return this.idbdb!==null},pe.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},pe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},pe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(pe.prototype,"tables",{get:function(){var t=this;return f(this._allTables).map(function(n){return t._allTables[n]})},enumerable:!1,configurable:!0}),pe.prototype.transaction=function(){var t=(function(n,s,a){var l=arguments.length;if(l<2)throw new Z.InvalidArgument("Too few arguments");for(var d=new Array(l-1);--l;)d[l-1]=arguments[l];return a=d.pop(),[n,ea(d),a]}).apply(this,arguments);return this._transaction.apply(this,t)},pe.prototype._transaction=function(t,n,s){var a=this,l=Y.trans;l&&l.db===this&&t.indexOf("!")===-1||(l=null);var d,p,m=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");try{if(p=n.map(function(A){if(A=A instanceof a.Table?A.name:A,typeof A!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return A}),t=="r"||t===Zs)d=Zs;else{if(t!="rw"&&t!=Hs)throw new Z.InvalidArgument("Invalid transaction mode: "+t);d=Hs}if(l){if(l.mode===Zs&&d===Hs){if(!m)throw new Z.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");l=null}l&&p.forEach(function(A){if(l&&l.storeNames.indexOf(A)===-1){if(!m)throw new Z.SubTransaction("Table "+A+" not included in parent transaction.");l=null}}),m&&l&&!l.active&&(l=null)}}catch(A){return l?l._promise(null,function(E,v){v(A)}):fe(A)}var w=(function A(E,v,I,b,x){return z.resolve().then(function(){var T=Y.transless||Y,k=E._createTransaction(v,I,E._dbSchema,b);if(k.explicit=!0,T={trans:k,transless:T},b)k.idbtrans=b.idbtrans;else try{k.create(),k.idbtrans._explicit=!0,E._state.PR1398_maxLoop=3}catch(C){return C.name===Ks.InvalidState&&E.isOpen()&&0<--E._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),E.close({disableAutoOpen:!1}),E.open().then(function(){return A(E,v,I,null,x)})):fe(C)}var D,O=Vs(x);return O&&Hn(),T=z.follow(function(){var C;(D=x.call(k,k))&&(O?(C=Ut.bind(null,null),D.then(C,C)):typeof D.next=="function"&&typeof D.throw=="function"&&(D=mo(D)))},T),(D&&typeof D.then=="function"?z.resolve(D).then(function(C){return k.active?C:fe(new Z.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):T.then(function(){return D})).then(function(C){return b&&k._resolve(),k._completion.then(function(){return C})}).catch(function(C){return k._reject(C),fe(C)})})}).bind(null,this,d,p,l,s);return l?l._promise(d,w,"lock"):Y.trans?kn(Y.transless,function(){return a._whenReady(w)}):this._whenReady(w)},pe.prototype.table=function(t){if(!N(this._allTables,t))throw new Z.InvalidTable("Table ".concat(t," does not exist"));return this._allTables[t]},pe);function pe(t,n){var s=this;this._middlewares={},this.verno=0;var a=pe.dependencies;this._options=n=o({addons:pe.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange},a=n.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var l,d,p,m,w,A={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ie,dbReadyPromise:null,cancelOpen:ie,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};A.dbReadyPromise=new z(function(v){A.dbReadyResolve=v}),A.openCanceller=new z(function(v,I){A.cancelOpen=I}),this._state=A,this.name=t,this.on=Vr(this,"populate","blocked","versionchange","close",{ready:[Ws,ie]}),this.on.ready.subscribe=Ei(this.on.ready.subscribe,function(v){return function(I,b){pe.vip(function(){var x,T=s._state;T.openComplete?(T.dbOpenError||z.resolve().then(I),b&&v(I)):T.onReadyBeingFired?(T.onReadyBeingFired.push(I),b&&v(I)):(v(I),x=s,b||v(function k(){x.on.ready.unsubscribe(I),x.on.ready.unsubscribe(k)}))})}}),this.Collection=(l=this,Kr(rl.prototype,function(D,k){this.db=l;var b=ha,x=null;if(k)try{b=k()}catch(O){x=O}var T=D._ctx,k=T.table,D=k.hook.reading.fire;this._ctx={table:k,index:T.index,isPrimKey:!T.index||k.schema.primKey.keyPath&&T.index===k.schema.primKey.name,range:b,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:x,or:T.or,valueMapper:D!==Cr?D:null}})),this.Table=(d=this,Kr(ma.prototype,function(v,I,b){this.db=d,this._tx=b,this.name=v,this.schema=I,this.hook=d._allTables[v]?d._allTables[v].hook:Vr(null,{creating:[Zu,ie],reading:[Yu,Cr],updating:[Xu,ie],deleting:[Hu,ie]})})),this.Transaction=(p=this,Kr(ol.prototype,function(v,I,b,x,T){var k=this;this.db=p,this.mode=v,this.storeNames=I,this.schema=b,this.chromeTransactionDurability=x,this.idbtrans=null,this.on=Vr(this,"complete","error","abort"),this.parent=T||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new z(function(D,O){k._resolve=D,k._reject=O}),this._completion.then(function(){k.active=!1,k.on.complete.fire()},function(D){var O=k.active;return k.active=!1,k.on.error.fire(D),k.parent?k.parent._reject(D):O&&k.idbtrans&&k.idbtrans.abort(),fe(D)})})),this.Version=(m=this,Kr(fl.prototype,function(v){this.db=m,this._cfg={version:v,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(w=this,Kr(ba.prototype,function(v,I,b){if(this.db=w,this._ctx={table:v,index:I===":id"?null:I,or:b},this._cmp=this._ascending=ee,this._descending=function(x,T){return ee(T,x)},this._max=function(x,T){return 0<ee(x,T)?x:T},this._min=function(x,T){return ee(x,T)<0?x:T},this._IDBKeyRange=w._deps.IDBKeyRange,!this._IDBKeyRange)throw new Z.MissingAPI})),this.on("versionchange",function(v){0<v.newVersion?console.warn("Another connection wants to upgrade database '".concat(s.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(s.name,"'. Closing db now to resume the delete request.")),s.close({disableAutoOpen:!1})}),this.on("blocked",function(v){!v.newVersion||v.newVersion<v.oldVersion?console.warn("Dexie.delete('".concat(s.name,"') was blocked")):console.warn("Upgrade '".concat(s.name,"' blocked by other connection holding version ").concat(v.oldVersion/10))}),this._maxKey=Lr(n.IDBKeyRange),this._createTransaction=function(v,I,b,x){return new s.Transaction(v,I,b,s._options.chromeTransactionDurability,x)},this._fireOnBlocked=function(v){s.on("blocked").fire(v),Xn.filter(function(I){return I.name===s.name&&I!==s&&!I._state.vcFired}).map(function(I){return I.on("versionchange").fire(v)})},this.use(vl),this.use(Al),this.use(yl),this.use(ml),this.use(gl);var E=new Proxy(this,{get:function(v,I,b){if(I==="_vip")return!0;if(I==="table")return function(T){return _i(s.table(T),E)};var x=Reflect.get(v,I,b);return x instanceof ma?_i(x,E):I==="tables"?x.map(function(T){return _i(T,E)}):I==="_createTransaction"?function(){return _i(x.apply(this,arguments),E)}:x}});this.vip=E,a.forEach(function(v){return v(s)})}var $i,rt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Pl=(wo.prototype.subscribe=function(t,n,s){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:n,complete:s})},wo.prototype[rt]=function(){return this},wo);function wo(t){this._subscribe=t}try{$i={indexedDB:u.indexedDB||u.mozIndexedDB||u.webkitIndexedDB||u.msIndexedDB,IDBKeyRange:u.IDBKeyRange||u.webkitIDBKeyRange}}catch{$i={indexedDB:null,IDBKeyRange:null}}function Na(t){var n,s=!1,a=new Pl(function(l){var d=Vs(t),p,m=!1,w={},A={},E={get closed(){return m},unsubscribe:function(){m||(m=!0,p&&p.abort(),v&&Yt.storagemutated.unsubscribe(b))}};l.start&&l.start(E);var v=!1,I=function(){return Ys(x)},b=function(T){Hi(w,T),co(A,w)&&I()},x=function(){var T,k,D;!m&&$i.indexedDB&&(w={},T={},p&&p.abort(),p=new AbortController,D=function(O){var C=Yn();try{d&&Hn();var R=Qt(t,O);return R=d?R.finally(Ut):R}finally{C&&Zn()}}(k={subscr:T,signal:p.signal,requery:I,querier:t,trans:null}),Promise.resolve(D).then(function(O){s=!0,n=O,m||k.signal.aborted||(w={},function(C){for(var R in C)if(N(C,R))return;return 1}(A=T)||v||(Yt(jr,b),v=!0),Ys(function(){return!m&&l.next&&l.next(O)}))},function(O){s=!1,["DatabaseClosedError","AbortError"].includes(O==null?void 0:O.name)||m||Ys(function(){m||l.error&&l.error(O)})}))};return setTimeout(I,0),E});return a.hasValue=function(){return s},a.getValue=function(){return n},a}var Tn=Nt;function bo(t){var n=Zt;try{Zt=!0,Yt.storagemutated.fire(t),po(t,!0)}finally{Zt=n}}U(Tn,o(o({},Ii),{delete:function(t){return new Tn(t,{addons:[]}).delete()},exists:function(t){return new Tn(t,{addons:[]}).open().then(function(n){return n.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){try{return n=Tn.dependencies,s=n.indexedDB,n=n.IDBKeyRange,(ao(s)?Promise.resolve(s.databases()).then(function(a){return a.map(function(l){return l.name}).filter(function(l){return l!==Vi})}):oo(s,n).toCollection().primaryKeys()).then(t)}catch{return fe(new Z.MissingAPI)}var n,s},defineClass:function(){return function(t){P(this,t)}},ignoreTransaction:function(t){return Y.trans?kn(Y.transless,t):t()},vip:uo,async:function(t){return function(){try{var n=mo(t.apply(this,arguments));return n&&typeof n.then=="function"?n:z.resolve(n)}catch(s){return fe(s)}}},spawn:function(t,n,s){try{var a=mo(t.apply(s,n||[]));return a&&typeof a.then=="function"?a:z.resolve(a)}catch(l){return fe(l)}},currentTransaction:{get:function(){return Y.trans||null}},waitFor:function(t,n){return n=z.resolve(typeof t=="function"?Tn.ignoreTransaction(t):t).timeout(n||6e4),Y.trans?Y.trans.waitFor(n):n},Promise:z,debug:{get:function(){return wt},set:function(t){ia(t)}},derive:ce,extend:P,props:U,override:Ei,Events:Vr,on:Yt,liveQuery:Na,extendObservabilitySet:Hi,getByKeyPath:qe,setByKeyPath:Ye,delByKeyPath:function(t,n){typeof n=="string"?Ye(t,n,void 0):"length"in n&&[].map.call(n,function(s){Ye(t,s,void 0)})},shallowClone:$o,deepClone:gn,getObjectDiff:go,cmp:ee,asap:dt,minKey:-1/0,addons:[],connections:Xn,errnames:Ks,dependencies:$i,cache:En,semVer:"4.0.11",version:"4.0.11".split(".").map(function(t){return parseInt(t)}).reduce(function(t,n,s){return t+n/Math.pow(10,2*s)})})),Tn.maxKey=Lr(Tn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Yt(jr,function(t){Zt||(t=new CustomEvent($s,{detail:t}),Zt=!0,dispatchEvent(t),Zt=!1)}),addEventListener($s,function(t){t=t.detail,Zt||bo(t)}));var $n,Zt=!1,Ba=function(){};return typeof BroadcastChannel<"u"&&((Ba=function(){($n=new BroadcastChannel($s)).onmessage=function(t){return t.data&&bo(t.data)}})(),typeof $n.unref=="function"&&$n.unref(),Yt(jr,function(t){Zt||$n.postMessage(t)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(t){if(!Nt.disableBfCache&&t.persisted){wt&&console.debug("Dexie: handling persisted pagehide"),$n!=null&&$n.close();for(var n=0,s=Xn;n<s.length;n++)s[n].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(t){!Nt.disableBfCache&&t.persisted&&(wt&&console.debug("Dexie: handling persisted pageshow"),Ba(),bo({all:new De(-1/0,[[]])}))})),z.rejectionMapper=function(t,n){return!t||t instanceof zn||t instanceof TypeError||t instanceof SyntaxError||!t.name||!ra[t.name]?t:(n=new ra[t.name](n||t.message,t),"stack"in t&&H(n,"stack",{get:function(){return this.inner.stack}}),n)},ia(wt),o(Nt,Object.freeze({__proto__:null,Dexie:Nt,liveQuery:Na,Entity:da,cmp:ee,PropModification:Wr,replacePrefix:function(t,n){return new Wr({replacePrefix:[t,n]})},add:function(t){return new Wr({add:t})},remove:function(t){return new Wr({remove:t})},default:Nt,RangeSet:De,mergeRanges:zr,rangesOverlap:xa}),{default:Nt}),Nt})}(Yo)),Yo.exports}var Xc=Hc();const Zo=Yc(Xc),$a=Symbol.for("Dexie"),Cs=globalThis[$a]||(globalThis[$a]=Zo);if(Zo.semVer!==Cs.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Zo.semVer} and ${Cs.semVer}`);const{liveQuery:uh,mergeRanges:lh,rangesOverlap:ch,RangeSet:hh,cmp:dh,Entity:fh,PropModification:ph,replacePrefix:mh,add:gh,remove:vh}=Cs;class Jc extends Cs{constructor(){super("AudioSampleDB"),q(this,"samples"),this.version(1).stores({samples:"id, url, dateAdded, isDefaultInitSample, isFromDefaultLib"}),this.samples=this.table("samples")}}const Rs=new Jc;async function _c(c,e,r,o=0,h=0){try{if(await Rs.samples.get(c))return console.warn(`Sample with ID ${c} already exists. Cancelled.`),c;const u=r.numberOfChannels,f=r.length,y=new Float32Array(u*f);for(let N=0;N<u;N++){const U=r.getChannelData(N);y.set(U,N*f)}const P=y.buffer,S={duration:r.duration,sampleRate:r.sampleRate,channels:u},F={id:c,url:e,audioData:P,dateAdded:new Date,metadata:S,isDefaultInitSample:o,isFromDefaultLib:h};return await Rs.samples.put(F),c}catch(u){throw console.error("Failed to store audio sample:",u),new Error(`Failed to store audio sample: ${u instanceof Error?u.message:String(u)}`)}}const $c="data:video/webm;base64,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";async function Ku(){const c=await fetch($c);if(!c.ok)throw new Error(`Failed to fetch init sample: ${c.statusText}`);const e=await c.arrayBuffer(),r=new(window.AudioContext||window.webkitAudioContext)({sampleRate:iu.sampleRate}),o=await r.decodeAudioData(e);return await r.close(),o}const eh="../assets/",th="init_sample.wav";async function nh(){try{await Rs.open(),await rh()}catch(c){console.error("Error opening IndexedDB:",c)}}async function rh(){try{const c="default-init-sample",e=`${eh}${th}`;if(await Rs.samples.get(c))return;console.info("Init sample not in idb, fetching from source url..");const r=await Ku();if(!r||r.length<=0){console.warn("Failed to decode init sample");return}const o=await _c(c,e,r,1,1);console.info(`Storing init sample in idb, stored sample ID: ${o}`)}catch(c){console.warn("Error ensuring init sample in IndexedDB:",c)}}async function yh(c,e=16,r=pn(),o){if(await du(),fn(r,"Audio context is not available"),!(await zc(r)).success)throw new Error("AudioWorklet is required but not supported on this browser. Please use a modern desktop browser (Chrome, Firefox, Edge) or update your mobile browser.");let h;await nh(),h=await Ku();const u=new Kc(r,e,h,o);return fn(u,"Failed to create SamplePlayer"),u}const ze={IDLE:"IDLE",ARMED:"ARMED",RECORDING:"RECORDING",STOPPED:"STOPPED"},ih={mimeType:"audio/webm"},sh={mediaRecorderOptions:ih,useThreshold:!0,startThreshold:-30,autoStop:!1,stopThreshold:-40,silenceTimeoutMs:1e3,preprocess:!1,preprocessOptions:void 0};var dn,Et,ct,Ar,jt,me,Vn,pt,Kn,Wn,Ae,Ie,Wu,Fs,Do,eu,tu,Mi,qu,ju,nu;class oh{constructor(e){M(this,Ie),q(this,"nodeId"),q(this,"nodeType","recorder"),M(this,dn),M(this,Et,null),M(this,ct,null),M(this,Ar),M(this,jt,null),M(this,me,ze.IDLE),M(this,Vn,null),M(this,pt,null),M(this,Kn,null),M(this,Wn,null),M(this,Ae,null),this.nodeId=Ot(this.nodeType,this),g(this,dn,e),g(this,Ar,mn(this.nodeId))}async init(){return console.warn("Recorder: init() method is deprecated and will be removed in a future version."),this}async start(e){const r=await Jo(()=>hc());if(fn(!r.error,`Failed to get microphone: ${r.error}`,r),g(this,Et,r.data),g(this,Ae,{...sh,...e}),g(this,ct,new MediaRecorder(i(this,Et),i(this,Ae).mediaRecorderOptions)),!i(this,ct))throw new Error("Recorder not initialized");if(i(this,me)===ze.RECORDING)return this;try{return i(this,Ae).useThreshold?K(this,Ie,Wu).call(this):K(this,Ie,Fs).call(this),this}catch(o){throw console.error("Error starting recording:",o),o}}forceStart(){return i(this,me)!==ze.ARMED||!this.initialized?(console.warn("Recorder must be initialized and armed before calling forceStart. Current state:",i(this,me)),!1):i(this,Ae)?(i(this,Ae).autoStop=!1,K(this,Ie,Fs).call(this),!0):(console.error("Recorder config is null, cannot force start"),!1)}async stop(){var e,r;if(!i(this,ct))throw new Error("Recorder not initialized");if(i(this,me)===ze.ARMED)throw K(this,Ie,Mi).call(this),g(this,me,ze.STOPPED),console.info(`Recorder state: ${i(this,me)}`),this.sendMessage("record:cancelled",{}),new Error("Recording was armed but never triggered");if(i(this,me)!==ze.RECORDING)throw new Error("Not recording");K(this,Ie,Mi).call(this);const o=await K(this,Ie,qu).call(this);let h=await K(this,Ie,ju).call(this,o),u;return(e=i(this,Ae))!=null&&e.preprocess&&(u=await mu(i(this,dn),h,i(this,Ae).preprocessOptions),h=u.audiobuffer),i(this,jt)&&await i(this,jt).loadSample(h),g(this,me,ze.STOPPED),console.info(`Recorder state: ${i(this,me)}`),this.sendMessage("record:stop",{duration:h.duration}),(r=i(this,Et))==null||r.getTracks().forEach(f=>f.stop()),g(this,Et,null),g(this,ct,null),h}onMessage(e,r){return i(this,Ar).onMessage(e,r)}sendMessage(e,r){i(this,Ar).sendMessage(e,r),e.startsWith("record:")&&i(this,Ar).sendMessage("state-change",{state:i(this,me),event:e,...r})}connect(e){return g(this,jt,e),this}disconnect(){g(this,jt,null)}dispose(){var e;K(this,Ie,Mi).call(this),(e=i(this,Et))==null||e.getTracks().forEach(r=>r.stop()),g(this,Et,null),g(this,ct,null),g(this,me,ze.IDLE),g(this,Ae,null),Ct(this.nodeId)}get isArmed(){return i(this,me)===ze.ARMED}get isRecording(){return i(this,me)===ze.RECORDING}get state(){return i(this,me)}get initialized(){return i(this,ct)!==null&&i(this,Et)!==null}get now(){return i(this,dn).currentTime}get destination(){return i(this,jt)}}dn=new WeakMap,Et=new WeakMap,ct=new WeakMap,Ar=new WeakMap,jt=new WeakMap,me=new WeakMap,Vn=new WeakMap,pt=new WeakMap,Kn=new WeakMap,Wn=new WeakMap,Ae=new WeakMap,Ie=new WeakSet,Wu=function(){if(!K(this,Ie,nu).call(this,i(this,Ae).startThreshold)){console.warn(`Threshold ${i(this,Ae).startThreshold}dB out of range (-60 to 0)`);return}g(this,me,ze.ARMED),console.info("Recorder state: ARMED"),this.sendMessage("record:armed",{threshold:i(this,Ae).startThreshold,destination:i(this,jt)}),K(this,Ie,Do).call(this)},Fs=function(){i(this,ct).start(),g(this,me,ze.RECORDING),console.info(`Recorder state: ${i(this,me)}`),this.sendMessage("record:start",{destination:i(this,jt)}),i(this,Ae).autoStop&&K(this,Ie,Do).call(this)},Do=function(){g(this,Vn,i(this,dn).createMediaStreamSource(i(this,Et))),g(this,pt,i(this,dn).createAnalyser()),i(this,pt).fftSize=1024,i(this,Vn).connect(i(this,pt));const c=new Float32Array(i(this,pt).fftSize),e=()=>{if(!i(this,pt))return;i(this,pt).getFloatTimeDomainData(c);const r=Math.max(...c.map(Math.abs)),o=r>1e-7?20*Math.log10(r):-100;if(i(this,me)===ze.ARMED)K(this,Ie,eu).call(this,o);else if(i(this,me)===ze.RECORDING)K(this,Ie,tu).call(this,o);else{K(this,Ie,Mi).call(this);return}g(this,Kn,requestAnimationFrame(e))};g(this,Kn,requestAnimationFrame(e))},eu=function(c){c>=i(this,Ae).startThreshold&&K(this,Ie,Fs).call(this)},tu=function(c){if(!i(this,Ae).autoStop)return;const e=performance.now();c<i(this,Ae).stopThreshold?i(this,Wn)===null?g(this,Wn,e):e-i(this,Wn)>=i(this,Ae).silenceTimeoutMs&&(this.sendMessage("record:stopping",{}),this.stop().catch(r=>console.error("Error auto-stopping:",r))):g(this,Wn,null)},Mi=function(){i(this,Kn)!==null&&(cancelAnimationFrame(i(this,Kn)),g(this,Kn,null)),i(this,Vn)&&(i(this,Vn).disconnect(),g(this,Vn,null)),i(this,pt)&&(i(this,pt).disconnect(),g(this,pt,null)),g(this,Wn,null)},qu=function(){return new Promise(c=>{var e,r,o;((e=i(this,ct))==null?void 0:e.state)!=="inactive"&&((r=i(this,ct))==null||r.addEventListener("dataavailable",h=>c(h.data),{once:!0}),(o=i(this,ct))==null||o.stop())})},ju=async function(c){const e=await c.arrayBuffer();return await i(this,dn).decodeAudioData(e)},nu=function(c){return c>-60&&c<0};async function wh(c){const e=c||pn();return new oh(e)}export{ah as a,wh as b,yh as v};
//# sourceMappingURL=audiolib-lIIV0uEG.js.map
